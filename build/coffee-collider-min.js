!function(a){"use strict";var b=function(a,c){b.modules||(b.modules={},b.payloads={}),b.payloads[a]=c,b.modules[a]=null},c=function(a,e){e=d(a,e);var f=b.modules[e];if(!f){f=b.payloads[e];var g={},h={id:e,exports:g},i=function(a){return c(e,a)},j=null;f?(f(i,g,h),g=j||h.exports):g=-1,b.modules[e]=g,delete b.payloads[e]}return f=b.modules[e]=g||f},d=function(a,b){if("."===b.charAt(0)){var c=a.split("/").slice(0,-1).join("/");b=c+"/"+b;for(var d;-1!==b.indexOf(".")&&d!==b;)d=b,b=b.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return b};"function"==typeof require&&(a.require=require);var e=b;e("cc/loader",function(b,c,d){var e=b("./cc");if("undefined"!=typeof document){var f=document.getElementsByTagName("script");if(f&&f.length)for(var g=0;g<f.length;g++){var h=/^(.*\/)coffee-collider(?:-min)?\.js(\#.*)?$/.exec(f[g].src);if(h){e.rootPath=h[1],e.coffeeColliderPath=h[0],e.coffeeColliderHash=h[2];break}}"#iframe"===e.coffeeColliderHash?(e.opmode="iframe",e.context="lang",b("./lang/lang"),e.lang=e.createSynthLang()):"#socket"===e.coffeeColliderHash?(e.opmode="socket",e.context="lang",b("./lang/lang"),e.lang=e.createSynthLang()):(e.opmode="client",e.context="client",b("./client/client"),a.CoffeeCollider=function(a){return e.createSynthClient(a)})}else"undefined"!=typeof WorkerLocation?"#iframe"===location.hash?(e.opmode="iframe",e.context="server",b("./server/server"),e.server=e.createSynthServer(),e.server.connect()):(e.opmode="worker",e.context="lang/server",b("./lang/lang"),b("./server/server"),e.lang=e.createSynthLang(),e.server=e.createSynthServer(),e.lang.sendToServer=e.server.recvFromLang.bind(e.server),e.server.sendToLang=e.lang.recvFromServer.bind(e.lang),e.server.connect()):"undefined"!=typeof a.GLOBAL&&(e.global.CoffeeCollider=function(){return e.opmode="nodejs",e.context="client/lang/server",b("./client/client"),b("./lang/lang"),b("./server/server"),e.client=e.createSynthClient({nodejs:!0}),e.lang=e.createSynthLang(),e.server=e.createSynthServer(),e.client.impl.sendToLang=e.lang.recvFromClient.bind(e.lang),e.lang.sendToServer=e.server.recvFromLang.bind(e.server),e.server.sendToLang=e.lang.recvFromServer.bind(e.lang),e.lang.sendToClient=e.client.impl.recvFromLang.bind(e.client.impl),e.server.connect(),e.client},e.global.SocketSynthServer=function(a){return e.opmode="socket",e.context="server",b("./server/server"),e.server=e.createSynthServer(),e.server.client.createServer(a)},d.exports=e.global)}),e("cc/cc",function(a,b,c){c.exports={version:"0.0.0",global:{},Object:function(){}}}),e("cc/lang/lang",function(b,c,d){var e=b("./cc"),f=b("../common/pack").pack,g={},h=function(){function a(){this.klassName="SynthLang",this.sampleRate=0,this.channels=0,this.strmLength=0,this.bufLength=0,this.rootNode=e.createGroup(),this.taskManager=e.createTaskManager(),this.timelineResult=[],this.bufferRequestId=0,this.bufferRequestCallback={},this.phase=0,this.extendCommands(g)}return a.prototype.sendToClient=function(){throw"SynthLang#sendToClient: should be overridden"},a.prototype.recvFromClient=function(a){if(a){var b=g[a[0]];b&&b.call(this,a)}},a.prototype.sendToServer=function(){throw"SynthLang#sendToServer: should be overridden"},a.prototype.recvFromServer=function(a){if(a instanceof Int16Array)this.sendToClient(a);else{var b=g[a[0]];if(!b)throw new Error("Unknown command: "+a[0]);b.call(this,a)}},a.prototype.pushToTimeline=function(a){this.timelineResult.push(a)},a.prototype.play=function(a){this.taskManager.play(1e3*(this.bufLength/this.sampleRate)),this.sendToServer(a)},a.prototype.pause=function(a){this.sendToServer(a)},a.prototype.reset=function(a){e.resetBuffer(),e.resetNode(),e.resetNativeTimers(),this.taskManager.reset(),this.sendToServer(a)},a.prototype.requestBuffer=function(a,b){if("string"==typeof a&&"function"==typeof b){var c=this.bufferRequestId++;this.bufferRequestCallback[c]=b,this.sendToClient(["/buffer/request",a,c])}},a.prototype.process=function(){throw"SynthLang#process: should be overridden"},a.prototype.extendCommands=function(){},a}();g["/connected"]=function(a){"nodejs"!==e.opmode&&a.push(Object.keys(e.global)),this.sendToClient(a)},g["/init"]=function(a){this.sampleRate=0|a[1],this.channels=0|a[2],this.sendToServer(a)},g["/play"]=function(a){this.play(a)},g["/played"]=function(a){this.sendToClient(a)},g["/pause"]=function(a){this.pause(a)},g["/paused"]=function(a){this.sendToClient(a)},g["/reset"]=function(a){this.reset(a)},g["/process"]=function(){this.process()},g["/execute"]=function(b){var c=b[1],d=b[2],g=b[3],h=b[4],i=b[5];g||this.reset(["/reset"]),e.DATA=h,e.global!==a&&(a.cc=e.global),a.cc.__context__=this.taskManager.context;var j=eval.call(a,d);i&&this.sendToClient(["/executed",c,f(j)])},g["/buffer/response"]=function(a){var b=a[1],c=a[2],d=this.bufferRequestCallback[c];d&&(d(b),delete this.bufferRequestCallback[c])},g["/importScripts"]=function(a){importScripts(a[1])},g["/console/log"]=function(a){this.sendToClient(a)},g["/console/debug"]=function(a){this.sendToClient(a)},g["/console/info"]=function(a){this.sendToClient(a)},g["/console/warn"]=function(a){this.sendToClient(a)},g["/console/error"]=function(a){this.sendToClient(a)},g["/emit/n_end"]=function(a){var b=0|a[1],c=e.getNode(b);c&&c.emit("end")},g["/emit/n_done"]=function(a){var b=0|a[1],c=a[2],d=e.getNode(b);d&&d.emit("done",c)},e.SynthLang=h,d.exports={use:function(){b("../common/timer"),b("../common/console"),b("./buffer"),b("./node"),b("./pattern"),b("./random"),b("./scale"),b("./task"),b("./synthdef"),b("./ugen/ugen"),b("./lang-worker"),b("./lang-iframe"),b("./lang-nodejs"),b("./lang-socket"),e.createSynthLang=function(){switch(b("./array"),b("./boolean"),b("./data"),b("./date"),b("./function"),b("./number"),b("./object"),b("./string"),e.opmode){case"worker":return e.createWorkerSynthLang();case"iframe":return e.createIFrameSynthLang();case"nodejs":return e.createNodeJSSynthLang();case"socket":return e.createSocketSynthLang()}throw new Error("A SynthLang is not defined for: "+e.opmode)},e.replaceNativeTimerFunctions()}},d.exports.use()}),e("cc/lang/cc",function(a,b,c){c.exports=a("../cc")}),e("cc/common/pack",function(a,b,c){var d=function(){var a=function(b,c){if(!b)return b;if(-1!==c.indexOf(b))return{klassName:"Circular"};if("function"==typeof b)return"[Function]";var d;if("object"==typeof b){if(b.buffer instanceof ArrayBuffer)return b;c.push(b),Array.isArray(b)?d=b.map(function(b){return a(b,c)}):(d={},Object.keys(b).forEach(function(e){"_"!==e.charAt(0)&&(d[e]=a(b[e],c))})),c.pop()}else d=b;return d};return function(b){return a(b,[])}}(),e=function(){var a=function(){},b=function(c){if(!c)return c;if("string"==typeof c)return"[Function]"===c?a:c;var d;if("object"==typeof c){if(c.buffer instanceof ArrayBuffer)return c;Array.isArray(c)?d=c.map(function(a){return b(a)}):(c.klassName&&/^[_a-z$][_a-z0-9$]*$/i.test(c.klassName)?(d=eval.call(null,"new (function "+c.klassName+"(){})"),delete c.klassName):d={},Object.keys(c).forEach(function(a){d[a]=b(c[a])}))}else d=c;return d};return function(a){return b(a)}}();c.exports={pack:d,unpack:e}}),e("cc/common/timer",function(b,c,d){var e=b("../cc"),f=setInterval,g=clearInterval,h=setTimeout,i=clearTimeout,j=function(){function a(){this._timerId=0}return a.prototype.start=function(a,b){this._timerId&&g(this._timerId),this._timerId=0,"function"==typeof a&&"number"==typeof b&&(this._timerId=f(a,b))},a.prototype.stop=function(){this._timerId&&g(this._timerId),this._timerId=0},a.prototype.isRunning=function(){return!!this._timerId},a}(),k=function(){function a(){this._worker=new Worker(b),this._worker.onmessage=null}if("undefined"!=typeof Worker){var b=function(){try{var a="var t=0;onmessage=function(e){if(t)t=clearInterval(t),0;if(typeof e.data=='number'&&e.data>0)t=setInterval(function(){postMessage(0);},e.data);};",b=new Blob([a],{type:"text/javascript"}),c=URL.createObjectURL(b);return new Worker(c),c}catch(d){}}();if(b)return a.prototype.start=function(a,b){this._worker.onmessage&&this._worker.postMessage(0),this._worker.onmessage=null,"function"==typeof a&&"number"==typeof b&&(this._worker.onmessage=a,this._worker.postMessage(b))},a.prototype.stop=function(){this._worker.onmessage&&this._worker.postMessage(0),this._worker.onmessage=null},a.prototype.isRunning=function(){return!!this._worker.onmessage},a}}(),l=[],m=function(){a.setInterval=function(a,b){var c=f(a,b);return l.push(c),c},a.clearInterval=function(a){g(a);var b=l.indexOf(a);-1!==b&&l.splice(b,1)},a.setTimeout=function(a,b){var c=h(a,b);return l.push(c),c},a.clearTimeout=function(a){i(a);var b=l.indexOf(a);-1!==b&&l.splice(b,1)}},n=function(){a.setInterval=f,a.clearInterval=g,a.setTimeout=h,a.clearTimeout=i},o=function(){l.splice(0).forEach(function(a){g(a),i(a)})};d.exports={WorkerTimer:k,NativeTimer:j,use:function(){e.createTimer=function(){return k?new k:new j},e.replaceNativeTimerFunctions=m,e.restoreNativeTimerFunctions=n,e.resetNativeTimers=o}},d.exports.use()}),e("cc/common/console",function(b,c,d){var e=b("../cc"),f=b("./pack").unpack,g=function(a){a["/console/log"]=function(a){console.log.apply(console,f(a[1]))},a["/console/debug"]=function(a){console.debug.apply(console,f(a[1]))},a["/console/info"]=function(a){console.info.apply(console,f(a[1]))},a["/console/warn"]=function(a){console.warn.apply(console,f(a[1]))},a["/console/error"]=function(a){console.error.apply(console,f(a[1]))}};d.exports={bind:g,use:function(){e.console={log:function(){a.console.log.apply(a.console,arguments)},info:function(){a.console.info.apply(a.console,arguments)},warn:function(){a.console.warn.apply(a.console,arguments)},error:function(){a.console.error.apply(a.console,arguments)}}}},d.exports.use()}),e("cc/lang/buffer",function(a,b,c){var d=a("./cc"),e=a("./fn"),f=a("../common/extend"),g=a("../common/emitter"),h=0,i={},j=function(){function a(){g.mixin(this),this.klassName="Buffer",this.frames=0,this.channels=0,this.sampleRate=0,this._blocking=!0,this._bufId=b++,d.lang.pushToTimeline(["/b_new",this._bufId])}var b=0;return f(a,d.Object),a.prototype.performWait=function(){return this._blocking},a}(),k=function(a,b){var c=new Uint8Array(16+4*b.samples.length),e=new Uint16Array(c.buffer),f=new Uint32Array(c.buffer),g=new Float32Array(c.buffer),j=h++;return e[0]=1,e[1]=j,e[3]=b.numChannels,f[2]=b.sampleRate,f[3]=b.numFrames,g.set(b.samples,4),d.lang.sendToServer(c),i[a]=j,delete b.samples,j},l=function(a,b,c){d.lang.pushToTimeline(["/b_bind",this._bufId,a,b,c])},m=function(){};m.read=e(function(a,b,c){if("string"!=typeof a)throw new TypeError("Buffer.Read: arguments[0] should be a string.");var e=i[a],f=new j;return"number"==typeof e?l.call(f,e,b,c):d.lang.requestBuffer(a,function(d){if(d){var e=k(a,d);l.call(f,e,b,c)}}),f}).defaults("path,startFrame=0,numFrames=-1").multiCall().build();var n=function(){i={},h=0};d.global.Buffer=m,c.exports={AudioBuffer:j,use:function(){d.createAudioBuffer=function(){return new j},d.instanceOfAudioBuffer=function(a){return a instanceof j},d.resetBuffer=n}},c.exports.use()}),e("cc/lang/fn",function(a,b,c){var d=a("./cc"),e=a("./utils"),f=a("../common/ops"),g=[].slice,h=function(){function a(a){this.func=a,this.def=null,this.multi=!1}a.prototype.defaults=function(a){return this.def=a,this},a.prototype.multiCall=function(a){return this.multi=void 0===a?!0:!!a,this},a.prototype.build=function(){var a=this.func,d=[],f=[];this.def&&this.def.split(",").forEach(function(a){a=a.trim().split("="),d.push(a[0].trim()),2===a.length?f.push(JSON.parse(a[1])):f.push(void 0)});var h=a;return this.multi?h=this.def?function(){var i=g.call(arguments);return i=c(d,f,g.call(arguments)),b(i)?e.flop(i).map(function(a){return h.apply(this,a)},this):a.apply(this,i)}:function(){var c=g.call(arguments);return b(c)?e.flop(c).map(function(a){return h.apply(this,a)},this):a.apply(this,c)}:this.def&&(h=function(){var b=g.call(arguments);return b=c(d,f,g.call(arguments)),a.apply(this,b)}),h};var b=function(a){for(var b=0,c=a.length;c>b;++b)if(Array.isArray(a[b]))return!0;return!1},c=function(a,b,c){var d,f=b.slice();e.isDict(c[c.length-1])&&(d=c.pop(),Object.keys(d).forEach(function(b){var c=a.indexOf(b);-1!==c&&(f[c]=d[b])}));for(var g=0,h=Math.min(c.length,f.length);h>g;++g)f[g]=c[g];return d&&a.length<=f.length&&e.isDict(b[b.length-1])&&f.splice(f.length-1,1,d),f};return function(b){return new a(b)}}();h.definePrototypeProperty=function(a,b,c){Object.defineProperty(a.prototype,b,{configurable:!0,enumerable:!1,writable:!0,value:c})},h.setupBinaryOp=function(a,b,c){var e;e=f.UGEN_OP_ALIASES.hasOwnProperty(b)?f.UGEN_OP_ALIASES[b]:b,h.definePrototypeProperty(a,b,function(a){var f=this;return Array.isArray(a)?a.map(function(a){return f[b](a)}):d.instanceOfUGen(a)?d.createBinaryOpUGen(e,f,a):c.call(f,a)})},c.exports=h}),e("cc/lang/utils",function(a,b,c){var d=a("./cc"),e=function(a){return!(!a||a.constructor!==Object)},f=function(a){var b=a.reduce(function(a,b){return Math.max(a,Array.isArray(b)?b.length:1)},0),c=new Array(b),d=a.length;if(d)for(var e=0;b>e;++e)for(var f=c[e]=new Array(d),g=0;d>g;++g)f[g]=Array.isArray(a[g])?a[g][e%a[g].length]:a[g];return c},g=function(){var a=function(b,c){for(var d=0,e=b.length;e>d;++d)Array.isArray(b[d])?c=a(b[d],c):c.push(b[d]);return c};return function(b){return a(b,[])}}(),h=function(a,b){for(var c=[],d=[],e=0,f=a.length;f>e;++e)d.push(a[e]),d.length>=b&&(c.push(d),d=[]);return d.length&&c.push(d),c},i=function(a){var b=a.data;b instanceof Uint8Array?d.lang.sendToServer(b):d.lang.recvFromClient(b)};c.exports={isDict:e,flop:f,flatten:g,clump:h,lang_onmessage:i}}),e("cc/common/ops",function(a,b,c){var d="neg not isNil notNil bitNot abs asFloat asInt ceil floor frac sign squared cubed sqrt exp reciprocal midicps cpsmidi midiratio ratiomidi dbamp ampdb octcps cpsoct log log2 log10 sin cos tan asin acos atan sinh cosh tanh rand rand2 linrand bilinrand sum3rand distort softclip coin digitvalue silence thru rectWindow hanWindow welWindow triWindow ramp scurve numunaryselectors num tilde pi to_i".split(" "),e="+ - * / / % eq ne lt gt le ge min max bitAnd bitOr bitXor lcm gcd round roundUp trunc atan2 hypot hypotApx pow leftShift rightShift unsignedRightShift fill ring1 ring2 ring3 ring4 difsqr sumsqr sqrsum sqrdif absdif thresh amclip scaleneg clip2 excess fold2 wrap2 firstarg randrange exprandrange numbinaryselectors roundDown".split(" "),f={__plus__:"num",__minus__:"neg",__add__:"+",__sub__:"-",__mul__:"*",__div__:"/",__mod__:"%"};c.exports={UNARY_OP_UGEN_MAP:d,BINARY_OP_UGEN_MAP:e,UGEN_OP_ALIASES:f}}),e("cc/common/extend",function(a,b,c){var d=function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c.exports=d}),e("cc/common/emitter",function(a,b,c){var d=function(){function a(a){this.__context=a||this,this.__callbacks={}}return a.prototype.getListeners=function(a){return this.__callbacks[a]||(this.__callbacks[a]=[])},a.prototype.hasListeners=function(a){return this.getListeners(a).length>0},a.prototype.on=function(a,b){var c=this.getListeners(a);return-1===c.indexOf(b)&&c.push(b),this},a.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(d.__context,arguments)}var d=this;return c.callback=b,this.on(a,c),this},a.prototype.off=function(a,b){if(0===arguments.length)return this.__callbacks={},this;var c=this.getListeners(a);if(1===arguments.length)return c.splice(0),this;var d=c.indexOf(b);if(-1===d)for(var e=0,f=c.length;f>e;++e)if(c[e].callback===b){d=e;break}return-1!==d&&c.splice(d,1),this},a.prototype.emit=function(a){for(var b=Array.prototype.slice.call(arguments,1),c=this.getListeners(a).slice(0),d=0,e=c.length;e>d;++d)c[d].apply(this.__context,b);return this},a}(),e=function(a){return["getListeners","hasListeners","on","once","off","emit"].forEach(function(b){a[b]||(a[b]=d.prototype[b])}),d.call(a),a};c.exports={Emitter:d,mixin:e}}),e("cc/lang/node",function(a,b,c){var d=a("./cc"),e=a("./utils"),f=a("../common/extend"),g=a("../common/emitter"),h={},i=function(){function a(){g.mixin(this),this.klassName="Node",this.nodeId=b++,this._blocking=!0,h[this.nodeId]=this}var b=0;return f(a,d.Object),a.prototype.play=function(){return d.lang.pushToTimeline(["/n_run",this.nodeId,!0]),this},a.prototype.pause=function(){return d.lang.pushToTimeline(["/n_run",this.nodeId,!1]),this},a.prototype.stop=function(){return d.lang.pushToTimeline(["/n_free",this.nodeId]),this._blocking=!1,this},a.prototype.performWait=function(){return this._blocking},a}(),j=function(){function a(a,b){i.call(this),this.klassName="Group",a instanceof i&&d.lang.pushToTimeline(["/g_new",this.nodeId,b,a.nodeId])}return f(a,i),a}(),k=function(){function a(a,b,c,e){if(i.call(this),this.klassName="Synth",a instanceof i&&d.instanceOfSynthDef(c)){this.params=c.specs.params;var f=this.nodeId,g=l(e,this.params);d.lang.pushToTimeline(["/s_new",f,b,a.nodeId,c._defId,g])}}return f(a,i),a.prototype.set=function(a){var b=l(a,this.params);b.length&&d.lang.pushToTimeline(["/n_set",this.nodeId,b])},a}(),l=function(a,b){var c=[];return e.isDict(a)&&b&&Object.keys(a).forEach(function(d){var e=a[d],f=b.names.indexOf(d);if(-1!==f){f=b.indices[f];var g=b.length[f];Array.isArray(e)?e.forEach(function(a,b){g>b&&("number"!=typeof a||isNaN(a)||c.push(f+b,a))}):"number"!=typeof e||isNaN(e)||c.push(f,e)}}),c},m=function(a){var b,c,e;return d.instanceOfSynthDef(a[0])?(b=d.lang.rootNode,c=a[0],e=a[1]||{}):d.instanceOfSynthDef(a[1])?(b=a[0],c=a[1],e=a[2]||{}):(b=d.lang.rootNode,c=null,e={}),[b,c,e]},n=d.global.Group=function(){return new j};n.after=function(a){return new j(a||d.lang.rootNode,3)},n.before=function(a){return new j(a||d.lang.rootNode,2)},n.head=function(a){return new j(a||d.lang.rootNode,0)},n.tail=function(a){return new j(a||d.lang.rootNode,1)},n.replace=function(a){return new j(a,4)};var o=d.global.Synth=function(){return new k};o.after=function(){var a=m(arguments);return new k(a[0],3,a[1],a[2])},o.before=function(){var a=m(arguments);return new k(a[0],2,a[1],a[2])},o.head=function(){var a=m(arguments);return new k(a[0],0,a[1],a[2])},o.tail=function(){var a=m(arguments);return new k(a[0],1,a[1],a[2])},o.replace=function(a,b,c){return new k(a,4,b,c)},c.exports={Node:i,Group:j,Synth:k,args2controls:l,use:function(){d.createNode=function(){return new i},d.createGroup=function(a,b){return new j(a,b)},d.createSynth=function(a,b,c,d){return new k(a,b,c,d)},d.instanceOfNode=function(a){return a instanceof i},d.instanceOfGroup=function(a){return a instanceof j},d.instanceOfSynth=function(a){return a instanceof k},d.getNode=function(a){return h[a]},d.resetNode=function(){h={}}}},c.exports.use()}),e("cc/lang/pattern",function(a,b,c){var d=a("./cc"),e=a("./fn"),f=a("../common/extend"),g=a("../common/emitter"),h=a("../common/ops"),i=function(){function a(){g.mixin(this),this.klassName="Pattern",this._blocking=!0}return f(a,d.Object),a.prototype.next=function(){return this._blocking&&this.emit("end"),null},a.prototype.nextN=function(a,b){for(var c=new Array(a),d=0;a>d;++d)c[d]=this.next(b);return c},a.prototype.valueOf=function(b){return b instanceof a?b.next():b},a.prototype.reset=function(){this._blocking=!1},a.prototype.performWait=function(){return this._blocking},h.UNARY_OP_UGEN_MAP.forEach(function(b){/^[a-z][a-zA-Z0-9_]*$/.test(b)&&(a.prototype[b]=function(){return new l(this,b)})}),h.BINARY_OP_UGEN_MAP.forEach(function(b){/^[a-z][a-zA-Z0-9_]*$/.test(b)&&(a.prototype[b]=function(a){return new m(this,b,a)})}),a}(),j=function(){function a(a,b,c){if(!(Array.isArray(a)||a instanceof i))throw new TypeError("PSequence: the first argument is invalid");if("number"!=typeof b)throw new TypeError("PSequence: the second argument must be a Number");if("number"!=typeof c)throw new TypeError("PSequence: the third argument must be a Number");i.call(this),this.klassName="PSequence",this.list=a,this.repeats=b,this.offset=c,this._pos=0}return f(a,i),a.prototype.next=function(){if(this._blocking){if(this._pos<this.repeats*this.list.length){var a=(this._pos+this.offset)%this.list.length,b=this.list[a],c=this.valueOf(b);return null!==c&&void 0!==c?(b instanceof i||(this._pos+=1),c):(b instanceof i&&b.reset(),this._pos+=1,this.next())}this.emit("end"),this._blocking=!1}return null},a.prototype.reset=function(){this._pos=0,this._blocking=!0;for(var a=this.list,b=0,c=a.length;c>b;++b)a[b]instanceof i&&a[b].reset()},a}(),k=function(){function a(a,c){if(!(Array.isArray(a)||a instanceof i))throw new TypeError("PShuffle: the first argument is invalid");if("number"!=typeof c)throw new TypeError("PShuffle: the second argument must be a Number");a.sort(b),j.call(this,a,c,0),this.klassName="PShuffle"}f(a,j);var b=function(){return Math.random()-.5};return a}(),l=function(){function a(a,b){if(!Number.prototype.hasOwnProperty(b))throw new TypeError("PUnaryOp: operator '"+b+"' not supported");i.call(this),this.klassName="PUnaryOp",this.pattern=a,this.selector=b}return f(a,i),a.prototype.next=function(){if(this._blocking){var a=this.pattern.next();if(null!==a&&void 0!==a)return a[this.selector].call(a);this.emit("end"),this._blocking=!1}return null},a}(),m=function(){function a(a,b,c){if(!Number.prototype.hasOwnProperty(b))throw new TypeError("PBinaryOp: operator '"+b+"' not supported");i.call(this),this.klassName="PBinaryOp",this.pattern=a,this.selector=b,this.b=c}return f(a,i),a.prototype.next=function(){if(this._blocking){var a=this.pattern.next();if(null!==a&&void 0!==a)return a[this.selector].call(a,this.b);this.emit("end"),this._blocking=!1}return null},a}();d.global.PSequence=e(function(a,b,c){return d.createPSequence(a,b,c)}).defaults("list,repeats=1,offset=0").build(),d.global.PShuffle=e(function(a,b){return d.createPShuffle(a,b)}).defaults("list,repeats=1").build(),c.exports={Pattern:i,PSequence:j,PShuffle:k,PUnaryOp:l,PBinaryOp:m,use:function(){d.createPSequence=function(a,b,c){return new j(a,b,c)},d.createPShuffle=function(a,b){return new k(a,b)}}},c.exports.use()}),e("cc/lang/random",function(a,b,c){var d=a("./cc"),e=a("../common/extend"),f=function(){function a(a){"number"!=typeof a&&(a=Date.now());var b=a;b+=~(b<<15),b^=b>>>10,b+=b<<3,b^=b>>>6,b+=~(b<<11),b^=b>>>16,this.s1=1243598713^a,this.s2=3093459404^a,this.s3=1821928721^a,this.s1<2&&(this.s1=1243598713),this.s2<8&&(this.s2=3093459404),this.s3<16&&(this.s3=1821928721)}e(a,d.Object),a.prototype.trand=function(){return this.s1=(4294967294&this.s1)<<12^(this.s1<<13^this.s1)>>>19,this.s2=(4294967288&this.s2)<<4^(this.s2<<2^this.s2)>>>25,this.s3=(4294967280&this.s3)<<17^(this.s3<<3^this.s3)>>>11,this.s1^this.s2^this.s3};var b=new Uint32Array(1),c=new Float32Array(b.buffer);return a.prototype.next=function(){return b[0]=1065353216|this.trand()>>>9,c[0]-1},a}();d.global.Random=function(a){return d.createRandom(a)},c.exports={Random:f,use:function(){d.createRandom=function(a){return new f(a)},d.instanceOfRandom=function(a){return a instanceof f}}},c.exports.use()}),e("cc/lang/scale",function(a,b,c){var d=a("./cc"),e=a("./fn"),f=a("../common/extend"),g=function(a){return a.map(function(a){return 12*Math.log(a)*Math.LOG2E})},h=function(a){for(var b=new Array(a),c=0;a>=c;++c)b[c]=c;return b},i=function(){function a(a,b,c){this.klassName="Tuning",this._tuning=a,this._octaveRatio=b,this.name=c}return f(a,d.Object),a.prototype.semitones=function(){return this._tuning.slice()},a.prototype.cents=function(){return this._tuning.map(function(a){return 100*a})},a.prototype.ratios=function(){return this._tuning.map(function(a){return Math.pow(2,1*a/12)})},a.prototype.at=e(function(a){return this._tuning[a]}).multiCall().build(),a.prototype.wrapAt=e(function(a){return a%=this._tuning.length,0>a&&(a=this._tuning.length+a),this._tuning[a]}).multiCall().build(),a.prototype.octaveRatio=function(){return this._octaveRatio},a.prototype.size=function(){return this._tuning.length},a.prototype.stepsPerOctave=function(){return 12*Math.log(this._octaveRatio)*Math.LOG2E},a.prototype.tuning=function(){return this._tuning},a.prototype.equals=function(b){return b instanceof a&&this._octaveRatio===b._octaveRatio&&this._tuning.every(function(a,c){return a===b._tuning[c]},this)},a.prototype.copy=function(){return new a(this._tuning.slice(0),this._octaveRatio,this.name)},a}(),j={et12:[[0,1,2,3,4,5,6,7,8,9,10,11],2,"ET12"],pythagorean:[g([1,256/243,9/8,32/27,81/64,4/3,729/512,1.5,128/81,27/16,16/9,243/128]),2,"Pythagorean"],just:[g([1,16/15,9/8,1.2,5/4,4/3,45/32,1.5,1.6,5/3,1.8,15/8]),2,"Limit Just Intonation"],sept1:[g([1,16/15,9/8,1.2,5/4,4/3,1.4,1.5,1.6,5/3,1.8,15/8]),2,"Septimal Tritone Just Intonation"],sept2:[g([1,16/15,9/8,1.2,5/4,4/3,1.4,1.5,1.6,5/3,7/4,15/8]),2,"7-Limit Just Intonation"],mean4:[[0,.755,1.93,3.105,3.86,5.035,5.79,6.965,7.72,8.895,10.07,10.82],2,"Meantone, 1/4 Syntonic Comma"],mean5:[[0,.804,1.944,3.084,3.888,5.028,5.832,6.972,7.776,8.916,10.056,10.86],2,"Meantone, 1/5 Pythagorean Comma"],mean6:[[0,.86,1.96,3.06,3.92,5.02,5.88,6.98,7.84,8.94,10.04,10.9],2,"Meantone, 1/6 Pythagorean Comma"],kirnberger:[g([1,256/243,Math.sqrt(5)/2,32/27,5/4,4/3,45/32,Math.pow(5,.25),128/81,Math.pow(5,.75)/2,16/9,15/8]),2,"Kirnberger III"],werckmeister:[[0,.92,1.93,2.94,3.915,4.98,5.9,6.965,7.93,8.895,9.96,10.935],2,"Werckmeister III"],vallotti:[[0,.94135,1.9609,2.98045,3.9218,5.01955,5.9218,6.98045,7.9609,8.94135,10,10.90225],2,"Vallotti"],young:[[0,.9,1.96,2.94,3.92,4.98,5.88,6.98,7.92,8.94,9.96,10.9],2,"Young"],reinhard:[g([1,14/13,13/12,16/13,1.3,18/13,13/9,20/13,13/8,22/13,13/7,208/105]),2,"Mayumi Reinhard"],wcHarm:[g([1,17/16,9/8,19/16,5/4,21/16,11/8,1.5,13/8,27/16,7/4,15/8]),2,"Wendy Carlos Harmonic"],wcSJ:[g([1,17/16,9/8,1.2,5/4,4/3,11/8,1.5,13/8,5/3,7/4,15/8]),2,"Wendy Carlos Super Just"],lu:[g([1,2187/2048,9/8,19683/16384,81/64,177147/131072,729/612,1.5,6561/4096,27/16,59049/32768,243/128]),2,"Chinese Shi-er-lu scale"],et19:[h(18).map(function(a){return 12*a/19}),2,"ET19"],et22:[h(22).map(function(a){return 12*a/22}),2,"ET22"],et24:[h(24).map(function(a){return 12*a/24}),2,"ET24"],et31:[h(31).map(function(a){return 12*a/31}),2,"ET31"],et41:[h(41).map(function(a){return 12*a/41}),2,"ET41"],et53:[h(53).map(function(a){return 12*a/53}),2,"ET53"],johnston:[g([1,25/24,135/128,16/15,10/9,9/8,75/64,1.2,5/4,81/64,1.28,4/3,1.35,45/32,1.44,1.5,25/16,1.6,5/3,27/16,225/128,16/9,1.8,15/8,1.92]),2,"Ben Johnston"],partch:[g([1,81/80,33/32,1.05,16/15,12/11,1.1,10/9,9/8,8/7,7/6,32/27,1.2,11/9,5/4,14/11,9/7,21/16,4/3,1.35,11/8,1.4,10/7,16/11,40/27,1.5,32/21,14/9,11/7,1.6,18/11,5/3,27/16,12/7,7/4,16/9,1.8,20/11,11/6,15/8,40/21,64/33,160/81]),2,"Harry Partch"],catler:[g([1,33/32,16/15,9/8,8/7,7/6,1.2,128/105,16/13,5/4,21/16,4/3,11/8,45/32,16/11,1.5,1.6,13/8,5/3,27/16,7/4,16/9,24/13,15/8]),2,"Jon Catler"],chalmers:[g([1,1.05,16/15,9/8,7/6,1.2,5/4,21/16,4/3,1.4,35/24,1.5,1.575,1.6,5/3,7/4,1.8,28/15,63/32]),2,"John Chalmers"],harrison:[g([1,16/15,10/9,8/7,7/6,1.2,5/4,4/3,17/12,1.5,1.6,5/3,12/7,7/4,1.8,15/8]),2,"Lou Harrison"],sruti:[g([1,256/243,16/15,10/9,9/8,32/27,1.2,5/4,81/64,4/3,1.35,45/32,729/512,1.5,128/81,1.6,5/3,27/16,16/9,1.8,15/8,243/128]),2,"Sruti"],parret:[g([1,1.05,35/32,9/8,7/6,1.2,5/4,21/16,4/3,1.4,35/24,1.5,1.575,1.6,5/3,7/4,1.8,15/8,63/32]),2,"Wilfrid Perret"],michael_harrison:[g([1,28/27,135/128,16/15,243/224,9/8,8/7,7/6,32/27,1.2,135/112,5/4,81/64,9/7,21/16,4/3,112/81,45/32,64/45,81/56,1.5,32/21,14/9,128/81,1.6,224/135,5/3,27/16,12/7,7/4,16/9,15/8,243/128,27/14]),2,"Michael Harrison 24 tone 7-limit"],harmonic:[g(h(24).slice(1)),2,"Harmonic Series 24"],bp:[g(h(12).map(function(a){return 19.019550008654*a/13})),3,"Bohlen-Pierce"],wcAlpha:[h(14).map(function(a){return.78*a}),1.9656411970852,"Wendy Carlos Alpha"],wcBeta:[h(18).map(function(a){return.638*a}),2.0141437696805,"Wendy Carlos Beta"],wcGamma:[h(33).map(function(a){return.351*a}),1.9923898962606,"Wendy Carlos Gamma"]},k=e(function(a,b,c){return Array.isArray(a)||(a=[0,1,2,3,4,5,6,7,8,9,10,11]),"number"!=typeof b&&(b=2),"string"!=typeof c&&(c="Unknown Tuning"),new i(a,b,c)}).defaults("tuning,octaveRatio,name").build(),l={};Object.keys(j).forEach(function(a){var b=j[a];l[a]=new i(b[0],b[1],b[2]),k[a]=l[a]}),k.at=function(a){var b=l[a];return b&&(b=b.copy()),b},k.choose=e(function(a){"number"!=typeof a&&(a=12);for(var b,c=[],d=Object.keys(l),e=0,f=d.length;f>e;++e)b=l[d[e]],b._tuning.length===a&&c.push(b);return b=c[0|Math.random()*c.length],b?b.copy():void 0}).multiCall().build(),k.et=function(a){for(var b=new Array(a),c=0;a>c;++c)b[c]=c*(12/a);return new i(b,2,"ET"+a)},k.names=function(){return Object.keys(l).sort()};var m=function(){function a(a,b,c,d){this.klassName="Scale",this._degrees=a,this._pitchesPerOctave=b,this.name=d,this.tuning(c)}f(a,d.Object),a.prototype.tuning=function(a){if(0===arguments.length)return this._tuning;if(null===a?a=k["default"](this._pitchesPerOctave):"string"==typeof a&&(a=l[a]),!(a instanceof i))throw new TypeError("Scale: arguments[2] should be a tuning.");if(this._pitchesPerOctave!==a.size())throw new TypeError("Scale steps per octave "+this._pitchesPerOctave+" does not match tuning size.");return this._tuning=a,a},a.prototype.semitones=function(){return this._degrees.map(function(a){return this._tuning.wrapAt(a)},this)},a.prototype.cents=function(){return this.semitones().map(function(a){return 100*a})},a.prototype.ratios=function(){return this.semitones().map(function(a){return Math.pow(2,1*a/12)})},a.prototype.size=function(){return this._degrees.length},a.prototype.pitchesPerOctave=function(){return this._pitchesPerOctave},a.prototype.stepsPerOctave=function(){return 12*Math.log(this.octaveRatio())*Math.LOG2E},a.prototype.at=e(function(a){return a%=this._degrees.length,0>a&&(a=this._degrees.length+a),this._tuning.at(this._degrees[a])}).multiCall().build(),a.prototype.wrapAt=e(function(a){return a%=this._degrees.length,0>a&&(a=this._degrees.length+a),this._tuning.wrapAt(this._degrees[a])}).multiCall().build(),a.prototype.degreeToFreq=e(function(a,c,d){return b(this,a,d)*c}).defaults("degree=0,rootFreq=0,octave=0").multiCall().build(),a.prototype.degreeToRatio=e(function(a,c){return b(this,a,c)}).defaults("degree=0,octave=0").multiCall().build(),a.prototype.degrees=function(){return this._degrees},a.prototype.octaveRatio=function(){return this._tuning.octaveRatio()},a.prototype.equals=function(b){return b instanceof a&&this._degrees.every(function(a,c){return a===b._degrees[c]})&&this._tuning.equals(b._tuning)},a.prototype.copy=function(){return new a(this._degrees.slice(),this._pitchesPerOctave,this._tuning.copy(),this.name)};var b=function(a,b,c){c+=0|b/a._degrees.length;var d=a.ratios(),e=b%d.length;return 0>e&&(e=d.length+e),d[e]*Math.pow(a.octaveRatio(),c)};return a}(),n=function(a){var b,c=a[0]||0;for(b=a.length;b--;)c<a[b]&&(c=a[b]);var d=[53,24,19,12];for(b=d.length;b--;)if(c<d[b])return d[b];return 128},o={major:[[0,2,4,5,7,9,11],12,0,"Major"],minor:[[0,2,3,5,7,8,10],12,0,"Natural Minor"],minorPentatonic:[[0,3,5,7,10],12,0,"Minor Pentatonic"],majorPentatonic:[[0,2,4,7,9],12,0,"Major Pentatonic"],ritusen:[[0,2,5,7,9],12,0,"Ritusen"],egyptian:[[0,2,5,7,10],12,0,"Egyptian"],kumoi:[[0,2,3,7,9],12,0,"Kumoi"],hirajoshi:[[0,2,3,7,8],12,0,"Hirajoshi"],iwato:[[0,1,5,6,10],12,0,"Iwato"],ryukyu:[[0,4,5,7,11],12,0,"Ryukyu"],chinese:[[0,4,6,7,11],12,0,"Chinese"],indian:[[0,4,5,7,10],12,0,"Indian"],pelog:[[0,1,3,7,8],12,0,"Pelog"],prometheus:[[0,2,4,6,11],12,0,"Prometheus"],scriabin:[[0,1,4,7,9],12,0,"Scriabin"],gong:[[0,2,4,7,9],12,0,"Gong"],shang:[[0,2,5,7,10],12,0,"Shang"],jiao:[[0,3,5,8,10],12,0,"Jiao"],zhi:[[0,2,5,7,9],12,0,"Zhi"],yu:[[0,3,5,7,10],12,0,"Yu"],whole:[[0,2,4,6,8,10],12,0,"Whole Tone"],augmented:[[0,3,4,7,8,11],12,0,"Augmented"],augmented2:[[0,1,4,5,8,9],12,0,"Augmented 2"],partch_o1:[[0,8,14,20,25,34],43,"partch","Partch Otonality 1"],partch_o2:[[0,7,13,18,27,35],43,"partch","Partch Otonality 2"],partch_o3:[[0,6,12,21,29,36],43,"partch","Partch Otonality 3"],partch_o4:[[0,5,15,23,30,37],43,"partch","Partch Otonality 4"],partch_o5:[[0,10,18,25,31,38],43,"partch","Partch Otonality 5"],partch_o6:[[0,9,16,22,28,33],43,"partch","Partch Otonality 6"],partch_u1:[[0,9,18,23,29,35],43,"partch","Partch Utonality 1"],partch_u2:[[0,8,16,25,30,36],43,"partch","Partch Utonality 2"],partch_u3:[[0,7,14,22,31,37],43,"partch","Partch Utonality 3"],partch_u4:[[0,6,13,20,28,38],43,"partch","Partch Utonality 4"],partch_u5:[[0,5,12,18,25,33],43,"partch","Partch Utonality 5"],partch_u6:[[0,10,15,21,27,34],43,"partch","Partch Utonality 6"],hexMajor7:[[0,2,4,7,9,11],12,0,"Hex Major 7"],hexDorian:[[0,2,3,5,7,10],12,0,"Hex Dorian"],hexPhrygian:[[0,1,3,5,8,10],12,0,"Hex Phrygian"],hexSus:[[0,2,5,7,9,10],12,0,"Hex Sus"],hexMajor6:[[0,2,4,5,7,9],12,0,"Hex Major 6"],hexAeolian:[[0,3,5,7,8,10],12,0,"Hex Aeolian"],ionian:[[0,2,4,5,7,9,11],12,0,"Ionian"],dorian:[[0,2,3,5,7,9,10],12,0,"Dorian"],phrygian:[[0,1,3,5,7,8,10],12,0,"Phrygian"],lydian:[[0,2,4,6,7,9,11],12,0,"Lydian"],mixolydian:[[0,2,4,5,7,9,10],12,0,"Mixolydian"],aeolian:[[0,2,3,5,7,8,10],12,0,"Aeolian"],locrian:[[0,1,3,5,6,8,10],12,0,"Locrian"],harmonicMinor:[[0,2,3,5,7,8,11],12,0,"Harmonic Minor"],harmonicMajor:[[0,2,4,5,7,8,11],12,0,"Harmonic Major"],melodicMinor:[[0,2,3,5,7,9,11],12,0,"Melodic Minor"],melodicMinorDesc:[[0,2,3,5,7,8,10],12,0,"Melodic Minor Descending"],melodicMajor:[[0,2,4,5,7,8,10],12,0,"Melodic Major"],bartok:[[0,2,4,5,7,8,10],12,0,"Bartok"],hindu:[[0,2,4,5,7,8,10],12,0,"Hindu"],todi:[[0,1,3,6,7,8,11],12,0,"Todi"],purvi:[[0,1,4,6,7,8,11],12,0,"Purvi"],marva:[[0,1,4,6,7,9,11],12,0,"Marva"],bhairav:[[0,1,4,5,7,8,11],12,0,"Bhairav"],ahirbhairav:[[0,1,4,5,7,9,10],12,0,"Ahirbhairav"],superLocrian:[[0,1,3,4,6,8,10],12,0,"Super Locrian"],romanianMinor:[[0,2,3,6,7,9,10],12,0,"Romanian Minor"],hungarianMinor:[[0,2,3,6,7,8,11],12,0,"Hungarian Minor"],neapolitanMinor:[[0,1,3,5,7,8,11],12,0,"Neapolitan Minor"],enigmatic:[[0,1,4,6,8,10,11],12,0,"Enigmatic"],spanish:[[0,1,4,5,7,8,10],12,0,"Spanish"],leadingWhole:[[0,2,4,6,8,10,11],12,0,"Leading Whole Tone"],lydianMinor:[[0,2,4,6,7,8,10],12,0,"Lydian Minor"],neapolitanMajor:[[0,1,3,5,7,9,11],12,0,"Neapolitan Major"],locrianMajor:[[0,2,4,5,6,8,10],12,0,"Locrian Major"],diminished:[[0,1,3,4,6,7,9,10],12,0,"Diminished"],diminished2:[[0,2,3,5,6,8,9,11],12,0,"Diminished 2"],chromatic:[[0,1,2,3,4,5,6,7,8,9,10,11],12,0,"Chromatic"],chromatic24:[h(23),24,0,"Chromatic 24"],ajam:[[0,4,8,10,14,18,22],24,0,"Ajam"],jiharkah:[[0,4,8,10,14,18,21],24,0,"Jiharkah"],shawqAfza:[[0,4,8,10,14,16,22],24,0,"Shawq Afza"],sikah:[[0,3,7,11,14,17,21],24,0,"Sikah"],sikahDesc:[[0,3,7,11,13,17,21],24,0,"Sikah Descending"],huzam:[[0,3,7,9,15,17,21],24,0,"Huzam"],iraq:[[0,3,7,10,13,17,21],24,0,"Iraq"],bastanikar:[[0,3,7,10,13,15,21],24,0,"Bastanikar"],mustar:[[0,5,7,11,13,17,21],24,0,"Mustar"],bayati:[[0,3,6,10,14,16,20],24,0,"Bayati"],karjighar:[[0,3,6,10,12,18,20],24,0,"Karjighar"],husseini:[[0,3,6,10,14,17,21],24,0,"Husseini"],nahawand:[[0,4,6,10,14,16,22],24,0,"Nahawand"],nahawandDesc:[[0,4,6,10,14,16,20],24,0,"Nahawand Descending"],farahfaza:[[0,4,6,10,14,16,20],24,0,"Farahfaza"],murassah:[[0,4,6,10,12,18,20],24,0,"Murassah"],ushaqMashri:[[0,4,6,10,14,17,21],24,0,"Ushaq Mashri"],rast:[[0,4,7,10,14,18,21],24,0,"Rast"],rastDesc:[[0,4,7,10,14,18,20],24,0,"Rast Descending"],suznak:[[0,4,7,10,14,16,22],24,0,"Suznak"],nairuz:[[0,4,7,10,14,17,20],24,0,"Nairuz"],yakah:[[0,4,7,10,14,18,21],24,0,"Yakah"],yakahDesc:[[0,4,7,10,14,18,20],24,0,"Yakah Descending"],mahur:[[0,4,7,10,14,18,22],24,0,"Mahur"],hijaz:[[0,2,8,10,14,17,20],24,0,"Hijaz"],hijazDesc:[[0,2,8,10,14,16,20],24,0,"Hijaz Descending"],zanjaran:[[0,2,8,10,14,16,22],24,0,"Zanjaran"],saba:[[0,3,6,8,12,16,20],24,0,"Saba"],zamzam:[[0,2,6,8,14,16,20],24,0,"Zamzam"],kurd:[[0,2,6,10,14,16,20],24,0,"Kurd"],kijazKarKurd:[[0,2,8,10,14,16,22],24,0,"Kijaz Kar Kurd"],nawaAthar:[[0,4,6,12,14,16,22],24,0,"Nawa Athar"],nikriz:[[0,4,6,12,14,18,20],24,0,"Nikriz"],atharKurd:[[0,2,6,12,14,16,22],24,0,"Athar Kurd"]},p=e(function(a,b,c,d){return Array.isArray(a)||(a=[0,2,4,5,7,9,11]),"number"!=typeof b&&(b=n(a)),"string"==typeof c&&(c=l[c]),c instanceof i||(c=l.et12),"string"!=typeof d&&(d="Unknown Scale"),new m(a,b,c,d)
}).defaults("degrees,pitchesPerOctave,tuning,name").build(),q={};Object.keys(o).forEach(function(a){var b=o[a];b[2]=b[2]?l[b[2]].copy():k.et(b[1]),q[a]=new m(b[0],b[1],b[2],b[3]),p[a]=q[a]}),p.at=function(a,b){var c=q[a];return c&&(c=c.copy(),b&&c.tuning(b)),c},p.choose=e(function(a,b){"number"!=typeof a&&(a=7),"number"!=typeof b&&(b=12);for(var c,d=[],e=Object.keys(q),f=0,g=e.length;g>f;++f)c=q[e[f]],c._degrees.length===a&&c._pitchesPerOctave===b&&d.push(c);return c=d[0|Math.random()*d.length],c?c.copy():void 0}).multiCall().build(),p.names=function(){return Object.keys(q).sort()},d.global.Scale=p,d.global.Tuning=k,c.exports={Scale:m,Tuning:i,use:function(){d.createScale=function(a,b,c,d){return new m(a,b,c,d)},d.createTuning=function(a,b,c){return new i(a,b,c)},d.instanceOfScale=function(a){return a instanceof m},d.instanceOfTuning=function(a){return a instanceof i}}},c.exports.use()}),e("cc/lang/task",function(a,b,c){var d=a("./cc"),e=a("../common/extend"),f=a("../common/emitter"),g=[].slice,h=function(){function a(){this.klassName="TaskManager",this.tasks=[],this.counterIncr=0}return e(a,d.Object),a.prototype.play=function(a){this.counterIncr=Math.max(1,a)},a.prototype.pause=function(){this.counterIncr=0},a.prototype.reset=function(){this.tasks=[]},a.prototype.append=function(a){var b=this.tasks.indexOf(a);-1===b&&this.tasks.push(a)},a.prototype.remove=function(a){var b=this.tasks.indexOf(a);-1!==b&&this.tasks.splice(b,1)},a.prototype.process=function(){for(var a=this.counterIncr,b=this.tasks,c=0;c<b.length;++c)b[c].process(a)},a}(),i=function(){function a(a){if(f.mixin(this),this.klassName="TaskFunction",0===arguments.length)this.segments=[];else{if("function"!=typeof a)throw new TypeError("TaskFunction: first argument should be a Function.");var b=a();if(!Array.isArray(b))throw new TypeError("TaskFunction: invalid initialize function");this.segments=b}this._pc=0}return e(a,d.Object),a.prototype.perform=function(a){var b=this.segments[this._pc++];return b?(b.apply(a,g.call(arguments,1)),!0):!1},a.prototype.clone=function(){var b=new a;return b.segments=this.segments,b},a.prototype.goTo=function(a){this._pc=Math.max(0,Math.min(a,this.segments.length))},a}(),j=function(){function a(a){this.klassName="TaskWaitToken",this.item=a,this._blocking=!0}return e(a,d.Object),a.prototype.performWait=function(){return this._blocking},a}(),k=function(){function a(a){j.call(this,a),this.klassName="TaskWaitTokenNumber",this.item*=1e3}return e(a,j),a.prototype.performWait=function(a){return this._blocking&&(this.item-=a,this.item<=0&&(this._blocking=!1)),this._blocking},a}(),l=function(){function a(a){j.call(this,a),this.klassName="TaskWaitTokenFunction"}return e(a,j),a.prototype.performWait=function(){return this._blocking&&(this._blocking=!!this.item()),this._blocking},a}(),m=function(){function a(a){j.call(this,a),this.klassName="TaskWaitTokenBoolean",this._blocking=a}return e(a,j),a}(),n=function(){function a(a){j.call(this,a),this.klassName="TaskWaitTokenBlockable"}return e(a,j),a.prototype.performWait=function(a){return this._blocking&&(this._blocking=this.item.performWait(a)),this._blocking},a}(),o=function(){function a(b){j.call(this,[]),this.klassName="TaskWaitTokenLogicAND";var c=[];b.forEach(function(b){b instanceof a?c=c.concat(b.item):c.push(b)}),this.item=c}return e(a,j),a.prototype.performWait=function(a){return this._blocking&&(this.item=this.item.filter(function(b){return b.performWait(a)}),this._blocking=this.item.length>0),this._blocking},a}(),p=function(){function a(b){j.call(this,[]);var c=[];b.forEach(function(b){b instanceof a?c=c.concat(b.item):c.push(b)}),this.item=c}return e(a,j),a.prototype.performWait=function(a){var b=!0;return this.item=this.item.filter(function(c){var d=c.performWait(a);return b=d&&b,d}),this._blocking&&(this._blocking=b),this._blocking},a}(),q=function(){function a(a){var b=this;f.mixin(this),this.klassName="TaskProcessor",this.taskManager=d.taskManager,this._blocking=!0,this._func=a,this._count=0,this._prev=null,this._next=null,this._wait=null,this._context={wait:function(a){b._wait=d.createTaskWaitToken(a||0)},"continue":function(a){b._wait=d.createTaskWaitToken(a||0),b._func.goTo(0),b._done()},redo:function(a){b._wait=d.createTaskWaitToken(a||0),b._func.goTo(0)},"break":function(){b._func.goTo(1/0),b.stop()}}}return e(a,d.Object),a.prototype.play=function(){for(var a=this;null!==a._prev;)a=a._prev;return a.taskManager&&d.taskManager.append(a),this._blocking=!0,this},a.prototype.pause=function(){return this.taskManager&&this.taskManager.remove(this),this._blocking=!1,this},a.prototype.stop=function(){return this.taskManager&&(this.taskManager.remove(this),this.emit("end"),this._next&&(this._next._prev=null,this._next.play(),this._next=null)),this._count=0,this._blocking=!1,this.taskManager=null,this},a.prototype.process=function(a){for(var b;this._blocking;){if(this._wait){if(b=this._wait.performWait(a))return;this._wait=null}b=this._execute(this._count),b||this._done(),a=0}},a.prototype._execute=function(){return this._func.perform(this._context,this._count)},a.prototype.performWait=function(){return this._blocking},a.prototype["do"]=function(a,b){var c=new r(a,b);return c._prev=this,this._next=c,c},a.prototype.loop=function(a){var b=new r(1/0,a);return b._prev=this,this._next=b,b},a.prototype.each=function(a,b){var c=new s(a,d.createTaskFunction(b));return c._prev=this,this._next=c,c},a}(),r=function(){function a(){var a,b,c=0;"number"==typeof arguments[c]&&(a=arguments[c++]),"function"==typeof arguments[c]?b=d.createTaskFunction(arguments[c++]):b instanceof i&&(b=arguments[c++]),q.call(this,b),1/0!==a&&(a=0|a),this._num=a,this.klassName=1/0===a?"TaskProcessorLoop":"TaskProcessorDo"}return e(a,q),a.prototype._done=function(){this._count+=1,this._count<this._num?this._func.goTo(0):this.stop()},a}(),s=function(){function a(a,b){if(!Array.isArray(a))throw new TypeError("Task.each: First argument must be an Array.");q.call(this,b),this.klassName="TaskProcessorEach",this._list=a}return e(a,q),a.prototype._execute=function(){return this._func.perform(this._context,this._list[this._count],this._count)},a.prototype._done=function(){this._count+=1,this._count<this._list.length?this._func.goTo(0):this.stop()},a}(),t=function(){function a(b){var c=this;q.call(this,b),this.klassName="TaskProcessorRecursive",this._value=0,this._args=[],this._context.recursive=function(){var e=new a(b.clone());return e.play.apply(e,g.call(arguments)),c._wait=d.createTaskWaitToken(e),e},this._context["return"]=function(a){c._value=a,c.stop()}}return e(a,q),a.prototype.play=function(){return this._args=g.call(arguments).map(function(b){return b instanceof a&&(b=b._value),b}),q.prototype.play.call(this),this},a.prototype._execute=function(){return this._func.perform.apply(this._func,[this._context].concat(this._args))},a.prototype._done=function(){this.stop()},a}();d.global.Task=function(a){return d.createTaskFunction(a)},d.global.Task["do"]=function(a,b){return new r(a,b)},d.global.Task.loop=function(a){return new r(1/0,a)},d.global.Task.each=function(a,b){return new s(a,d.createTaskFunction(b))},d.global.Task.recursive=function(a){return new t(d.createTaskFunction(a))},c.exports={TaskManager:h,TaskFunction:i,TaskWaitToken:j,TaskWaitTokenNumber:k,TaskWaitTokenFunction:l,TaskWaitTokenBoolean:m,TaskWaitTokenBlockable:n,TaskWaitTokenLogicAND:o,TaskWaitTokenLogicOR:p,TaskProcessor:q,TaskProcessorDo:r,TaskProcessorEach:s,TaskProcessorRecursive:t,use:function(){d.createTaskManager=function(){return d.taskManager=new h,d.taskManager},d.instanceOfTaskManager=function(a){return a instanceof h},d.createTaskFunction=function(a){return new i(a)},d.instanceOfTaskFunction=function(a){return a instanceof i},d.createTaskWaitToken=function(a){if(a instanceof j)return a;switch(typeof a){case"number":return new k(a);case"function":return new l(a);case"boolean":return new m(a);default:if(Array.isArray(a))return d.createTaskWaitLogic("and",a);if(a&&"function"==typeof a.performWait)return new n(a)}throw new TypeError("TaskWaitToken: Invalid type")},d.instanceOfTaskWaitToken=function(a){return a instanceof j},d.createTaskWaitLogic=function(a,b){return b=b.map(function(a){return d.createTaskWaitToken(a)}),"and"===a?new o(b):new p(b)}}},c.exports.use()}),e("cc/lang/synthdef",function(a,b,c){var d=a("./cc"),e=a("./fn"),f=a("./utils"),g=a("../common/extend"),h=0,i=function(){function a(a,b){this.klassName="SynthDef",this._defId=h++,this.func=a,this.args=k(b),this.params=l(this.args),this.specs=null}g(a,d.Object),a.prototype.build=function(){return this.specs||(b.call(this),d.lang.pushToTimeline(["/s_def",this._defId,JSON.stringify(this.specs)])),this},a.prototype.play=e(function(){null===this.specs&&this.build();var a=j.apply(null,arguments),b=a[0],c=a[1],e=a[2];switch(e){case"addToHead":return d.createSynth(b,0,this,c);case"addToTail":return d.createSynth(b,1,this,c);case"addBefore":return d.createSynth(b,2,this,c);case"addAfter":return d.createSynth(b,3,this,c);default:return d.createSynth(b,0,this,c)}}).multiCall().build();var b=function(){var a=this.args,b=this.params,c=[];d.setSynthDef(function(a){c.push(a)});var e=d.createControl(1).init(b.flatten);Array.isArray(e)||(e=[e]);try{this.func.apply(null,n(a.vals,e))}catch(f){throw f.toString()}finally{d.setSynthDef(null)}var g=o(c),h=s(p(c),g),i={consts:g,defList:h,params:b.params};this.specs=i};return a}(),j=function(){var a,b,c,e=0;return a=d.instanceOfNode(arguments[e])?arguments[e++]:d.lang.rootNode,f.isDict(arguments[e])&&(b=arguments[e++]),c="string"==typeof arguments[e]?arguments[e]:"addToHead",b&&1===arguments.length&&(d.instanceOfNode(b.target)&&(a=b.target,delete b.target),"string"==typeof b.addAction&&(c=b.addAction,delete b.addAction)),[a,b,c]},k=function(a){var b=[],c=[];if(a&&a.length)for(var d=0,e=a.length;e>d;d+=2)b.push(a[d+0]),c.push(a[d+1]);return{keys:b,vals:c}},l=function(a){for(var b={names:[],indices:[],length:[],values:[]},c=[],d=null,e=0,g=a.vals.length;g>e;++e){var h;try{h=JSON.parse(a.vals[e])}catch(i){throw new TypeError("SynthDefFunction's arguments should be a JSONable: "+a.vals[e])}if(m(h)){var j=Array.isArray(h)?h.length:1;b.names.push(a.keys[e]),b.indices.push(c.length),b.length.push(j),b.values.push(h),c=c.concat(h)}else{if(e!==g-1||!f.isDict(h))throw new TypeError("SynthDefFunction's arguments should be a constant number or an array that contains it.");d=h}d&&(a.keys.pop(),a.vals.pop())}return{params:b,flatten:c,opts:d}},m=function(a){return"number"==typeof a?!0:Array.isArray(a)?a.every(function(a){return"number"==typeof a}):!1},n=function(a,b){for(var c=[],d=b.slice(),e=0,f=a.length;f>e;++e)Array.isArray(a[e])?c.push(d.splice(0,a[e].length)):c.push(d.shift());return c},o=function(a){var b=[];return a.forEach(function(a){a.inputs&&a.inputs.forEach(function(a){"number"==typeof a&&-1===b.indexOf(a)&&b.push(a)})}),b.sort()},p=function(){var a=function(b,c,e,f){if(f.indexOf(b)!==f.length-1)return d.console.warn("UGen graph contains recursion."),void 0;e.push(b);var g=c.indexOf(b);-1!==g&&c.splice(g,1),c.unshift(b),b.inputs&&b.inputs.forEach(function(b){f.push(b),a(b,c,e,f),f.pop()})};return function(b){var c,e=[];return b.slice().forEach(function(f){d.instanceOfOut(f)&&(e.push(f),c=[f],f.inputs.forEach(function(d){c.push(d),a(d,b,e,c),c.pop()}))}),b=b.filter(function(a){return-1!==e.indexOf(a)})}}(),q=function(a){return a.rate},r=function(a){return"number"!=typeof a&&!d.instanceOfOutputProxy(a)},s=function(a,b){var c=[];a=a.filter(r);for(var e=0,f=a.length;f>e;++e){for(var g,h=a[e],i=[],j=0,k=h.inputs.length;k>j;++j){var l,m;l=d.instanceOfOutputProxy(h.inputs[j])?a.indexOf(h.inputs[j].inputs[0]):a.indexOf(h.inputs[j]),m=-1!==l?0|h.inputs[j].outputIndex:b.indexOf(h.inputs[j]),i.push(l,m)}g=d.instanceOfMultiOutUGen(h)?h.channels.map(q):1===h.numOfOutputs?[h.rate]:[],c.push([h.klassName,h.rate,0|h.specialIndex,i,g,h.tag||""])}return c};d.global.SynthDef=function(a,b){return d.createSynthDef(a,b)},c.exports={SynthDef:i,args2keyValues:k,args2params:l,isValidDefArg:m,reshapeArgs:n,getConstValues:o,topoSort:p,makeDefList:s,use:function(){d.createSynthDef=function(a,b){return new i(a,b)},d.instanceOfSynthDef=function(a){return a instanceof i}}},c.exports.use()}),e("cc/lang/ugen/ugen",function(a,b,c){var d=a("../cc"),e=a("../fn"),f=a("../../common/extend"),g=a("../../common/ops"),h=[].slice,i=null,j={};d.ugen={specs:j};var k=function(){function a(a){this.klassName=a,this.tag="",this.rate=2,this.signalRange=2,this.specialIndex=0,this.outputIndex=0,this.numOfInputs=0,this.numOfOutputs=1,this.inputs=[]}return f(a,d.Object),a.prototype.init=function(a){return this.rate=a,i&&i(this),this.inputs=h.call(arguments,1),this.numOfInputs=this.inputs.length,this},a.prototype.__plus__=function(){return this},a.prototype.__minus__=function(){return this.neg()},e.setupBinaryOp(a,"__add__",function(a){return d.createBinaryOpUGen("+",this,a)}),e.setupBinaryOp(a,"__sub__",function(a){return d.createBinaryOpUGen("-",this,a)}),e.setupBinaryOp(a,"__mul__",function(a){return d.createBinaryOpUGen("*",this,a)}),e.setupBinaryOp(a,"__div__",function(a){return d.createBinaryOpUGen("/",this,a)}),e.setupBinaryOp(a,"__mod__",function(a){return d.createBinaryOpUGen("%",this,a)}),a.prototype.madd=e(function(a,b){return d.createMulAdd(this,a,b)}).defaults("mul=1,add=0").multiCall().build(),a.prototype.range=e(function(a,b){var c,e;return 2===this.signalRange?(c=.5*(b-a),e=c+a):(c=b-a,e=a),d.createMulAdd(this,c,e)}).defaults("lo=0,hi=1").multiCall().build(),a.prototype.unipolar=e(function(a){return this.range(0,a)}).defaults("mul=1").multiCall().build(),a.prototype.bipolar=e(function(a){return this.range(a.neg(),a)}).defaults("mul=1").multiCall().build(),g.UNARY_OP_UGEN_MAP.forEach(function(b){/^[a-z][a-zA-Z0-9_]*/.test(b)&&(a.prototype[b]=function(){return d.createUnaryOpUGen(b,this)})}),g.BINARY_OP_UGEN_MAP.forEach(function(b){/^[a-z][a-zA-Z0-9_]*/.test(b)&&e.setupBinaryOp(a,b,function(a){return d.createBinaryOpUGen(b,this,a)})}),a}(),l=function(){function a(a){k.call(this,a||"MultiOutUGen"),this.channels=null}return f(a,k),a.prototype.initOutputs=function(a,b){for(var c=new Array(a),d=0;a>d;++d)c[d]=new m(b,this,d);return this.channels=c,this.numOfOutputs=c.length,this.inputs=this.inputs.map(function(a){return a instanceof k||(a=+a,isNaN(a)&&(a=0)),a}),this.numOfInputs=this.inputs.length,1===a?c[0]:c},a}(),m=function(){function a(a,b,c){k.call(this,"OutputProxy"),this.init(a),this.inputs=[b],this.numOfOutputs=1,this.outputIndex=c}return f(a,k),a}(),n=function(a,b){var c=d.global[a]=function(){return new k(a)};Object.keys(b).forEach(function(d){var f=b[d],g=f.defaults+",tag",i=f.ctor,j=f.multiCall;if(void 0===j&&(j=!0),null!==f.Klass){var l=f.Klass||k;c[d]=e(function(){var b=h.call(arguments,0,arguments.length-1),c=arguments[arguments.length-1],d=i.apply(new l(a,c),b);return d instanceof k&&(d.tag=c||""),d}).defaults(g).multiCall(j).build()}else c[d]=e(function(){var a=h.call(arguments,0,arguments.length-1),b=arguments[arguments.length-1],c=i.apply(null,a);return c instanceof k&&(c.tag=b||""),c}).defaults(g).multiCall(j).build()})};d.UGen=k,d.MultiOutUGen=l,d.registerUGen=n,c.exports={UGen:k,MultiOutUGen:l,OutputProxy:m,use:function(){d.createUGen=function(){return new k},d.createOutputProxy=function(a,b,c){return new m(a,b,c)},d.instanceOfUGen=function(a){return a instanceof k},d.instanceOfMultiOutUGen=function(a){return a instanceof l},d.instanceOfOutputProxy=function(a){return a instanceof m},d.setSynthDef=function(a){if(a&&null!==i)throw new Error("nested Synth.def");i=a},a("./uop"),a("./bop"),a("./madd"),a("./inout"),a("./mix"),d.UGen=k,d.MultiOutUGen=l,d.registerUGen=n}},a("./bufio"),a("./delay"),a("./filter"),a("./inout"),a("./line"),a("./osc"),a("./pan"),a("./ui"),Object.keys(j).forEach(function(a){n(a,j[a])}),c.exports.use()}),e("cc/lang/ugen/uop",function(a,b,c){var d=a("../cc"),e=a("../../common/extend"),f=a("../../common/ops"),g=function(){function a(){d.UGen.call(this,"UnaryOpUGen")}return e(a,d.UGen),a.prototype.init=function(a,b){var c=f.UNARY_OP_UGEN_MAP.indexOf(a);if(-1===c)throw new TypeError("UnaryOpUGen: unknown operator '"+a+"'");var e=0|b.rate;return d.UGen.prototype.init.call(this,e),this.selector=a,this.specialIndex=c,this.inputs=[b],this.numOfInputs=1,this},a}();c.exports={use:function(){d.createUnaryOpUGen=function(a,b){return(new g).init(a,b)},d.instanceOfUnaryOpUGen=function(a){return a instanceof g}}},c.exports.use()}),e("cc/lang/ugen/bop",function(a,b,c){var d=a("../cc"),e=a("../../common/extend"),f=a("../../common/ops"),g=a("../fn"),h=a("../utils"),i=function(){function a(){d.UGen.call(this,"BinaryOpUGen")}return e(a,d.UGen),a.prototype.init=function(a,b,c){if("-"===a&&"number"==typeof c&&(a="+",c=-c),"/"===a&&"number"==typeof c&&(a="*",c=1/c),"*"===a)return"number"==typeof b&&"number"==typeof c?b*c:0===b||0===c?0:k(b,c);if("+"===a){if("number"==typeof b&&"number"==typeof c)return b+c;if(0===b)return c;if(0===c)return b;if(d.instanceOfBinaryOpUGen(b)){if("*"===b.selector)return d.createMulAdd(b.inputs[0],b.inputs[1],c)}else if(d.instanceOfMulAdd(b))return"number"==typeof b.inputs[2]&&"number"==typeof c?0===b.inputs[2]+c?d.createBinaryOpUGen("*!",b.inputs[0],b.inputs[1]):(b.inputs[2]+=c,b):(c=d.createBinaryOpUGen("+",b.inputs[2],c),b=d.createBinaryOpUGen("*!",b.inputs[0],b.inputs[1]),d.createBinaryOpUGen("+",b,c));return j(b,c)}"+!"===a?a="+":"*!"===a&&(a="*");var e=f.BINARY_OP_UGEN_MAP.indexOf(a);if(-1===e)throw new TypeError("BinaryOpUGen: unknown operator '"+a+"'");var g=Math.max(0|b.rate,0|c.rate);return d.UGen.prototype.init.call(this,g),this.selector=a,this.specialIndex=e,this.inputs=[b,c],this.numOfInputs=2,this},a}(),j=function(){var a=function(b){if("number"==typeof b)return b;var c=b.inputs;return d.instanceOfBinaryOpUGen(b)&&"+"===b.selector?[a(c[0]),a(c[1])]:d.instanceOfSum3(b)?[a(c[0]),a(c[1]),a(c[2])]:d.instanceOfSum4(b)?[a(c[0]),a(c[1]),a(c[2]),a(c[3])]:b},b=function(a){switch(a=a.map(function(a){switch(a.length){case 4:return d.createSum4(a[0],a[1],a[2],a[3]);case 3:return d.createSum3(a[0],a[1],a[2]);case 2:return d.createBinaryOpUGen("+!",a[0],a[1]);case 1:return a[0]}}),a.length){case 4:return d.createSum4(a[0],a[1],a[2],a[3]);case 3:return d.createSum4(a[0],a[1],a[2]);case 2:return d.createBinaryOpUGen("+!",a[0],a[1]);case 1:return a[0];default:return b(h.clump(a,4))}};return function(c,e){var f=h.flatten([a(c),a(e)]),g=0;return f=f.filter(function(a){return"number"==typeof a?(g+=a,!1):!0}),0!==g&&f.push(g),f=h.clump(f,4),1===f.length&&2===f[0].length?d.createBinaryOpUGen("+!",f[0][0],f[0][1]):b(f)}}(),k=function(){var a=function(b){if("number"==typeof b)return b;var c=b.inputs;return d.instanceOfBinaryOpUGen(b)&&"*"===b.selector?[a(c[0]),a(c[1])]:b},b=function(a){switch(a=a.map(function(a){return 2===a.length?d.createBinaryOpUGen("*!",a[0],a[1]):a[0]}),a.length){case 2:return d.createBinaryOpUGen("*!",a[0],a[1]);case 1:return a[0];default:return b(h.clump(a,2))}};return function(c,e){var f=h.flatten([a(c),a(e)]),g=1;return f=f.filter(function(a){return"number"==typeof a?(g*=a,!1):!0}),1!==g&&f.push(g),f=h.clump(f,2),1===f.length&&2===f[0].length?d.createBinaryOpUGen("*!",f[0][0],f[0][1]):b(f)}}();c.exports={use:function(){d.createBinaryOpUGen=g(function(a,b,c){return(new i).init(a,b,c)}).multiCall().build(),d.instanceOfBinaryOpUGen=function(a){return a instanceof i}}},c.exports.use()}),e("cc/lang/ugen/madd",function(a,b,c){var d=a("../cc"),e=a("../../common/extend"),f=a("../fn"),g=function(a){return Array.isArray(a)?a.reduce(function(a,b){return Math.max(a,g(b))},0):a&&a.rate||0},h=function(){function a(){d.UGen.call(this,"MulAdd")}e(a,d.UGen),a.prototype.init=function(a,c,e){var f,h,i,j,k;return a.rate-c.rate<0&&(f=a,a=c,c=f),0===c?e:(h=-1===c,i=1===c,j=0===e,i&&j?a:h&&j?d.createBinaryOpUGen("*",a,-1):j?d.createBinaryOpUGen("*",a,c):h?d.createBinaryOpUGen("-",e,a):i?d.createBinaryOpUGen("+",a,e):b(a,c,e)?(k=g([a,c,e]),d.UGen.prototype.init.apply(this,[k,a,c,e])):b(c,a,e)?(k=g([c,a,e]),d.UGen.prototype.init.apply(this,[k,c,a,e])):a*c+e)};var b=function(a,b,c){return a=g(a),b=g(b),c=g(c),2===a?!0:1!==a||1!==b&&0!==b||1!==c&&0!==c?!1:!0};return a}(),i=function(){function a(){d.UGen.call(this,"Sum3")}return e(a,d.UGen),a.prototype.init=function(a,b,c){if(0===a)return d.createBinaryOpUGen("+",b,c);if(0===b)return d.createBinaryOpUGen("+",a,c);if(0===c)return d.createBinaryOpUGen("+",a,b);var e=g([a,b,c]),f=[a,b,c].sort(function(a,b){return b.rate-a.rate});return d.UGen.prototype.init.apply(this,[e].concat(f))},a}(),j=function(){function a(){d.UGen.call(this,"Sum4")}return e(a,d.UGen),a.prototype.init=function(a,b,c,e){if(0===a)return d.createSum3(b,c,e);if(0===b)return d.createSum3(a,c,e);if(0===c)return d.createSum3(a,b,e);if(0===e)return d.createSum3(a,b,c);var f=g([a,b,c,e]),h=[a,b,c,e].sort(function(a,b){return b.rate-a.rate});return d.UGen.prototype.init.apply(this,[f].concat(h))},a}();c.exports={use:function(){d.createMulAdd=f(function(a,b,c){return(new h).init(a,b,c)}).multiCall().build(),d.createSum3=f(function(a,b,c){return(new i).init(a,b,c)}).multiCall().build(),d.createSum4=f(function(a,b,c,d){return(new j).init(a,b,c,d)}).multiCall().build(),d.instanceOfMulAdd=function(a){return a instanceof h},d.instanceOfSum3=function(a){return a instanceof i},d.instanceOfSum4=function(a){return a instanceof j}}},c.exports.use()}),e("cc/lang/ugen/inout",function(a,b,c){var d=a("../cc"),e=a("../../common/extend"),f=a("../utils"),g=function(){function a(a){d.MultiOutUGen.call(this,"Control"),this.rate=a,this.values=null}return e(a,d.MultiOutUGen),a.prototype.init=function(a){return d.UGen.prototype.init.apply(this,[this.rate].concat(a)),this.values=a.slice(),this.initOutputs(this.values.length,this.rate)},a}();d.ugen.specs.In={ar:{defaults:"bus=0,numChannels=1",ctor:function(a,b){return this.init.call(this,2),this.inputs=[a],this.initOutputs(b,this.rate)},Klass:d.MultiOutUGen},kr:{defaults:"bus=0,numChannels=1",ctor:function(a,b){return this.init.call(this,1),this.inputs=[a],this.initOutputs(b,this.rate)},Klass:d.MultiOutUGen}};var h=function(){function a(){d.UGen.call(this,"Out")}return e(a,d.UGen),a}(),i=function(a){function b(b,c){if(!d.instanceOfUGen(b)&&"number"!=typeof b)throw new TypeError("Out: arguments[0] should be an UGen or a number.");Array.isArray(c)||(c=[c]),c=f.flatten(c),c=c.filter(function(a){return 0!==a}),c.length&&d.UGen.prototype.init.apply(new h,[a,b].concat(c))}return function(a,c){return Array.isArray(a)?a.forEach(function(a){b(a,c)}):b(a,c),0}};d.ugen.specs.Out={ar:{defaults:"bus=0,channelsArray=0",ctor:i(2),multiCall:!1,Klass:null},kr:{defaults:"bus=0,channelsArray=0",ctor:i(1),multiCall:!1,Klass:null}},c.exports={use:function(){d.createControl=function(a){return new g(a)},d.instanceOfOut=function(a){return a instanceof h}}},c.exports.use()}),e("cc/lang/ugen/mix",function(a,b,c){var d=a("../cc"),e=a("../utils"),f=function(a){Array.isArray(a)||(a=[a]);var b=e.clump(a,4),c=b.map(function(a){switch(a.length){case 4:return d.createSum4(a[0],a[1],a[2],a[3]);case 3:return d.createSum3(a[0],a[1],a[2]);case 2:return d.createBinaryOpUGen("+",a[0],a[1]);case 1:return a[0]}});switch(c.length){case 4:return d.createSum4(c[0],c[1],c[2],c[3]);case 3:return d.createSum3(c[0],c[1],c[2]);case 2:return d.createBinaryOpUGen("+",c[0],c[1]);case 1:return c[0];default:return f(c)}};d.global.Mix=function(a){return f(a)||[]},d.global.Mix.fill=function(a,b){a=0|a;for(var c=new Array(a),d=0;a>d;++d)c[d]=b(d);return f(c)},d.global.Mix.ar=function(){},c.exports={}}),e("cc/lang/ugen/bufio",function(a,b,c){var d=a("../cc"),e=[].slice,f=function(a){return function(b,c){if("number"!=typeof b)throw new TypeError("Buffer: arguments[0] should be an integer.");if(!d.instanceOfAudioBuffer(c))throw new TypeError("Buffer: arguments[1] should be a buffer.");return b=Math.max(0,0|b),this.init.apply(this,[a].concat(e.call(arguments,1))),this.specialIndex=c._bufId,this.initOutputs(b,this.rate)}};d.ugen.specs.PlayBuf={ar:{defaults:"numChannels=0,buffer,rate=1,trigger=1,startPos=0,loop=0,doneAction=0",ctor:f(2),Klass:d.MultiOutUGen},kr:{defaults:"numChannels=0,buffer,rate=1,trigger=1,startPos=0,loop=0,doneAction=0",ctor:f(1),Klass:d.MultiOutUGen}},c.exports={}}),e("cc/lang/ugen/delay",function(a,b,c){var d=a("../cc"),e={ar:{defaults:"in=0,maxdelaytime=0.2,delaytime=0.2,decaytime=1,mul=1,add=0",ctor:function(a,b,c,d,e,f){return this.init(2,a,b,c,d).madd(e,f)}},kr:{defaults:"in=0,maxdelaytime=0.2,delaytime=0.2,decaytime=1,mul=1,add=0",ctor:function(a,b,c,d,e,f){return this.init(2,a,b,c,d).madd(e,f)}}};d.ugen.specs.CombN=e,d.ugen.specs.CombL=e,d.ugen.specs.CombC=e,c.exports={}}),e("cc/lang/ugen/filter",function(a,b,c){var d=a("../cc");d.ugen.specs.RLPF={ar:{defaults:"in=0,freq=440,rq=1,mul=1,add=0",ctor:function(a,b,c,d,e){return this.init(2,a,b,c).madd(d,e)}},kr:{defaults:"in=0,freq=440,rq=1,mul=1,add=0",ctor:function(a,b,c,d,e){return this.init(1,a,b,c).madd(d,e)}}},d.ugen.specs.RHPF=d.ugen.specs.RLPF,c.exports={}}),e("cc/lang/ugen/line",function(a,b,c){var d=a("../cc");d.ugen.specs.Line={ar:{defaults:"start=0,end=1,dur=1,mul=1,add=0,doneAction=0",ctor:function(a,b,c,d,e,f){return this.init(2,a,b,c,f).madd(d,e)}},kr:{defaults:"start=0,end=1,dur=1,mul=1,add=0,doneAction=0",ctor:function(a,b,c,d,e,f){return this.init(1,a,b,c,f).madd(d,e)}}},c.exports={}}),e("cc/lang/ugen/osc",function(a,b,c){var d=a("../cc");d.ugen.specs.SinOsc={ar:{defaults:"freq=440,phase=0,mul=1,add=0",ctor:function(a,b,c,d){return this.init(2,a,b).madd(c,d)}},kr:{defaults:"freq=440,phase=0,mul=1,add=0",ctor:function(a,b,c,d){return this.init(1,a,b).madd(c,d)}}},d.ugen.specs.SinOscFB={ar:{defaults:"freq=440,feedback=0,mul=1,add=0",ctor:function(a,b,c,d){return this.init(2,a,b).madd(c,d)}},kr:{defaults:"freq=440,feedback=0,mul=1,add=0",ctor:function(a,b,c,d){return this.init(1,a,b).madd(c,d)}}},d.ugen.specs.LFSaw={ar:{defaults:"freq=440,iphase=0,mul=1,add=0",ctor:function(a,b,c,d){return this.init(2,a,b).madd(c,d)}},kr:{defaults:"freq=440,iphase=0,mul=1,add=0",ctor:function(a,b,c,d){return this.init(1,a,b).madd(c,d)}}},d.ugen.specs.LFPar=d.ugen.specs.LFSaw,d.ugen.specs.LFCub=d.ugen.specs.LFSaw,d.ugen.specs.LFTri=d.ugen.specs.LFSaw,d.ugen.specs.LFPulse={ar:{defaults:"freq=440,iphase=0,width=0.5,mul=1,add=0",ctor:function(a,b,c,d,e){return this.init(2,a,b,c).madd(d,e)}},kr:{defaults:"freq=440,iphase=0,width=0.5,mul=1,add=0",ctor:function(a,b,c,d,e){return this.init(1,a,b,c).madd(d,e)}}},c.exports={}}),e("cc/lang/ugen/pan",function(a,b,c){var d=a("../cc"),e=function(a){return function(b,c,e){return this.init.call(this,a,b,c,e),this.channels=[d.createOutputProxy(this.rate,this,0),d.createOutputProxy(this.rate,this,1)],this.numOfOutputs=2,this.channels}};d.ugen.specs.Pan2={ar:{defaults:"in=0,pos=0,level=1",ctor:e(2),Klass:d.MultiOutUGen},kr:{defaults:"in=0,pos=0,level=1",ctor:e(1),Klass:d.MultiOutUGen}},c.exports={}}),e("cc/lang/ugen/ui",function(a,b,c){var d=a("../cc"),e={kr:{defaults:"minval=0,maxval=1,warp=0,lag=0.2",ctor:function(a,b,c,d){return"exponential"===c?c=1:"number"!=typeof c&&(c=0),this.init(1,a,b,c,d)}}};d.ugen.specs.MouseX=e,d.ugen.specs.MouseY=e,d.ugen.specs.MouseButton={kr:{defaults:"minval=0,maxval=1,lag=0.2",ctor:function(a,b,c){return this.init(1,a,b,c)}}},c.exports={}}),e("cc/lang/lang-worker",function(b,c,d){var e=b("./cc"),f=b("../common/extend"),g=b("./utils").lang_onmessage,h=function(){function a(){e.opmode="worker",e.SynthLang.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=1024,this.bufLength=64}return f(a,e.SynthLang),a.prototype.sendToClient=function(a){postMessage(a)},a.prototype.process=function(){this.taskManager.process();var a=this.timelineResult.splice(0);this.sendToServer(["/processed",a])},a}();d.exports={use:function(){e.createWorkerSynthLang=function(){var b=new h;return a.onmessage=g,b}}},d.exports.use()}),e("cc/lang/lang-iframe",function(a,b,c){var d=a("./cc"),e=a("../common/extend"),f=a("./utils").lang_onmessage,g=function(){function b(){d.opmode="iframe",a("../common/browser"),d.SynthLang.call(this);var b=this;this.sampleRate=44100,this.channels=2,this.strmLength=2048,this.bufLength=128,this.server=d.createWebWorker(d.coffeeColliderPath),this.server.onmessage=function(a){b.recvFromServer(a.data)}}return e(b,d.SynthLang),b.prototype.sendToServer=function(a){this.server.postMessage(a)},b.prototype.process=function(){for(var a=this.taskManager,b=this.strmLength/this.bufLength,c=[];b--;)a.process(),c=c.concat(this.timelineResult.splice(0),0);this.sendToServer(["/processed",c])},b.prototype.extendCommands=function(b){a("../common/console").bind(b)},b}();c.exports={use:function(){d.createIFrameSynthLang=function(){var a=new g;return"undefined"!=typeof window&&(window.onmessage=function(b){b.ports[0].onmessage=f,a.sendToClient=function(a){b.ports[0].postMessage(a)},window.onmessage=null}),a}}},c.exports.use()}),e("cc/common/browser",function(a,b,c){var d=a("../cc");c.exports={use:function(){d.createWebWorker=function(a){return new Worker(a)},d.createWebSocket=function(a){return new WebSocket(a)},d.createXMLHttpRequest=function(){return new XMLHttpRequest},d.createMessageChannel=function(){return new MessageChannel},d.createHTMLIFrameElement=function(){var a=document.createElement("iframe");return a.style.width=0,a.style.height=0,a.style.border=0,document.body.appendChild(a),a}}},c.exports.use()}),e("cc/lang/lang-nodejs",function(a,b,c){var d=a("./cc"),e=a("../common/extend"),f=function(){function a(){d.opmode="nodejs",d.SynthLang.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=4096,this.bufLength=64}return e(a,d.SynthLang),a.prototype.process=function(){this.taskManager.process();var a=this.timelineResult.splice(0);this.sendToServer(["/processed",a])},a}();c.exports={use:function(){d.createNodeJSSynthLang=function(){var a=new f;return a}}},c.exports.use()}),e("cc/lang/lang-socket",function(a,b,c){var d=a("./cc"),e=a("../common/extend"),f=a("./utils").lang_onmessage,g=function(){function b(){d.opmode="nodejs",d.SynthLang.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=4096,this.bufLength=128,this.socketPath=null}return a("../common/browser"),e(b,d.SynthLang),b.prototype.process=function(){this.taskManager.process();var a=this.timelineResult.splice(0);this.sendToServer(["/processed",a])},b.prototype.openSocket=function(){var a=this,b=this.socket=d.createWebSocket(this.socketPath),c=[];b.binaryType="arraybuffer",b.onopen=function(){c.forEach(function(a){b.send(a)}),c=[]},b.onmessage=function(b){var c=b.data;return"string"!=typeof c?(a.sendToClient(new Int16Array(c)),void 0):(a.recvFromServer(JSON.parse(c)),void 0)},b.onclose=function(){},b.onerror=function(){},this.sendToServer=function(a){a instanceof Uint8Array?b.readyState===WebSocket.OPEN&&b.send(a.buffer):b.readyState===WebSocket.OPEN?b.send(JSON.stringify(a)):c.push(JSON.stringify(a))}},b.prototype.closeSocket=function(){this.socket.close(),this.socket=null},b.prototype.process=function(){for(var a=this.taskManager,b=this.strmLength/this.bufLength,c=[];b--;)a.process(),c=c.concat(this.timelineResult.splice(0),0);this.sendToServer(["/processed",c])},b.prototype.extendCommands=function(a){a["/socket/open"]=function(){this.openSocket()},a["/socket/close"]=function(){this.closeSocket()},a["/socket/sendToServer"]=function(a){this.sendToServer(a)},a["/socket/sendToClient"]=function(a){this.sendToClient(a)}},b}();c.exports={use:function(){d.createSocketSynthLang=function(){var a=new g;return"undefined"!=typeof window&&(window.onmessage=function(b){b.ports[0].onmessage=f,a.sendToClient=function(a){b.ports[0].postMessage(a)},a.socketPath=b.data,window.onmessage=null}),d.opmode="socket",a}}},c.exports.use()}),e("cc/lang/array",function(a,b,c){var d=a("./cc"),e=a("./fn"),f=a("../common/ops"),g=a("./utils"),h=function(a){e.definePrototypeProperty(Array,a,function(){return this.map(function(b){return b[a]()})})};h("__plus__"),h("__minus__"),f.UNARY_OP_UGEN_MAP.forEach(function(a){/^[a-z][a-zA-Z0-9_]*$/.test(a)&&h(a)
});var i=function(a,b){var c=a.length;return b%=2*c-2,b>=c&&(b=2*(c-1)-b),a[b]},j=function(a,b,c,d){var e=b.length-c.length;switch(d){case 1:e>0?b.splice(c.length):0>e&&c.splice(b.length);break;case 2:if(e>0)return b.map(function(b,d){return b[a](i(c,d))});if(0>e)return c.map(function(c,d){return i(b,d)[a](c)});break;case 3:case 4:var f=b.map(function(b){return c.map(function(c){return b[a](c)})});return 4===d?g.flatten(f):f}return b.length===c.length?b.map(function(b,d){return b[a](c[d])}):b.length>c.length?b.map(function(b,d){return b[a](c[d%c.length])}):c.map(function(c,d){return b[d%b.length][a](c)})},k=function(a){var b;b=f.UGEN_OP_ALIASES.hasOwnProperty(a)?f.UGEN_OP_ALIASES[a]:a,e.definePrototypeProperty(Array,a,function(c,e){return Array.isArray(c)?j(a,this,c,e):d.instanceOfUGen(c)?this.map(function(a){return d.createBinaryOpUGen(b,a,c)}):this.map(function(b){return b[a](c)})})};k("__add__"),k("__sub__"),k("__mul__"),k("__div__"),k("__mod__"),e.definePrototypeProperty(Array,"__and__",function(a){return d.createTaskWaitLogic("and",this.concat(a))}),e.definePrototypeProperty(Array,"__or__",function(a){return d.createTaskWaitLogic("or",this.concat(a))}),f.BINARY_OP_UGEN_MAP.forEach(function(a){/^[a-z][a-zA-Z0-9_]*$/.test(a)&&k(a)}),e.definePrototypeProperty(Array,"madd",e(function(a,b){return g.flop([this,a,b]).map(function(a){var b=a[0],c=a[1],e=a[2];return d.createMulAdd(b,c,e)})}).defaults("mul=1,add=0").multiCall().build()),d.global.SHORT=1,d.global.FOLD=2,d.global.TABLE=3,d.global.FLAT=4,c.exports={}}),e("cc/lang/boolean",function(a,b,c){var d=a("./cc"),e=a("./fn");e.definePrototypeProperty(Boolean,"__plus__",function(){return+this}),e.definePrototypeProperty(Boolean,"__minus__",function(){return-this}),e.definePrototypeProperty(Boolean,"__add__",function(a){return this+a}),e.definePrototypeProperty(Boolean,"__sub__",function(a){var b=this-a;return isNaN(b)?0:b}),e.definePrototypeProperty(Boolean,"__mul__",function(a){var b=this*a;return isNaN(b)?0:b}),e.definePrototypeProperty(Boolean,"__div__",function(a){var b=this/a;return isNaN(b)?0:b}),e.definePrototypeProperty(Boolean,"__mod__",function(a){var b=this%a;return isNaN(b)?0:b}),e.setupBinaryOp(Boolean,"__and__",function(a){return d.createTaskWaitLogic("and",[this].concat(a))}),e.setupBinaryOp(Boolean,"__or__",function(a){return d.createTaskWaitLogic("or",[this].concat(a))}),c.exports={}}),e("cc/lang/data",function(a,b,c){var d=a("./cc");d.global.DATA={get:function(a){return d.DATA[a]||""}},c.exports={}}),e("cc/lang/date",function(a,b,c){var d=a("./cc"),e=a("./fn");e.definePrototypeProperty(Date,"__plus__",function(){return+this}),e.definePrototypeProperty(Date,"__minus__",function(){return-this}),e.definePrototypeProperty(Date,"__add__",function(a){return this+a}),e.definePrototypeProperty(Date,"__sub__",function(a){var b=this-a;return isNaN(b)?0:b}),e.definePrototypeProperty(Date,"__mul__",function(a){var b=this*a;return isNaN(b)?0:b}),e.definePrototypeProperty(Date,"__div__",function(a){var b=this/a;return isNaN(b)?0:b}),e.definePrototypeProperty(Date,"__mod__",function(a){var b=this%a;return isNaN(b)?0:b}),e.setupBinaryOp(Date,"__and__",function(a){return d.createTaskWaitLogic("and",[this].concat(a))}),e.setupBinaryOp(Date,"__or__",function(a){return d.createTaskWaitLogic("or",[this].concat(a))}),c.exports={}}),e("cc/lang/function",function(a,b,c){var d=a("./cc"),e=a("./fn");e.definePrototypeProperty(Function,"__plus__",function(){return 0}),e.definePrototypeProperty(Function,"__minus__",function(){return 0}),e.definePrototypeProperty(Function,"__add__",function(a){return this.toString()+a}),e.definePrototypeProperty(Function,"__sub__",function(){return 0}),e.definePrototypeProperty(Function,"__mul__",function(a){if("function"==typeof a){var b=this,c=a;return function(){return b.call(null,c.apply(null,arguments))}}return 0}),e.definePrototypeProperty(Function,"__div__",function(){return 0}),e.definePrototypeProperty(Function,"__mod__",function(){return 0}),e.setupBinaryOp(Function,"__and__",function(a){return d.createTaskWaitLogic("and",[this].concat(a))}),e.setupBinaryOp(Function,"__or__",function(a){return d.createTaskWaitLogic("or",[this].concat(a))}),c.exports={}}),e("cc/lang/number",function(a,b,c){var d=a("./cc"),e=a("./fn");e.definePrototypeProperty(Number,"__plus__",function(){return+this}),e.definePrototypeProperty(Number,"__minus__",function(){return-this}),e.definePrototypeProperty(Number,"neg",function(){return-this}),e.definePrototypeProperty(Number,"not",function(){return 0===this?1:0}),e.definePrototypeProperty(Number,"abs",function(){return Math.abs(this)}),e.definePrototypeProperty(Number,"ceil",function(){return Math.ceil(this)}),e.definePrototypeProperty(Number,"floor",function(){return Math.floor(this)}),e.definePrototypeProperty(Number,"frac",function(){return 0>this?1+(this-(0|this)):this-(0|this)}),e.definePrototypeProperty(Number,"sign",function(){return 0===this?0:this>0?1:-1}),e.definePrototypeProperty(Number,"squared",function(){return this*this}),e.definePrototypeProperty(Number,"cubed",function(){return this*this*this}),e.definePrototypeProperty(Number,"sqrt",function(){return Math.sqrt(Math.abs(this))}),e.definePrototypeProperty(Number,"exp",function(){return Math.exp(this)}),e.definePrototypeProperty(Number,"reciprocal",function(){return 1/this}),e.definePrototypeProperty(Number,"midicps",function(){return 440*Math.pow(2,1*(this-69)/12)}),e.definePrototypeProperty(Number,"cpsmidi",function(){return 12*Math.log(1*Math.abs(this)/440)*Math.LOG2E+69}),e.definePrototypeProperty(Number,"midiratio",function(){return Math.pow(2,1*this/12)}),e.definePrototypeProperty(Number,"ratiomidi",function(){return 12*Math.log(Math.abs(this))*Math.LOG2E}),e.definePrototypeProperty(Number,"dbamp",function(){return Math.pow(10,.05*this)}),e.definePrototypeProperty(Number,"ampdb",function(){return 20*Math.log(Math.abs(this))*Math.LOG10E}),e.definePrototypeProperty(Number,"octcps",function(){return 440*Math.pow(2,this-4.75)}),e.definePrototypeProperty(Number,"cpsoct",function(){return Math.log(1*Math.abs(this)/440)*Math.LOG2E+4.75}),e.definePrototypeProperty(Number,"log",function(){return Math.log(Math.abs(this))}),e.definePrototypeProperty(Number,"log2",function(){return Math.log(Math.abs(this))*Math.LOG2E}),e.definePrototypeProperty(Number,"log10",function(){return Math.log(Math.abs(this))*Math.LOG10E}),e.definePrototypeProperty(Number,"sin",function(){return Math.sin(this)}),e.definePrototypeProperty(Number,"cos",function(){return Math.cos(this)}),e.definePrototypeProperty(Number,"tan",function(){return Math.tan(this)}),e.definePrototypeProperty(Number,"asin",function(){return Math.asin(Math.max(-1,Math.min(this,1)))}),e.definePrototypeProperty(Number,"acos",function(){return Math.acos(Math.max(-1,Math.min(this,1)))}),e.definePrototypeProperty(Number,"atan",function(){return Math.atan(this)}),e.definePrototypeProperty(Number,"sinh",function(){return.5*(Math.pow(Math.E,this)-Math.pow(Math.E,-this))}),e.definePrototypeProperty(Number,"cosh",function(){return.5*(Math.pow(Math.E,this)+Math.pow(Math.E,-this))}),e.definePrototypeProperty(Number,"tanh",function(){return this.sinh()/this.cosh()}),e.definePrototypeProperty(Number,"rand",function(){return Math.random()*this}),e.definePrototypeProperty(Number,"rand2",function(){return(2*Math.random()-1)*this}),e.definePrototypeProperty(Number,"linrand",function(){return Math.min(Math.random(),Math.random())*this}),e.definePrototypeProperty(Number,"bilinrand",function(){return(Math.random()-Math.random())*this}),e.definePrototypeProperty(Number,"sum3rand",function(){return.666666667*(Math.random()+Math.random()+Math.random()-1.5)*this}),e.definePrototypeProperty(Number,"distort",function(){return this/(1+Math.abs(this))}),e.definePrototypeProperty(Number,"softclip",function(){var a=Math.abs(this);return.5>=a?this:(a-.25)/this}),e.definePrototypeProperty(Number,"coin",function(){return Math.random()<this}),e.definePrototypeProperty(Number,"num",function(){return+this}),e.definePrototypeProperty(Number,"tilde",function(){return~this}),e.definePrototypeProperty(Number,"pi",function(){return this*Math.PI}),e.definePrototypeProperty(Number,"to_i",function(){return 0|this}),e.setupBinaryOp(Number,"__add__",function(a){return this+a}),e.setupBinaryOp(Number,"__sub__",function(a){return this-a}),e.setupBinaryOp(Number,"__mul__",function(a){return this*a}),e.setupBinaryOp(Number,"__div__",function(a){return 0===this&&0===a?0:this/a}),e.setupBinaryOp(Number,"__mod__",function(a){return 0===a?0:this%a}),e.setupBinaryOp(Number,"__and__",function(a){return d.createTaskWaitLogic("and",[this].concat(a))}),e.setupBinaryOp(Number,"__or__",function(a){return d.createTaskWaitLogic("or",[this].concat(a))}),e.setupBinaryOp(Number,"eq",function(a){return this===a?1:0}),e.setupBinaryOp(Number,"ne",function(a){return this!==a?1:0}),e.setupBinaryOp(Number,"lt",function(a){return a>this?1:0}),e.setupBinaryOp(Number,"gt",function(a){return this>a?1:0}),e.setupBinaryOp(Number,"le",function(a){return a>=this?1:0}),e.setupBinaryOp(Number,"ge",function(a){return this>=a?1:0}),e.setupBinaryOp(Number,"bitAnd",function(a){return this&a}),e.setupBinaryOp(Number,"bitOr",function(a){return this|a}),e.setupBinaryOp(Number,"bitXor",function(a){return this^a}),e.setupBinaryOp(Number,"min",function(a){return Math.min(this,a)}),e.setupBinaryOp(Number,"max",function(a){return Math.max(this,a)});var f=function(a,b,c){for(a=0|a,b=0|b;0!==b;)c=a%b,a=b,b=c;return Math.abs(a)};e.setupBinaryOp(Number,"lcm",function(a){return 0===this&&0===a?0:Math.abs(this*a)/f(this,a)}),e.setupBinaryOp(Number,"gcd",function(a){return f(this,a)}),e.setupBinaryOp(Number,"round",function(a){return 0===a?this:Math.round(this/a)*a}),e.setupBinaryOp(Number,"roundUp",function(a){return 0===a?this:Math.ceil(this/a)*a}),e.setupBinaryOp(Number,"roundDown",function(a){return 0===a?this:Math.floor(this/a)*a}),e.setupBinaryOp(Number,"trunc",function(a){return 0===a?this:Math.floor(this/a)*a}),e.setupBinaryOp(Number,"atan2",function(a){return Math.atan2(this,a)}),e.setupBinaryOp(Number,"hypot",function(a){return Math.sqrt(this*this+a*a)}),e.setupBinaryOp(Number,"hypotApx",function(a){var b=Math.abs(this),c=Math.abs(a),d=Math.min(b,c);return b+c-(Math.sqrt(2)-1)*d}),e.setupBinaryOp(Number,"pow",function(a){return Math.pow(Math.abs(this),a)}),e.setupBinaryOp(Number,"leftShift",function(a){return 0>a?(0|this)>>(0|-a):(0|this)<<(0|a)}),e.setupBinaryOp(Number,"rightShift",function(a){return 0>a?(0|this)<<(0|-a):(0|this)>>(0|a)}),e.setupBinaryOp(Number,"unsignedRightShift",function(a){return 0>a?(0|this)<<(0|-a):(0|this)>>(0|a)}),e.setupBinaryOp(Number,"ring1",function(a){return this*a+this}),e.setupBinaryOp(Number,"ring2",function(a){return this*a+this+a}),e.setupBinaryOp(Number,"ring3",function(a){return this*this*a}),e.setupBinaryOp(Number,"ring4",function(a){return this*this*a-this*a*a}),e.setupBinaryOp(Number,"difsqr",function(a){return this*this-a*a}),e.setupBinaryOp(Number,"sumsqr",function(a){return this*this+a*a}),e.setupBinaryOp(Number,"sqrsum",function(a){return(this+a)*(this+a)}),e.setupBinaryOp(Number,"sqrdif",function(a){return(this-a)*(this-a)}),e.setupBinaryOp(Number,"absdif",function(a){return Math.abs(this-a)}),e.setupBinaryOp(Number,"thresh",function(a){return a>this?0:this}),e.setupBinaryOp(Number,"amclip",function(a){return.5*this*(a+Math.abs(a))}),e.setupBinaryOp(Number,"scaleneg",function(a){return a=.5*a+.5,(Math.abs(this)-this)*a+this}),e.setupBinaryOp(Number,"clip2",function(a){return Math.max(-a,Math.min(this,a))}),e.setupBinaryOp(Number,"excess",function(a){return this-Math.max(-a,Math.min(this,a))}),e.setupBinaryOp(Number,"fold2",function(a){var b,c,d,e,f=this;if(b=f+a,f>=a){if(f=a+a-f,f>=-a)return f}else{if(!(-a>f))return f;if(f=-a-a-f,a>f)return f}return a===-a?-a:(d=a+a,e=d+d,c=b-e*Math.floor(b/e),c>=d&&(c=e-c),c-a)}),e.setupBinaryOp(Number,"wrap2",function(a){var b,c=this;if(c>=a){if(b=a+a,c-=b,a>c)return c}else{if(!(-a>c))return c;if(b=a+a,c+=b,c>=-a)return c}return a===-a?-a:c-b*Math.floor((c+a)/b)}),e.definePrototypeProperty(Number,"madd",e(function(a,b){return d.createMulAdd(this,a,b)}).defaults("mul=1,add=0").multiCall().build()),c.exports={}}),e("cc/lang/object",function(a,b,c){var d=a("./cc");d.Object.prototype.__and__=function(a){return d.createTaskWaitLogic("and",[this].concat(a))},d.Object.prototype.__or__=function(a){return d.createTaskWaitLogic("or",[this].concat(a))},c.exports={}}),e("cc/lang/string",function(a,b,c){var d=a("./fn"),e=a("./utils");d.definePrototypeProperty(String,"__plus__",function(){var a=+this;return isNaN(a)?0:a}),d.definePrototypeProperty(String,"__minus__",function(){var a=-this;return isNaN(a)?0:a}),d.setupBinaryOp(String,"__add__",function(a){return this+a}),d.setupBinaryOp(String,"__sub__",function(a){var b=this-a;return isNaN(b)?0:b});var f=function(){var a=function(b,c){if(1>c)return"";if(c%2)return a(b,c-1)+b;var d=a(b,c>>1);return d+d};return function(b,c){if(1/0===c)throw new RangeError;return a(b,0|c)}}();d.setupBinaryOp(String,"__mul__",function(a){return"number"==typeof a?f(this,a):0}),d.setupBinaryOp(String,"__div__",function(a){return"number"==typeof a?e.clump(this.split(""),Math.ceil(this.length/a)).map(function(a){return a.join("")}):0}),d.setupBinaryOp(String,"__mod__",function(a){return"number"==typeof a?e.clump(this.split(""),Math.floor(a)).map(function(a){return a.join("")}):0}),c.exports={}}),e("cc/client/client",function(a,b,c){var d=a("../cc"),e=a("../common/emitter"),f=a("../common/pack").unpack,g={},h=[].slice,i=function(){function a(a){e.mixin(this),a=a||{},this.version=d.version,this.impl=a.socket?d.createSynthClientSocketImpl(this,a):a.iframe?d.createSynthClientIFrameImpl(this,a):a.nodejs?d.createSynthClientNodeJSImpl(this,a):d.createSynthClientWorkerImpl(this,a),this.sampleRate=this.impl.sampleRate,this.channels=this.impl.channels}return a.prototype.play=function(){return this.impl.play(),this},a.prototype.pause=function(){return this.impl.pause(),this},a.prototype.reset=function(){return this.impl.reset(),this},a.prototype.execute=function(){return this.impl.execute.apply(this.impl,arguments),this},a.prototype.getStream=function(){return this.impl.getStream()},a.prototype.importScripts=function(){return this.impl.importScripts(h.call(arguments)),this},a.prototype.getWebAudioComponents=function(){return this.impl.getWebAudioComponents()},a}(),j=function(){function a(a,b){this.exports=a,this.compiler=d.createCompiler("coffee"),this.isPlaying=!1,this.execId=0,this.execCallbacks={},this.sampleRate=44100,this.channels=2,this.api=d.createAudioAPI(this,b),this.sampleRate=this.api.sampleRate,this.channels=this.api.channels,this.strm=new Int16Array(this.strmLength*this.channels),this.clear=new Int16Array(this.strmLength*this.channels),this.strmList=new Array(16),this.strmListReadIndex=0,this.strmListWriteIndex=0,this.syncCount=0,this.speaker=b.speaker!==!1,this.api.init();var c=new Uint8Array(20);if("undefined"!=typeof window&&b.mouse!==!1){var e=new Float32Array(c.buffer);window.addEventListener("mousemove",function(a){e[2]=a.pageX/window.innerWidth,e[3]=a.pageY/window.innerHeight},!1),window.addEventListener("mousedown",function(){e[4]=1},!1),window.addEventListener("mouseup",function(){e[4]=0},!1)}this.syncItems=c,this.syncItemsUInt32=new Uint32Array(c.buffer)}return a.prototype.play=function(){this.isPlaying||(this.isPlaying=!0,this.sendToLang(["/play"]))},a.prototype._played=function(a){if(this.api){for(var b=this.strm,c=0,d=b.length;d>c;++c)b[c]=0;this.strmList.splice(0),this.strmListReadIndex=0,this.strmListWriteIndex=0,this.syncCount=a,this.api.play()}this.exports.emit("play")},a.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,this.sendToLang(["/pause"]))},a.prototype._paused=function(){this.api&&this.api.pause(),this.exports.emit("pause")},a.prototype.reset=function(){this.execId=0,this.execCallbacks={};for(var a=this.strm,b=0,c=a.length;c>b;++b)a[b]=0;this.strmList.splice(0),this.strmListReadIndex=0,this.strmListWriteIndex=0,this.sendToLang(["/reset"]),this.exports.emit("reset")},a.prototype.process=function(){var a=this.strmList[15&this.strmListReadIndex];a&&(this.strmListReadIndex+=1,this.strm.set(a)),this.syncCount+=1,this.syncItemsUInt32[1]=this.syncCount,this.sendToLang(this.syncItems)},a.prototype.execute=function(a){var b,c,d=1;b="boolean"==typeof arguments[d]?arguments[d++]:!1,"function"==typeof arguments[d]&&(c=arguments[d++]),"string"==typeof a&&(a=this.compiler.compile(a.trim()),c&&(this.execCallbacks[this.execId]=c),this.sendToLang(["/execute",this.execId,a,b,this.compiler.data,!!c]),this.execId+=1)},a.prototype.getStream=function(){for(var a=new Float32Array(this.strm),b=a.length;b--;)a[b]*=30517578125e-15;var c=this.strmLength;return{getChannelData:function(b){return 0===b?new Float32Array(a.buffer,0,c):1===b?new Float32Array(a.buffer,4*c):void 0}}},a.prototype.importScripts=function(a){this.sendToLang(["/importScripts",a])},a.prototype.sendToLang=function(a){this.lang&&this.lang.postMessage(a)},a.prototype.recvFromLang=function(a){if(a instanceof Int16Array)this.strmList[15&this.strmListWriteIndex]=a,this.strmListWriteIndex+=1;else{var b=g[a[0]];if(!b)throw new Error("Unknown command: "+a[0]);b.call(this,a)}},a.prototype.readAudioFile=function(a,b){var c=this.api;if(this.api){if("string"!=typeof a)throw new TypeError("readAudioFile: first argument must be a String.");if("function"!=typeof b)throw new TypeError("readAudioFile: second argument must be a Function.");if(!c.decodeAudioFile)return b("Audio decoding not supported",null),void 0;var e=d.createXMLHttpRequest();e.open("GET",a),e.responseType="arraybuffer",e.onreadystatechange=function(){4===e.readyState&&(200===e.status&&e.response?c.decodeAudioFile(e.response,function(a,c){b(a,c)}):b("error",null))},e.send()}},a.prototype.getWebAudioComponents=function(){return this.api&&"Web Audio API"===this.api.type?[this.api.context,this.api.jsNode]:[]},a}();g["/connected"]=function(a){var b=a[3];b&&b.forEach(function(a){d.global[a]=!0}),this.sendToLang(["/init",this.sampleRate,this.channels]),this.exports.emit("connected")},g["/played"]=function(a){var b=a[1];this._played(b)},g["/paused"]=function(a){var b=a[1];this._paused(b)},g["/executed"]=function(a){var b=a[1],c=a[2],d=this.execCallbacks[b];d&&(void 0!==c&&(c=f(c)),d(c),delete this.execCallbacks[b])},g["/buffer/request"]=function(a){var b=this,c=a[2];this.readAudioFile(a[1],function(a,d){a||b.sendToLang(["/buffer/response",d,c])})},g["/socket/sendToClient"]=function(a){this.exports.emit("message",a[1])},a("../common/console").bind(g),d.SynthClientImpl=j,c.exports={SynthClient:i,SynthClientImpl:j,use:function(){a("./client-worker"),a("./client-iframe"),a("./client-nodejs"),a("./client-socket"),a("../common/browser"),a("../common/audioapi"),a("./compiler/compiler"),d.createSynthClient=function(a){return new i(a)},d.createSynthClientImpl=function(a,b){return new j(a,b)}}},c.exports.use()}),e("cc/client/client-worker",function(a,b,c){var d=a("../cc"),e=a("../common/extend"),f=function(){function a(a,b){d.opmode="worker",this.strmLength=1024,this.bufLength=64,d.SynthClientImpl.call(this,a,b);var c=this;this.lang=d.createWebWorker(d.coffeeColliderPath),this.lang.onmessage=function(a){c.recvFromLang(a.data)}}return e(a,d.SynthClientImpl),a}();c.exports={use:function(){d.createSynthClientWorkerImpl=function(a,b){return new f(a,b)}}},c.exports.use()}),e("cc/client/client-iframe",function(a,b,c){var d=a("../cc"),e=a("../common/extend"),f=function(){function a(a,b){d.opmode="iframe",this.strmLength=2048,this.bufLength=128,d.SynthClientImpl.call(this,a,b);var c=this,e=this.iframe=d.createHTMLIFrameElement();e.sandbox="allow-scripts allow-same-origin",e.srcdoc="<script src='"+d.coffeeColliderPath+"#iframe'></script>";var f=d.createMessageChannel();e.onload=function(){e.contentWindow.postMessage(null,[f.port2],"*")},f.port1.onmessage=function(a){c.recvFromLang(a.data)},this.lang=f.port1}return e(a,d.SynthClientImpl),a}();c.exports={use:function(){d.createSynthClientIFrameImpl=function(a,b){return new f(a,b)}}},c.exports.use()}),e("cc/client/client-nodejs",function(a,b,c){var d=a("../cc"),e=a("../common/extend"),f=function(){function a(a,b){d.opmode="nodejs",this.strmLength=4096,this.bufLength=64,d.SynthClientImpl.call(this,a,b),this.api=null}return e(a,d.SynthClientImpl),a}();c.exports={use:function(){d.createSynthClientNodeJSImpl=function(a,b){return new f(a,b)}}},c.exports.use()}),e("cc/client/client-socket",function(a,b,c){var d=a("../cc"),e=a("../common/extend"),f=function(){function a(a,b){d.opmode="socket",this.strmLength=4096,this.bufLength=128,d.SynthClientImpl.call(this,a,b);var c=this,e=this.iframe=d.createHTMLIFrameElement();e.sandbox="allow-scripts",e.srcdoc="<script src='"+d.coffeeColliderPath+"#socket'></script>";var f=d.createMessageChannel();e.onload=function(){e.contentWindow.postMessage(b.socket,[f.port2],"*")},f.port1.onmessage=function(a){c.recvFromLang(a.data)},this.lang=f.port1,a.socket={open:function(){c.sendToLang(["/socket/open"])},close:function(){c.sendToLang(["/socket/close"])},send:function(a){c.sendToLang(["/socket/sendToServer",a])}}}return e(a,d.SynthClientImpl),a}();c.exports={use:function(){d.createSynthClientSocketImpl=function(a,b){return new f(a,b)}}},c.exports.use()}),e("cc/common/audioapi",function(a,b,c){var d=a("../cc");a("./audioapi-webaudio"),a("./audioapi-audiodata"),a("./audioapi-flashfallback"),a("./audioapi-nodeaudio"),c.exports={use:function(){d.createAudioAPI=function(a,b){return d.createWebAudioAPI(a,b)||d.createAudioDataAPI(a,b)||d.createFlashAudioAPI(a,b)||d.createNodeAudioAPI(a,b)}}},c.exports.use()}),e("cc/common/audioapi-webaudio",function(b,c,d){var e,f=b("../cc");if("undefined"!=typeof document){var g=a.AudioContext||a.webkitAudioContext;g&&(e=function(){function a(a,b){this.sys=a,this.context=b.AudioContext||new g,this.sampleRate=this.context.sampleRate,this.channels=2,this.type="Web Audio API",this.delegate=!!b.AudioContext}return a.prototype.init=function(){var a,b=this.sys,c=b.strm,d=b.strmLength;this.sys.speaker?this.sys.sampleRate===this.sampleRate&&(a=function(a){var e=a.outputBuffer,f=e.getChannelData(0),g=e.getChannelData(1),h=d,i=d<<1;for(b.process();i--,h--;)f[h]=30517578125e-15*c[h],g[h]=30517578125e-15*c[i]}):a=function(){b.process()},this.bufSrc=this.context.createBufferSource(),this.jsNode=this.context.createScriptProcessor?this.context.createScriptProcessor(d,2,this.channels):this.context.createJavaScriptNode(d,2,this.channels),this.jsNode.onaudioprocess=a},a.prototype.play=function(){this.bufSrc&&(this.bufSrc.noteOn&&(this.bufSrc.noteOn(0),this.bufSrc.connect(this.jsNode)),this.delegate||this.jsNode.connect(this.context.destination))},a.prototype.pause=function(){this.bufSrc&&(this.bufSrc.disconnect(),this.delegate||this.jsNode.disconnect())},a.prototype.decodeAudioFile=function(a,b){a=this.context.createBuffer(a,!1);var c,d,e=a.length,f=a.numberOfChannels,g=e*f,h=new Float32Array(g),i=0,j=new Array(f);for(d=0;f>d;++d)j[d]=a.getChannelData(d);for(c=0;e>c;++c)for(d=0;f>d;++d)h[i++]=j[d][c];b(null,{sampleRate:a.sampleRate,numChannels:a.numberOfChannels,numFrames:a.length,samples:h})},a}())}d.exports={use:function(){f.createWebAudioAPI=function(a,b){return e?new e(a,b):void 0}}},d.exports.use()}),e("cc/common/audioapi-audiodata",function(a,b,c){var d,e=a("../cc");"undefined"!=typeof document&&"function"==typeof Audio&&"function"==typeof(new Audio).mozSetup&&(d=function(){function a(a){this.sys=a,this.sampleRate=44100,this.channels=2,this.type="Audio Data API"}var b=function(){var a="var t=0;onmessage=function(e){if(t)t=clearInterval(t),0;if(typeof e.data=='number'&&e.data>0)t=setInterval(function(){postMessage(0);},e.data);};",b=new Blob([a],{type:"text/javascript"}),c=URL.createObjectURL(b);return new Worker(c)}();return a.prototype.init=function(){this.audio=new Audio,this.interleaved=new Float32Array(this.sys.strmLength*this.sys.channels)},a.prototype.play=function(){if(this.audio){var a=this.sys,c=this.audio,d=this.interleaved,e=1e3*(a.strmLength/a.sampleRate),f=0,g=Date.now(),h=new Int16Array(a.strm.buffer,0,a.strmLength),i=new Int16Array(a.strm.buffer,2*a.strmLength),j=function(){if(!(f-20>Date.now()-g)){var b=d.length,j=h.length;for(a.process();j--;)d[--b]=30517578125e-15*i[j],d[--b]=30517578125e-15*h[j];c.mozWriteAudio(d),f+=e}};c.mozSetup(a.channels,a.sampleRate),b.onmessage=j,b.postMessage(.8*e)}},a.prototype.pause=function(){this.audio&&b.postMessage(0)},a}()),c.exports={use:function(){e.createAudioDataAPI=function(a,b){return d?new d(a,b):void 0}}},c.exports.use()}),e("cc/common/audioapi-flashfallback",function(a,b,c){var d,e=a("../cc");"undefined"!=typeof document&&(d=function(){function a(a){this.sys=a,this.sampleRate=44100,this.channels=2,this.type="Fallback"}a.prototype.init=function(){},a.prototype.play=function(){b.play&&(this.play=b.play,this.play())},a.prototype.pause=function(){b.pause&&(this.pause=b.pause,this.pause())};var b={};return window.addEventListener("load",function(){var a=e.rootPath+"coffee-collider-fallback.swf",c=a+"?"+Date.now(),d="coffee-collider-fallback",f=document.createElement("div");f.style.display="inline",f.width=1,f.height=1,f.innerHTML='<object id="'+d+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1"><param name="movie" value="'+c+'"/><param name="bgcolor" value="#FFFFFF"/><param name="quality" value="high"/><param name="allowScriptAccess" value="always"/></object>',document.body.appendChild(f),window.coffeecollider_flashfallback_init=function(){var a=document.getElementById(d),c=0;b.play=function(){if(0===c){var b=this.sys,d=1e3*(b.strmLength/b.sampleRate),e=0,f=Date.now(),g=new Array(b.strmLength*b.channels),h=g.length,i=function(){if(!(e>Date.now()-f)){b.process();for(var c=b.strm,i=0;h>i;++i)g[i]=String.fromCharCode((c[i]+32768>>1)+16384);a.writeAudio(g.join("")),e+=d}};c=setInterval(i,.8*d),a.play()}},b.pause=function(){0!==c&&(a.pause(),clearInterval(c),c=0)}}}),a}()),c.exports={use:function(){e.createFlashAudioAPI=function(a,b){return d?new d(a,b):void 0}}},c.exports.use()}),e("cc/common/audioapi-nodeaudio",function(b,c,d){var e,f=b("../cc");"undefined"!=typeof a.GLOBAL&&(e=function(){function b(a){this.sys=a,this.sampleRate=44100,this.channels=2,this.node=null,this.isPlaying=!1}var c=a.require("stream").Readable,d=a.require("speaker");return c||(c=a.require("readable-stream/readable")),b.prototype.init=function(){},b.prototype.play=function(){var a=this.sys;this.isPlaying=!0,this.node=new c,this.node._read=function(b){var c,d,e,f=a._strm,g=a.strmLength,h=new Buffer(b),i=0;for(b=(b>>2)/a.strmLength,c=f;b--;)for(a._process(),d=0,e=g;g>d;++d,++e)h.writeInt16LE(f[d],i),i+=2,h.writeInt16LE(f[e],i),i+=2;this.push(h)},this.node.pipe(new d({sampleRate:this.sampleRate}))},b.prototype.pause=function(){this.node&&process.nextTick(this.node.emit.bind(this.node,"end")),this.node=null,this.isPlaying=!1},b}()),d.exports={use:function(){f.createNodeAudioAPI=function(a,b){return e?new e(a,b):void 0}}},d.exports.use()}),e("cc/client/compiler/compiler",function(a,b,c){var d=a("../../cc"),e=function(){a("./coffee"),d.createCompiler=function(a){if("coffee"===a)return d.createCoffeeCompiler();throw new TypeError("Compiler: '"+a+"' not supported")}};c.exports={use:e},c.exports.use()}),e("cc/client/compiler/coffee",function(b,c,d){var e=a.CoffeeScript||a.require("coffee-script"),f=b("../../cc"),g=b("../../common/timevalue").calc,h=0,i=1,j={},k=function(a){return!!a&&("."===a[h]||"@"===a[h])},l=function(a){var b=a[i];return b.reserved?b[0]+b[1]+(b[2]||"")+(b[3]||"")+(b[4]||"")+(b[5]||"")+(b[6]||"")+(b[7]||""):b},m=function(a,b){for(var c=0,d={tokens:a,begin:b,end:-1,len:0,isLastLine:!1},e=b,f=a.length;f>e;++e){switch(a[e][h]){case"(":case"{":case"[":case"CALL_START":case"PARAM_START":case"INDEX_START":c+=1;break;case"]":case"}":case")":case"CALL_END":case"PARAM_END":case"INDEX_END":c-=1;break;case"TERMINATOR":0===c&&(d.end=e);break;case"INDENT":c+=1;break;case"OUTDENT":c-=1,-1===c&&(d.end=e-1,d.isLastLine=!0)}if(-1!==d.end)break}return-1===d.end&&(d.end=a.length-1),d.len=d.end-d.begin+1,d},n=function(a,b){for(var c=0,d=b,e=a.length;e>d;++d)switch(a[d][h]){case"PARAM_START":c+=1;break;case"PARAM_END":if(c-=1,0===c)return d}return-1},o=function(a,b){for(var c=b,d=a.length;d>c&&"TERMINATOR"!==a[c][h]&&"."!==a[c][h];++c)if("->"===a[c][h]||"=>"===a[c][h]||"PARAM_START"===a[c][h])return c;return-1},p=function(a){return a.tokens.slice(a.begin,a.end+1).map(function(b,c){return"STRING"===b[h]&&"'"===b[i].charAt(0)?'"'+b[i].substr(1,b[i].length-2)+'"':"IDENTIFIER"===b[h]&&":"===a.tokens[a.begin+c+1][h]?'"'+b[i]+'"':b[i]}).join("")},q=function(a){if(a.cc_plusminus)return a;for(var b="",c=0,d=a.length;d>c;++c){var e=a[c][h];if("+"===e||"-"===e)switch(b){case"IDENTIFIER":case"NUMBER":case"STRING":case"BOOL":case"REGEX":case"NULL":case"UNDEFINED":case"]":case"}":case")":case"CALL_END":case"INDEX_END":a[c][h]="MATH";break;default:a[c][h]="UNARY"}b=e}return a.cc_plusminus=!0,a},r=function(a){if(!a.cc_plusminus){for(var b=0,c=a.length;c>b;++b){var d=a[b][i];("+"===d||"-"===d)&&(a[b][h]=d)}return a}return delete a.cc_plusminus,a},s=function(a,b){a=q(a);for(var c=0,d=0,e=b;b>1;){switch(a[b][h]){case"(":case"[":case"{":case"PARAM_START":case"CALL_START":case"INDEX_START":c-=1;break;case"}":case"]":case")":case"PARAM_END":case"CALL_END":case"INDEX_END":c+=1;break;case"OUTDENT":d+=1;break;case"INDENT":d-=1}switch(a[b-1][h]){case"PARAM_END":case"CALL_END":case"INDEX_END":case".":case"@":b-=1;continue}switch(a[b][h]){case"(":case"[":case"{":case"PARAM_START":case"IDENTIFIER":case"NUMBER":case"BOOL":case"STRING":case"REGEX":case"UNDEFINED":case"NULL":case"@":case"THIS":case"SUPER":case"->":case"=>":if(0===c&&0===d){for(var f;(f=a[b-1])&&"UNARY"===f[h];)b-=1;return{tokens:a,begin:b,end:e}}}b-=1}return{tokens:a,begin:0,end:e}},t=function(a,b){a=q(a);var c=0,d=0,e=b,f=a.length-2;if(a[b]&&"@"===a[b][h]&&"IDENTIFIER"!==a[b+1][h])return{tokens:a,begin:b,end:b};for(;f>b;){var g=a[b][h];switch(g){case"(":case"[":case"{":case"PARAM_START":c+=1;break;case"}":case"]":case")":case"PARAM_END":case"CALL_END":case"INDEX_END":c-=1;break;case"INDENT":d+=1;break;case"OUTDENT":d-=1}switch(a[b+1][h]){case"CALL_START":case"INDEX_START":c+=1,b+=1;continue;case".":case"@":case"ELSE":b+=1;continue}switch(g){case"}":case"]":case")":case"CALL_END":case"INDEX_END":case"IDENTIFIER":case"NUMBER":case"BOOL":case"STRING":case"REGEX":case"UNDEFINED":case"NULL":case"OUTDENT":if(0===c&&0===d)return{tokens:a,begin:e,end:b}}b+=1}return{tokens:a,begin:e,end:Math.max(0,a.length-2)}},u={},v=function(a){if(a.cc_funcParams)return a;var b=[{declared:[],args:[],local:[],outer:[]}];b.setVariables=u.setVariables(b);for(var c=0,d=[],e=[],f=0,g=a.length-1;g>f;++f){var j,k=a[f];switch(b.peek=b[b.length-1],k[h]){case"PARAM_START":d=u.getInfoOfArguments(a,f),f=d.end+1,e=d.vars,d=d.args;case"->":case"=>":var l={declared:b.peek.declared.concat(b.peek.local),args:e.splice(0),local:[],outer:[],indent:c};a[f].cc_funcParams={args:d.splice(0),local:l.local,outer:l.outer},k.cc_funcRef=a[f],b.push(l);break;case"FOR":do j=t(a,f+1),u.getVariables(j).forEach(b.setVariables),f=j.end+1;while(g>f&&","===a[f][h]);break;case"INDENT":c+=1;break;case"OUTDENT":c-=1,b.peek.indent===c&&b.pop();break;case"[":j=t(a,f),u.getVariables(j).forEach(b.setVariables);break;case"IDENTIFIER":if("CALL_START"===a[f+1][h]||/^[A-Z]/.test(k[i]))break;j=t(a,f),(j.begin===j.end&&":"!==a[j.end+1][h]||"."===a[j.begin+1][h])&&u.getVariables(j).forEach(b.setVariables)}}return a.cc_funcParams={local:b[0].local},a};u.setVariables=function(a){var b=["cc","global","console","setInterval","setTimeout","clearInterval","clearTimeout"];return function(c){if(-1===b.indexOf(c)){if(-1===a.peek.declared.indexOf(c))return-1===a.peek.args.indexOf(c)&&-1===a.peek.local.indexOf(c)&&a.peek.local.push(c),void 0;if(-1===a.peek.outer.indexOf(c)){a.peek.outer.push(c);
for(var d=a.length-2;d>=0;d--){if(-1!==a[d].local.indexOf(c))return;-1===a[d].outer.indexOf(c)&&a[d].outer.push(c)}}}}},u.getInfoOfArguments=function(a,b){for(var c=b,d=n(a,b),e=[],f=[],g=c+1;d>g;++g){var i=t(a,g);f.push(p(i)),e=u.getVariables(i,e),g+=i.end-i.begin+1,"="===a[g][h]?(i=t(a,g+1),f.push(p(i)),g+=i.end-i.begin+1):f.push(null),","!==a[g][h]&&(g+=1)}return{vars:e,args:f,end:d}},u.getVariables=function(a,b){var c=a.tokens;if(b=b||[],"["===c[a.begin][h]&&"]"===c[a.end][h])for(var d=a.begin+1,e=a.end;e>d;++d){var f=t(c,d);b=u.getVariables(f,b),d+=f.end-f.begin+1,","!==c[d][h]&&(d+=1)}else k(c[a.begin-1])||/^[a-z][a-zA-Z0-9_$]*$/.test(c[a.begin][i])&&b.push(c[a.begin][i]);return b};var w=function(a){for(var b=0,c=a.length;c>b;++b){var d=a[b];if("STRING"===d[h]&&'"'===d[i].charAt(0)){var e=g(d[i].substr(1,d[i].length-2));"number"==typeof e&&(d[h]="NUMBER",d[i]=e.toString())}}return a},x=function(a){a=q(a);for(var b=a.length-1;b>0;b--){var c=a[b];if("MATH"===c[h]&&"+"!==c[i]&&"-"!==c[i]){var d=s(a,b),e=t(a,b);a.splice(e.end+1,0,[")",")",j]),a.splice(d.begin,0,["(","(",j])}}return a},y={operatorDict:{"+":"__plus__","-":"__minus__"}},z=function(a){a=q(a);for(var b=a.length-1;b>=0;b--){var c=a[b];if("UNARY"===c[h]&&y.operatorDict.hasOwnProperty(c[i])){var d=y.operatorDict[c[i]],e=t(a,b);a.splice(e.end+1,0,[".",".",j],["IDENTIFIER",d,j],["CALL_START","(",j],["CALL_END",")",j]),a.splice(b,1)}}return a},A={operatorDict:{"+":"__add__","-":"__sub__","*":"__mul__","/":"__div__","%":"__mod__"},adverbs:{W:"WRAP",S:"SHORT",C:"CLIP",F:"FOLD",T:"TABLE",X:"FLAT",WRAP:"WRAP",SHORT:"SHORT",CLIP:"CLIP",FOLD:"FOLD",TABLE:"TABLE",FLAT:"FLAT"}},B=function(a){return Object.keys(A.adverbs).forEach(function(b){var c=new RegExp("([+\\-*/%])("+b+")\\1","g"),d='$1 "#!'+b.charAt(0)+'"'+" $1";a=a.replace(c,d)}),a},C=function(a){a=q(a);for(var b=a.length-1;b>=0;b--){var c=a[b];if("MATH"===c[h]&&A.operatorDict.hasOwnProperty(c[i])){var d=A.operatorDict[c[i]],e=A.checkAdvarb(a,b),f=t(a,b);e?(b-=2,a.splice(b,3,[".",".",j],["IDENTIFIER",d,j],["CALL_START","(",j]),a.splice(f.end+1,0,[",",",",j],["IDENTIFIER",e,j],["CALL_END",")",j])):(a.splice(b,1,[".",".",j],["IDENTIFIER",d,j],["CALL_START","(",j]),a.splice(f.end+3,0,["CALL_END",")",j]))}}return a};A.checkAdvarb=function(a,b){var c=a[b],d=a[b-1],e=a[b-2];if(c&&d&&e&&/^"#![WSCFTX]"$/.test(d[i])){var f=d[i].charAt(3);if(c[i]===e[i]&&A.adverbs.hasOwnProperty(f))return A.adverbs[f]}};var D={operatorDict:{"+=":"__add__","-=":"__sub__","*=":"__mul__","/=":"__div__","%=":"__mod__"}},E=function(a){for(var b=a.length;--b>0;){var c=a[b];if(D.operatorDict.hasOwnProperty(c[i])){var d=D.operatorDict[c[i]],e=s(a,b),f=t(a,b);a.splice(b,1,["=","=",j],[".",".",j],["IDENTIFIER",d,j],["CALL_START","(",j]),a.splice(f.end+4,0,["CALL_END",")",j]);for(var g=[b+1,0],h=e.begin;b>h;++h)g.push(a[h]);a.splice.apply(a,g)}}return a},F={operatorDict:{"&&":"__and__","||":"__or__"}},G=function(a){for(var b=!1,c=1;c<a.length;++c){var d=a[c];if("wait"!==d[i]||"@"!==a[c-1][h])if(","!==d[h]){if(b&&"LOGIC"===d[h]&&F.operatorDict.hasOwnProperty(d[i])){var e=F.operatorDict[d[i]],f=t(a,c);a.splice(c,1,[".",".",j],["IDENTIFIER",e,j],["CALL_START","(",j]),a.splice(f.end+3,0,["CALL_END",")",j]),c=f.end+3}}else b=!1;else b=!0}return a},H={},I=function(a){a=v(a);for(var b=a.length-4;b--;)if(!(b&&"."===a[b-1][h]||"SynthDef"!==a[b][i])){var c=o(a,b+2);if(-1!==c){var d;d=a[c].cc_funcRef?a[c].cc_funcRef.cc_funcParams.args:[],H.replaceSynthDefDefaultArguments(a,c,d),c=t(a,c).end+1,H.insertSynthDefArgumentsToAfterFunction(a,c,d)}}return a};H.replaceSynthDefDefaultArguments=function(a,b,c){if(c.length){var d=n(a,b)-b+1,e=[b,d];e.push(["PARAM_START","(",j]);for(var f=0,g=c.length;g>f;f+=2)f&&e.push([",",",",j]),e.push(["IDENTIFIER",c[f],j]);e.push(["PARAM_END",")",j]),a.splice.apply(a,e)}},H.insertSynthDefArgumentsToAfterFunction=function(a,b,c){var d=[b,0];d.push([",",",",j],["[","[",j]);for(var e=0,f=c.length;f>e;++e)e&&d.push([",",",",j]),d.push(["STRING","'"+(c[e]||0)+"'",j]);d.push(["]","]",j]),a.splice.apply(a,d)};var J={contextMethods:["wait","break","continue","redo","recursive","return"]},K=function(a){a=v(a);for(var b=a.length-4;b--;)if(!(b&&"."===a[b-1][h]||"Task"!==a[b][i])){var c=o(a,b+2);-1!==c&&J.makeSegmentedFunction(t(a,c),J.contextMethods)}return a};J.makeSegmentedFunction=function(a,b){var c,d,e,f=a.tokens,g=f.splice(a.begin,a.end-a.begin+1),h=f.splice(a.begin),i=g[0].cc_funcRef;i?(c=i.cc_funcParams.local,d=i.cc_funcParams.outer,e=i.cc_funcParams.args.filter(function(a,b){return!(1&b)})):c=d=e=[],e.length&&g.splice(0,n(g,0)+1),g.splice(0,2),g.pop();var k=[];J.beginOfSegmentedFunction(k,d),J.insertLocalVariables(k,c),k.push(["[","[",j],["INDENT",2,j]);for(var l=0;g.length;)l++&&k.push(["TERMINATOR","\n",j]),J.beginOfSegment(k,e),J.insertSegment(k,g,b),J.endOfSegment(k,e);k.push(["OUTDENT",2,j],["]","]",j]),J.endOfSegmentedFunction(k,d);for(var m=k.length;m--;)k[m].cc_tasked=!0;f.push.apply(f,k),f.push.apply(f,h)},J.beginOfSegmentedFunction=function(a,b){if(b.length){a.push(["UNARY","do",j],["PARAM_START","(",j]);for(var c=0,d=b.length;d>c;++c)c&&a.push([",",",",j]),a.push(["IDENTIFIER",b[c],j]);a.push(["PARAM_END",")",j],["->","->",j],["INDENT",2,j])}a.push(["->","->",j],["INDENT",2,j])},J.endOfSegmentedFunction=function(a,b){a.push(["OUTDENT",2,j]),b.length&&a.push(["OUTDENT",2,j])},J.insertLocalVariables=function(a,b){if(b.length){for(var c=0,d=b.length;d>c;c++)a.push(["IDENTIFIER",b[c],j],["=","=",j]);a.push(["UNDEFINED","undefined",j],["TERMINATOR","\n",j])}},J.beginOfSegment=function(a,b){if(b.length){a.push(["PARAM_START","(",j]);for(var c=0,d=b.length;d>c;++c)c&&a.push([",",",",j]),a.push(["IDENTIFIER",b[c],j]);a.push(["PARAM_END",")",j])}a.push(["->","->",j],["INDENT",2,j])},J.endOfSegment=function(a){a.push(["OUTDENT",2,j])},J.insertSegment=function(a,b,c){for(var d=!1;!d&&b.length;){var e=m(b,0),f=J.getClosureVariables(e);J.beginOfLine(a,e,f);for(var g=e.len;g--;)!b[0].cc_tasked&&"@"===b[0][h]&&b[1]&&-1!==c.indexOf(l(b[1]))&&(d=!0),a.push(b.shift());J.endOfLine(a,e,f)}},J.getClosureVariables=function(a){for(var b=a.tokens,c=[],d=0,e=a.len;e>d;++d)b[d].cc_tasked||"->"!==b[d][h]&&"=>"!==b[d][h]||c.push.apply(c,b[d].cc_funcParams.outer);var f={};return c.filter(function(a){return f[a]?!1:!!(f[a]=!0)})},J.beginOfLine=function(a,b,c){var d,e;if(c.length){for(J.insertAssignment(a,b),a.push(["UNARY","do",j],["PARAM_START","(",j]),d=0,e=c.length;e>d;++d)d&&a.push([",",",",j]),a.push(["IDENTIFIER",c[d],j]);a.push(["PARAM_END",")",j],["->","->",j],["INDENT",2,j])}},J.endOfLine=function(a,b,c){c.length&&a.push(["OUTDENT",2,j],["TERMINATOR","\n",j])},J.insertAssignment=function(a,b){var c=[],d=b.tokens;if("IDENTIFIER"===d[0][h]){var e=t(d,0);d[e.end+1]&&"="===d[e.end+1][h]&&(c=d.slice(0,e.end+2))}a.push.apply(a,c)};var L=function(a){for(var b=a.length-1;b--;){var c=a[b];if("IDENTIFIER"===c[h]&&/^\$[a-z][a-zA-Z0-9_]*$/.test(c[i])){if(":"===a[b+1][h])continue;if(k(a[b-1]))continue;a.splice(b,1,["IDENTIFIER","global",j],[".",".",j],["IDENTIFIER",c[i].substr(1),j])}}return a},M=function(a){for(var b=a.length-1;b--;){var c=a[b];if("IDENTIFIER"===c[h]&&f.global.hasOwnProperty(c[i])){if(":"===a[b+1][h])continue;if(k(a[b-1]))continue;a.splice(b,0,["IDENTIFIER","cc",j],[".",".",j])}}return a},N=function(a){return a.unshift(["(","(",j],["PARAM_START","(",j],["IDENTIFIER","global",j],["PARAM_END",")",j],["->","->",j],["INDENT",2,j]),a.push(["OUTDENT",2,j],[")",")",j],[".",".",j],["IDENTIFIER","call",j],["CALL_START","(",j],["IDENTIFIER","cc",j],[".",".",j],["IDENTIFIER","__context__",j],[",",",",j],["THIS","this",j],[".",".",j],["IDENTIFIER","self",j],["LOGIC","||",j],["IDENTIFIER","global",j],["CALL_END",")",j]),a},O=function(a){for(var b="",c=0;a>c;++c)b+="  ";return b},P=function(a){var b=0;return a=q(a),a.map(function(a){switch(a[h]){case"TERMINATOR":return"\n"+O(b);case"INDENT":return b+=1,"\n"+O(b);case"OUTDENT":return b-=1,"\n"+O(b);case"RETURN":return"return ";case"UNARY":return a[i]+(a[i].length>1?" ":"");case"{":return"{";case",":case"RELATION":case"IF":case"SWITCH":case"LEADING_WHEN":return a[i]+" ";case"=":case"COMPARE":case"MATH":case"LOGIC":return" "+a[i]+" ";case"HERECOMMENT":return"/* "+a[i]+" */";default:return a[i]}}).join("").split("\n").filter(function(a){return!/^\s*$/.test(a)}).join("\n").trim()},Q=function(){function a(){}return a.prototype.tokens=function(a){var b=[];a=B(a);var c=e.tokens(a);return c.length&&(c.forEach(function(a){"HERECOMMENT"===a[h]&&b.push(a[i].trim())}),c=L(c),c=w(c),c=x(c),c=z(c),c=C(c),c=E(c),c=G(c),c=I(c),c=K(c),c=M(c),c=N(c)),this.code=a,this.data=b,c},a.prototype.compile=function(a){var b=this.tokens(a);return e.nodes(b).compile({bare:!0}).trim()},a.prototype.toString=function(a){return"string"==typeof a&&(a=this.tokens(a)),P(a)},a}(),R=function(){f.createCoffeeCompiler=function(){return new Q}};d.exports={CoffeeCompiler:Q,detectPlusMinusOperator:q,revertPlusMinusOperator:r,getPrevOperand:s,getNextOperand:t,detectFunctionParameters:v,replaceTextBinaryAdverb:B,replaceFixedTimeValue:w,replaceStrictlyPrecedence:x,replaceUnaryOperator:z,replaceBinaryOperator:C,replaceCompoundAssign:E,replaceLogicOperator:G,replaceSynthDefinition:I,replaceTaskFunction:K,replaceGlobalVariables:L,replaceCCVariables:M,finalize:N,prettyPrint:P,use:R},d.exports.use()}),e("cc/common/timevalue",function(a,b,c){var d=a("../cc"),e=function(a){var b,c=null;"~"===a.charAt(0)&&(b=!0,a=a.substr(1));do{if(c=f(a),null!==c)break;if(c=g(a),null!==c)break;if(c=h(a),null!==c)break;if(c=i(a),null!==c)break;if(c=k(a),null!==c)break;if(c=m(a),null!==c)break;c=o(a)}while(!1);if(null!==c){if(!b)return c;if(0!==c)return 1/c}return a},f=function(a){var b=/^(\d+(?:\.\d+)?)hz$/i.exec(a);return b?0===+b[1]?0:1/+b[1]:null},g=function(a){var b=/^(\d+(?:\.\d+)?)(min|sec|m)s?$/i.exec(a);if(b)switch(b[2]){case"min":return 60*+(b[1]||0);case"sec":return+(b[1]||0);case"m":return+(b[1]||0)/1e3}return null},h=function(a){var b=/^(?:([1-9][0-9]*):)?([0-5]?[0-9]):([0-5][0-9])(?:\.(\d{1,3}))?$/.exec(a);if(b){var c=0;return c+=3600*(0|b[1]),c+=60*(0|b[2]),c+=0|b[3],c+=(0|((b[4]||"")+"00").substr(0,3))/1e3}return null},i=function(a){var b=/^(\d+)samples(?:\/(\d+)hz)?$/i.exec(a);return b?b[1]/(0|b[2]||d.sampleRate):null},j=function(a,b,c){var d=60/a*(4/b);return d*=[1,1.5,1.75,1.875][c]||1},k=function(a){var b=/^bpm([1-9]\d+(?:\.\d+)?)\s*l([1-9]\d*)(\.*)$/i.exec(a);return b?j(+b[1],+b[2],b[3].length):null},l=function(a,b,c,d){var e=480*(4*b+c)+d;return 60/a*(e/480)},m=function(a){var b=/^bpm([1-9]\d+(?:\.\d+)?)\s*(\d+)\.(\d+).(\d{1,3})$/i.exec(a);return b?l(+b[1],+b[2],+b[3],+b[4]):null},n=function(a,b){return 60/a*b/480},o=function(a){var b=/^bpm([1-9]\d+(?:\.\d+)?)\s*(\d+)ticks$/i.exec(a);return b?n(+b[1],+b[2]):null};c.exports={hz:f,time:g,hhmmss:h,samples:i,note:k,beat:m,ticks:o,calcNote:j,calcBeat:l,calcTicks:n,calc:e}}),e("cc/server/server",function(b,c,d){var e=b("./cc"),f=b("../common/pack").pack,g={},h=function(){function a(){this.sampleRate=0,this.channels=0,this.strmLength=0,this.bufLength=0,this.instanceManager=e.createInstanceManager(),this.strm=null,this.timer=e.createTimer(),this.initialized=!1,this.syncCount=new Uint32Array(1),this.sysSyncCount=0}return a.prototype.sendToLang=function(){throw"SynthServer#sendToLang: should be overridden"},a.prototype.recvFromLang=function(a,b){if(b=0|b,a instanceof Uint8Array)this.instanceManager.doBinayCommand(b,a);else{var c=g[a[0]];if(!c)throw new Error("Unknown command: "+a[0]);c.call(this,a,b)}},a.prototype.connect=function(){throw"SynthServer#connect: should be overridden"},a.prototype.init=function(a){this.initialized||(this.initialized=!0,a&&(this.sampleRate=0|a[1],this.channels=0|a[2]),this.strm=new Int16Array(this.strmLength*this.channels),this.instanceManager.init(this),this.instanceManager.append(0))},a.prototype.play=function(a,b){b=0|b,this.instanceManager.play(b),this.timer.isRunning()||this.timer.start(this.process.bind(this),10),this.sendToLang(["/played",this.syncCount[0]])},a.prototype.pause=function(a,b){b=0|b,this.instanceManager.pause(b),this.timer.isRunning()&&(this.instanceManager.isRunning()||this.timer.stop()),this.sendToLang(["/paused",this.syncCount[0]])},a.prototype.reset=function(a,b){b=0|b,this.instanceManager.reset(b)},a.prototype.pushToTimeline=function(a,b){b=0|b;var c=a[1];this.instanceManager.pushToTimeline(b,c)},a.prototype.process=function(){throw"SynthServer#process: should be overridden"},a}();g["/init"]=function(a,b){this.init(a,b)},g["/play"]=function(a,b){this.play(a,b)},g["/pause"]=function(a,b){this.pause(a,b)},g["/reset"]=function(a,b){this.reset(a,b)},g["/processed"]=function(a,b){this.pushToTimeline(a,b)},g["/socket/sendToServer"]=function(a,b){this.exports&&(a=a[1],a.userId=b,this.exports.emit("message",a))},e.SynthServer=h,d.exports={use:function(){b("../common/timer"),b("../common/console"),b("./instance"),b("./rate"),b("./unit/unit"),b("./server-worker"),b("./server-iframe"),b("./server-nodejs"),b("./server-socket"),e.createSynthServer=function(){switch(e.opmode){case"worker":return e.createWorkerSynthServer();case"iframe":return e.createIFrameSynthServer();case"nodejs":return e.createNodeJSSynthServer();case"socket":return e.createSocketSynthServer()}throw new Error("A SynthServer is not defined for: "+e.opmode)},"undefined"==typeof a.console&&(a.console=function(){var a={};return["log","debug","info","warn","error"].forEach(function(b){a[b]=function(){if(e.server){var a=Array.prototype.slice.call(arguments).map(function(a){return f(a)});e.server.sendToLang(["/console/"+b,a])}}}),a}())}},d.exports.use()}),e("cc/server/cc",function(a,b,c){var d=a("../cc");d.UGen||(d.UGen=Object),c.exports=d}),e("cc/server/instance",function(a,b,c){var d=a("./cc"),e=a("./node"),f=a("./commands"),g=function(){function a(){this.map={},this.list=[],this.server=null,this.process=b}a.prototype.init=function(a){if(!this.server){var b=16*a.bufLength+128,c=a.bufLength,d=a.bufLength<<2;this.server=a,this.busClear=new Float32Array(b),this.map={},this.list=[],this.busOut=new Float32Array(b),this.busOutLen=a.bufLength<<1,this.busOutL=new Float32Array(this.busOut.buffer,0,c),this.busOutR=new Float32Array(this.busOut.buffer,d,c)}},a.prototype.append=function(a){if(!this.map[a]){var b=new h(this,a);this.map[a]=b,this.list.push(b),this.process=1===this.list.length?c:d}return this.map[a]},a.prototype.remove=function(a){var d=this.map[a];d&&(this.list.splice(this.list.indexOf(d),1),delete this.map[a],1===this.list.length?this.process=c:0===this.list.length&&(this.process=b))},a.prototype.play=function(a){var b=this.map[a];b&&b.play()},a.prototype.pause=function(a){var b=this.map[a];b&&b.pause()},a.prototype.reset=function(a){var b=this.map[a];b&&b.reset()},a.prototype.isRunning=function(){return this.list.some(function(a){return a.rootNode.running})},a.prototype.pushToTimeline=function(a,b){var c=this.map[a];c&&(c.timeline=c.timeline.concat(b))},a.prototype.doBinayCommand=function(a,b){var c=this.map[a];c&&c.doBinayCommand(b)};var b=function(){this.busOut.set(this.busClear)},c=function(a,b){this.list[0].process(a,b),this.busOut.set(this.list[0].bus)},d=function(a,b){var c,d=this.list,e=this.busOut,f=this.busOutLen;e.set(this.busClear);for(var g=0,h=d.length;h>g;++g){c=d[g],c.process(a,b);for(var i=c.bus,j=c.busAmp,k=f;k--;)e[k]+=i[k]*j}};return a}(),h=function(){function a(a,b){var c=16*a.server.bufLength+128;this.manager=a,this.userId=0|b,this.bus=new Float32Array(c),this.busClear=a.busClear,this.busIndex=0,this.busAmp=.8,this.timeline=[],this.timelineIndex=0,this.rootNode=new e.Group(0,0,0,this),this.nodes={0:this.rootNode},this.fixNums={},this.defs={},this.buffers={},this.bufSrc={},this.syncItems=new Uint8Array(20),this.i16_syncItems=new Int16Array(this.syncItems.buffer),this.f32_syncItems=new Float32Array(this.syncItems.buffer)}return a.prototype.play=function(){this.rootNode.running=!0,this.bus.set(this.busClear)},a.prototype.pause=function(){this.rootNode.running=!1,this.bus.set(this.busClear),this.timeline=[]},a.prototype.reset=function(){this.manager.busClear&&this.bus.set(this.manager.busClear),this.timeline=[],this.rootNode=new e.Group(0,0,0,this),this.nodes={0:this.rootNode},this.fixNums={},this.defs={},this.buffers={},this.bufSrc={}},a.prototype.doBinayCommand=function(a){var b=f[(a[1]<<8)+a[0]];b&&b.call(this,a)},a.prototype.getFixNum=function(a){var b=this.fixNums;return b[a]||(b[a]={outputs:[new Float32Array([a])]})},a.prototype.process=function(a){for(var b,c=this.timeline;b=c.shift();){var d=f[b[0]];d&&d.call(this,b)}this.bus.set(this.busClear),this.rootNode.process(a,this)},a}();c.exports={InstanceManager:g,use:function(){d.createInstanceManager=function(){return new g}}},c.exports.use()}),e("cc/server/node",function(a,b,c){var d=a("./cc"),e=a("../common/extend"),f=a("./unit/unit").Unit,g={},h={};g[0]=function(a){var b;this instanceof m&&(null===this.head?this.head=this.tail=a:(b=this.head.prev,b&&(b.next=a),a.next=this.head,this.head.prev=a,this.head=a),a.parent=this)},g[1]=function(a){var b;this instanceof m&&(null===this.tail?this.head=this.tail=a:(b=this.tail.next,b&&(b.prev=a),a.prev=this.tail,this.tail.next=a,this.tail=a),a.parent=this)},g[2]=function(a){var b=this.prev;this.prev=a,a.prev=b,b&&(b.next=a),a.next=this,this.parent&&this.parent.head===this&&(this.parent.head=a),a.parent=this.parent},g[3]=function(a){var b=this.next;this.next=a,a.next=b,b&&(b.prev=a),a.prev=this,this.parent&&this.parent.tail===this&&(this.parent.tail=a),a.parent=this.parent},g[4]=function(a){a.next=this.next,a.prev=this.prev,a.head=this.head,a.tail=this.tail,a.parent=this.parent,this.prev&&(this.prev.next=a),this.next&&(this.next.prev=a),this.parent&&this.parent.head===this&&(this.parent.head=a),this.parent&&this.parent.tail===this&&(this.parent.tail=a)},h[0]=function(){},h[1]=function(){this.running=!1},h[2]=function(){i.call(this)},h[3]=function(){var a=this.prev;a&&i.call(a),i.call(this)},h[4]=function(){var a=this.next;i.call(this),a&&i.call(a)},h[5]=function(){var a=this.prev;a instanceof m?j(a):i.call(a),i.call(this)},h[6]=function(){var a=this.next;i.call(this),a?j(a):i.call(a)},h[7]=function(){var a=this.parent.head;if(a)for(var b=a;b&&b!==this;)a=b.next,i.call(b),b=a;i.call(this)},h[8]=function(){var a=this.next;if(i.call(this),a)for(var b=a;b;)a=b.next,i.call(b),b=a},h[9]=function(){var a=this.prev;i.call(this),a&&(a.running=!1)},h[10]=function(){var a=this.next;i.call(this),a&&(a.running=!1)},h[11]=function(){var a=this.prev;a instanceof m?k(a):i.call(a),i.call(this)},h[12]=function(){var a=this.next;i.call(this),a?k(a):i.call(a)},h[13]=function(){var a=this.parent.head;if(a)for(var b=a;b;)a=b.next,i.call(b),b=a},h[14]=function(){k(this)};var i=function(){if(this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.parent){this.parent.head===this&&(this.parent.head=this.next),this.parent.tail===this&&(this.parent.tail=this.prev);var a;this.instance&&(a=this.instance.userId),d.server.sendToLang(["/emit/n_end",this.nodeId],a)}this.prev=null,this.next=null,this.parent=null,this.blocking=!1,this.instance&&delete this.instance.nodes[this.nodeId]},j=function(a){var b=a.head;for(i.call(a),a=b;a;)b=a.next,i.call(a),a=b},k=function(a){var b=a.head;for(i.call(a),a=b;a;)b=a.next,i.call(a),a instanceof m&&k(a),a=b},l=function(){function a(a,b){this.nodeId=0|a,this.next=null,this.prev=null,this.parent=null,this.running=!0,this.instance=b}return a.prototype.play=function(){this.running=!0},a.prototype.pause=function(){this.running=!1},a.prototype.stop=function(){i.call(this)},a.prototype.doneAction=function(a,b){var c=h[a];if(c){c.call(this);var e;this.instance&&(e=this.instance.userId),d.server.sendToLang(["/emit/n_done",this.nodeId,b],e)}},a}(),m=function(){function a(a,b,c,d){l.call(this,a,d),this.head=null,this.tail=null,b&&g[c].call(b,this)}return e(a,l),a.prototype.process=function(a,b){this.head&&this.running&&this.head.process(a,b),this.next&&this.next.process(a,b)},a}(),n=function(){function a(a,b,c,d,e,f){if(l.call(this,a,f),f){var h=f.defs[d];h&&this.build(h,e,f)}b&&g[c].call(b,this)}return e(a,l),a.prototype.build=function(a,b,c){this.specs=a;var d=a.consts.map(function(a){return c.getFixNum(a)}),e=a.defList.map(function(a){return new f(this,a)},this);return this.params=a.params,this.controls=new Float32Array(this.params.values),this.set(b),this.unitList=e.filter(function(a){for(var b=a.inputs,c=a.inRates,f=a.specs[3],g=a.specs[5],h=0,i=b.length;i>h;++h){var j=h<<1;-1===f[j]?(b[h]=d[f[j+1]].outputs[0],c[h]=0):(b[h]=e[f[j]].outputs[f[j+1]],c[h]=e[f[j]].outRates[f[j+1]])}return a.init(g),!!a.process}),this},a.prototype.set=function(a){for(var b=0,c=a.length;c>b;b+=2){var d=a[b],e=a[b+1];this.controls[d]=e}},a.prototype.process=function(a,b){if(this.running&&this.unitList)for(var c=this.unitList,d=0,e=c.length;e>d;++d){var f=c[d];f.process(f.rate.bufLength,b)}this.next&&this.next.process(a,b)},a}();c.exports={Node:l,Group:m,Synth:n}}),e("cc/server/unit/unit",function(a,b,c){var d=a("../cc"),e={};d.unit={specs:e};var f=function(){function a(a,b){this.parent=a,this.specs=b,this.name=b[0],this.calcRate=b[1],this.specialIndex=b[2],this.numOfInputs=b[3].length>>1,this.numOfOutputs=b[4].length,this.inputs=new Array(this.numOfInputs),this.inRates=new Array(this.numOfInputs),this.outRates=b[4],this.rate=d.getRateInstance(this.calcRate||1);for(var c=this.rate.bufLength,e=new Float32Array(c*this.numOfOutputs),f=new Array(this.numOfOutputs),g=0,h=f.length;h>g;++g)f[g]=new Float32Array(e.buffer,c*g*e.BYTES_PER_ELEMENT,c);this.outputs=f,this.allOutputs=e,this.bufLength=c,this.done=!1}return a.prototype.init=function(a){var b=e[this.name];return"function"==typeof b?b.call(this):d.console.warn(this.name+"'s ctor is not found."),this.tag=a||"",this},a.prototype.doneAction=function(a){this.done||(this.done=!0,this.parent.doneAction(a,this.tag)),a=0},a}();c.exports={Unit:f,use:function(){d.createUnit=function(a,b){return new f(a,b)}}},a("./bop"),a("./bufio"),a("./delay"),a("./filter"),a("./inout"),a("./line"),a("./madd"),a("./osc"),a("./pan"),a("./ui"),a("./uop"),c.exports.use()}),e("cc/server/unit/bop",function(a,b,c){var d=a("../cc"),e=a("../../common/ops"),f={};d.unit.specs.BinaryOpUGen=function(){var a=function(){var a,b=f[e.BINARY_OP_UGEN_MAP[this.specialIndex]];if(b){switch(this.inRates[0]){case 2:switch(this.inRates[1]){case 2:a=b.aa;break;case 1:a=b.ak;break;case 0:a=b.ai}break;case 1:switch(this.inRates[1]){case 2:a=b.ka;break;case 1:a=b.kk;break;case 0:a=b.kk}break;case 0:switch(this.inRates[1]){case 2:a=b.ia;break;case 1:a=b.kk;break;case 0:a=null}}this.process=a,this._a=this.inputs[0][0],this._b=this.inputs[1][0],this.process?this.process(1):this.outputs[0][0]=b(this.inputs[0][0],this.inputs[1][0])}else d.console.warn("BinaryOpUGen["+e.BINARY_OP_UGEN_MAP[this.specialIndex]+"] is not defined.")};return a}();var g=function(a){return function(b){for(var c=this.outputs[0],d=this.inputs[0],e=this.inputs[1],f=0;b>f;f+=8)c[f]=a(d[f],e[f]),c[f+1]=a(d[f+1],e[f+1]),c[f+2]=a(d[f+2],e[f+2]),c[f+3]=a(d[f+3],e[f+3]),c[f+4]=a(d[f+4],e[f+4]),c[f+5]=a(d[f+5],e[f+5]),c[f+6]=a(d[f+6],e[f+6]),c[f+7]=a(d[f+7],e[f+7])}},h=function(a){return function(b){for(var c=this.outputs[0],d=this.inputs[0],e=this._b,f=this.inputs[1][0],g=(f-this._b)*this.rate.slopeFactor,h=0;b>h;h+=8)c[h]=a(d[h],e),e+=g,c[h+1]=a(d[h+1],e),e+=g,c[h+2]=a(d[h+2],e),e+=g,c[h+3]=a(d[h+3],e),e+=g,c[h+4]=a(d[h+4],e),e+=g,c[h+5]=a(d[h+5],e),e+=g,c[h+6]=a(d[h+6],e),e+=g,c[h+7]=a(d[h+7],e),e+=g;this._b=f}},i=function(a){return function(b){for(var c=this.outputs[0],d=this.inputs[0],e=this._b,f=0;b>f;f+=8)c[f]=a(d[f],e),c[f+1]=a(d[f+1],e),c[f+2]=a(d[f+2],e),c[f+3]=a(d[f+3],e),c[f+4]=a(d[f+4],e),c[f+5]=a(d[f+5],e),c[f+6]=a(d[f+6],e),c[f+7]=a(d[f+7],e)}},j=function(a){return function(b){for(var c=this.outputs[0],d=this._a,e=this.inputs[1],f=this.inputs[0][0],g=(f-this._a)*this.rate.slopeFactor,h=0;b>h;h+=8)c[h]=a(d,e[h]),d+=g,c[h+1]=a(d,e[h+1]),d+=g,c[h+2]=a(d,e[h+2]),d+=g,c[h+3]=a(d,e[h+3]),d+=g,c[h+4]=a(d,e[h+4]),d+=g,c[h+5]=a(d,e[h+5]),d+=g,c[h+6]=a(d,e[h+6]),d+=g,c[h+7]=a(d,e[h+7]),d+=g;this._a=f}},k=function(a){return function(){this.outputs[0][0]=a(this.inputs[0][0],this.inputs[1][0])}},l=function(a){return function(b){for(var c=this.outputs[0],d=this._a,e=this.inputs[1],f=0;b>f;f+=8)c[f]=a(d,e[f]),c[f+1]=a(d,e[f+1]),c[f+2]=a(d,e[f+2]),c[f+3]=a(d,e[f+3]),c[f+4]=a(d,e[f+4]),c[f+5]=a(d,e[f+5]),c[f+6]=a(d,e[f+6]),c[f+7]=a(d,e[f+7])}};f["+"]=function(a,b){return a+b},f["+"].aa=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=0;a>e;e+=8)b[e]=c[e]+d[e],b[e+1]=c[e+1]+d[e+1],b[e+2]=c[e+2]+d[e+2],b[e+3]=c[e+3]+d[e+3],b[e+4]=c[e+4]+d[e+4],b[e+5]=c[e+5]+d[e+5],b[e+6]=c[e+6]+d[e+6],b[e+7]=c[e+7]+d[e+7]},f["+"].ak=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._b,e=this.inputs[1][0],f=(e-this._b)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c[g]+d,d+=f,b[g+1]=c[g+1]+d,d+=f,b[g+2]=c[g+2]+d,d+=f,b[g+3]=c[g+3]+d,d+=f,b[g+4]=c[g+4]+d,d+=f,b[g+5]=c[g+5]+d,d+=f,b[g+6]=c[g+6]+d,d+=f,b[g+7]=c[g+7]+d,d+=f;this._b=e},f["+"].ai=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._b,e=0;a>e;e+=8)b[e]=c[e]+d,b[e+1]=c[e+1]+d,b[e+2]=c[e+2]+d,b[e+3]=c[e+3]+d,b[e+4]=c[e+4]+d,b[e+5]=c[e+5]+d,b[e+6]=c[e+6]+d,b[e+7]=c[e+7]+d},f["+"].ka=function(a){for(var b=this.outputs[0],c=this._a,d=this.inputs[1],e=this.inputs[0][0],f=(e-this._a)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c+d[g],c+=f,b[g+1]=c+d[g+1],c+=f,b[g+2]=c+d[g+2],c+=f,b[g+3]=c+d[g+3],c+=f,b[g+4]=c+d[g+4],c+=f,b[g+5]=c+d[g+5],c+=f,b[g+6]=c+d[g+6],c+=f,b[g+7]=c+d[g+7],c+=f;this._a=e},f["+"].kk=function(){this.outputs[0][0]=this.inputs[0][0]+this.inputs[1][0]},f["+"].ia=function(a){for(var b=this.outputs[0],c=this._a,d=this.inputs[1],e=0;a>e;e+=8)b[e]=c+d[e],b[e+1]=c+d[e+1],b[e+2]=c+d[e+2],b[e+3]=c+d[e+3],b[e+4]=c+d[e+4],b[e+5]=c+d[e+5],b[e+6]=c+d[e+6],b[e+7]=c+d[e+7]},f["-"]=function(a,b){return a-b},f["-"].aa=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=0;a>e;e+=8)b[e]=c[e]-d[e],b[e+1]=c[e+1]-d[e+1],b[e+2]=c[e+2]-d[e+2],b[e+3]=c[e+3]-d[e+3],b[e+4]=c[e+4]-d[e+4],b[e+5]=c[e+5]-d[e+5],b[e+6]=c[e+6]-d[e+6],b[e+7]=c[e+7]-d[e+7]},f["-"].ak=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._b,e=this.inputs[1][0],f=(e-this._b)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c[g]-d,d+=f,b[g+1]=c[g+1]-d,d+=f,b[g+2]=c[g+2]-d,d+=f,b[g+3]=c[g+3]-d,d+=f,b[g+4]=c[g+4]-d,d+=f,b[g+5]=c[g+5]-d,d+=f,b[g+6]=c[g+6]-d,d+=f,b[g+7]=c[g+7]-d,d+=f;this._b=e},f["-"].ai=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._b,e=0;a>e;e+=8)b[e]=c[e]-d,b[e+1]=c[e+1]-d,b[e+2]=c[e+2]-d,b[e+3]=c[e+3]-d,b[e+4]=c[e+4]-d,b[e+5]=c[e+5]-d,b[e+6]=c[e+6]-d,b[e+7]=c[e+7]-d},f["-"].ka=function(a){for(var b=this.outputs[0],c=this._a,d=this.inputs[1],e=this.inputs[0][0],f=(e-this._a)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c-d[g],c+=f,b[g+1]=c-d[g+1],c+=f,b[g+2]=c-d[g+2],c+=f,b[g+3]=c-d[g+3],c+=f,b[g+4]=c-d[g+4],c+=f,b[g+5]=c-d[g+5],c+=f,b[g+6]=c-d[g+6],c+=f,b[g+7]=c-d[g+7],c+=f;this._a=e},f["-"].kk=function(){this.outputs[0][0]=this.inputs[0][0]-this.inputs[1][0]},f["-"].ia=function(a){for(var b=this.outputs[0],c=this._a,d=this.inputs[1],e=0;a>e;e+=8)b[e]=c-d[e],b[e+1]=c-d[e+1],b[e+2]=c-d[e+2],b[e+3]=c-d[e+3],b[e+4]=c-d[e+4],b[e+5]=c-d[e+5],b[e+6]=c-d[e+6],b[e+7]=c-d[e+7]},f["*"]=function(a,b){return a*b},f["*"].aa=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=0;a>e;e+=8)b[e]=c[e]*d[e],b[e+1]=c[e+1]*d[e+1],b[e+2]=c[e+2]*d[e+2],b[e+3]=c[e+3]*d[e+3],b[e+4]=c[e+4]*d[e+4],b[e+5]=c[e+5]*d[e+5],b[e+6]=c[e+6]*d[e+6],b[e+7]=c[e+7]*d[e+7]},f["*"].ak=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._b,e=this.inputs[1][0],f=(e-this._b)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c[g]*d,d+=f,b[g+1]=c[g+1]*d,d+=f,b[g+2]=c[g+2]*d,d+=f,b[g+3]=c[g+3]*d,d+=f,b[g+4]=c[g+4]*d,d+=f,b[g+5]=c[g+5]*d,d+=f,b[g+6]=c[g+6]*d,d+=f,b[g+7]=c[g+7]*d,d+=f;this._b=e},f["*"].ai=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._b,e=0;a>e;e+=8)b[e]=c[e]*d,b[e+1]=c[e+1]*d,b[e+2]=c[e+2]*d,b[e+3]=c[e+3]*d,b[e+4]=c[e+4]*d,b[e+5]=c[e+5]*d,b[e+6]=c[e+6]*d,b[e+7]=c[e+7]*d},f["*"].ka=function(a){for(var b=this.outputs[0],c=this._a,d=this.inputs[1],e=this.inputs[0][0],f=(e-this._a)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c*d[g],c+=f,b[g+1]=c*d[g+1],c+=f,b[g+2]=c*d[g+2],c+=f,b[g+3]=c*d[g+3],c+=f,b[g+4]=c*d[g+4],c+=f,b[g+5]=c*d[g+5],c+=f,b[g+6]=c*d[g+6],c+=f,b[g+7]=c*d[g+7],c+=f;this._a=e},f["*"].kk=function(){this.outputs[0][0]=this.inputs[0][0]*this.inputs[1][0]},f["*"].ia=function(a){for(var b=this.outputs[0],c=this._a,d=this.inputs[1],e=0;a>e;e+=8)b[e]=c*d[e],b[e+1]=c*d[e+1],b[e+2]=c*d[e+2],b[e+3]=c*d[e+3],b[e+4]=c*d[e+4],b[e+5]=c*d[e+5],b[e+6]=c*d[e+6],b[e+7]=c*d[e+7]},f["/"]=function(a,b){return 0===b?0:a/b},f["%"]=function(a,b){return 0===b?0:a%b},f.eq=function(a,b){return a===b?1:0},f.ne=function(a,b){return a!==b?1:0},f.lt=function(a,b){return b>a?1:0},f.gt=function(a,b){return a>b?1:0},f.le=function(a,b){return b>=a?1:0},f.ge=function(a,b){return a>=b?1:0},f.bitAnd=function(a,b){return a&b},f.bitOr=function(a,b){return a|b},f.bitXor=function(a,b){return a^b},f.min=function(a,b){return Math.min(a,b)},f.max=function(a,b){return Math.max(a,b)};var m=function(a,b,c){for(a=0|a,b=0|b;0!==b;)c=a%b,a=b,b=c;return Math.abs(a)};f.lcm=function(a,b){return 0===a&&0===b?0:Math.abs(a*b)/m(a,b)},f.gcd=function(a,b){return m(a,b)},f.round=function(a,b){return 0===b?a:Math.round(a/b)*b},f.roundUp=function(a,b){return 0===b?a:Math.ceil(a/b)*b},f.roundDown=function(a,b){return 0===b?a:Math.floor(a/b)*b},f.trunc=function(a,b){return 0===b?a:Math.floor(a/b)*b},f.atan2=function(a,b){return Math.atan2(a,b)},f.hypot=function(a,b){return Math.sqrt(a*a+b*b)},f.hypotApx=function(a,b){var c=Math.abs(a),d=Math.abs(b),e=Math.min(c,d);return c+d-(Math.sqrt(2)-1)*e},f.pow=function(a,b){return Math.pow(Math.abs(a),b)},f.leftShift=function(a,b){return 0>b?(0|a)>>(0|-b):(0|a)<<(0|b)},f.rightShift=function(a,b){return 0>b?(0|a)<<(0|-b):(0|a)>>(0|b)},f.unsignedRightShift=function(a,b){return 0>b?(0|a)<<(0|-b):(0|a)>>(0|b)},f.ring1=function(a,b){return a*b+a},f.ring2=function(a,b){return a*b+a+b},f.ring3=function(a,b){return a*a*b},f.ring4=function(a,b){return a*a*b-a*b*b},f.difsqr=function(a,b){return a*a-b*b},f.sumsqr=function(a,b){return a*a+b*b},f.sqrsum=function(a,b){return(a+b)*(a+b)},f.sqrdif=function(a,b){return(a-b)*(a-b)},f.absdif=function(a,b){return Math.abs(a-b)},f.thresh=function(a,b){return b>a?0:a},f.amclip=function(a,b){return.5*a*(b+Math.abs(b))},f.scaleneg=function(a,b){return b=.5*b+.5,(Math.abs(a)-a)*b+a},f.clip2=function(a,b){return Math.max(-b,Math.min(a,b))},f.excess=function(a,b){return a-Math.max(-b,Math.min(a,b))},f.fold2=function(a,b){var c,d,e,f,g=a;if(c=g+b,g>=b){if(g=b+b-g,g>=-b)return g}else{if(!(-b>g))return g;if(g=-b-b-g,b>g)return g}return b===-b?-b:(e=b+b,f=e+e,d=c-f*Math.floor(c/f),d>=e&&(d=f-d),d-b)},f.wrap2=function(a,b){var c,d=a;if(d>=b){if(c=b+b,d-=c,b>d)return d}else{if(!(-b>d))return d;if(c=b+b,d+=c,d>=-b)return d}return b===-b?-b:d-c*Math.floor((d+b)/c)},Object.keys(f).forEach(function(a){var b=f[a];b.aa||(b.aa=g(b)),b.ak||(b.ak=h(b)),b.ai||(b.ai=i(b)),b.ka||(b.ka=j(b)),b.kk||(b.kk=k(b)),b.ia||(b.ia=l(b)),b.ki=b.kk,b.ik=b.kk}),c.exports={calcFunc:f,binary_aa:g,binary_ak:h,binary_ai:i,binary_ka:j,binary_kk:k,binary_ia:l}}),e("cc/server/unit/bufio",function(a,b,c){var d=a("../cc"),e=function(a,b,c,d){if(b>=c){if(!d)return a.done=!0,c;if(b-=c,c>b)return b}else{if(!(0>b))return b;if(!d)return a.done=!0,0;if(b+=c,b>=0)return b}return b-c*Math.floor(b/c)},f=function(a,b,c,d,e){var f=c,g=.5*(d-b),h=b-2.5*c+2*d-.5*e,i=.5*(e-b)+1.5*(c-d);return((i*a+h)*a+g)*a+f};d.unit.specs.PlayBuf=function(){var a=function(){this._buffer=null,this._phase=this.inputs[3][0],this._trig=0,this.process=b},b=function(a,b){this._buffer=b.buffers[this.specialIndex],this._buffer&&null!==this._buffer.samples&&(this.process=2===this.inRates[1]?2===this.inRates[2]?c:c:2===this.inRates[2]?c:c,this.process.call(this,a),delete this.spec)
},c=function(a){var b,c,d,g,h,i,j,k,l,m=this._buffer,n=this.outputs,o=this._phase,p=this.inputs[1][0],q=this.inputs[2][0],r=this.inputs[4][0],s=m.samples,t=m.channels,u=m.frames,v=u-1;q>0&&this._trig<=0&&(this.done=!1,o=this.inputs[3][0]),this._trig=q;for(var w=0;a>w;++w){o=e(this,o,v,r),c=0|o,b=c-1,d=c+1,g=d+1,0===c?b=r?v:c:g>v&&(d>v?r?(d=0,g=1):d=g=v:g=r?0:v),h=o-(0|o);for(var x=0,y=n.length;y>x;++x)i=s[b*t+x],j=s[c*t+x],k=s[d*t+x],l=s[g*t+x],n[x][w]=f(h,i,j,k,l);o+=p}this.done&&this.doneAction(0|this.inputs[5][0],this.tag),this._phase=o};return a}(),c.exports={}}),e("cc/server/unit/delay",function(a,b,c){var d=a("../cc"),e=Math.log(.001),f=function(a,b,c){return Math.max(c,Math.min(b*a.rate.sampleRate,a._fdelaylen))},g=function(a,b){return 0===a||0===b?0:b>0?+Math.exp(e*a/+b):-Math.exp(e*a/-b)},h=function(a,b,c,d,e){var f=c,g=.5*(d-b),h=b-2.5*c+2*d-.5*e,i=.5*(e-b)+1.5*(c-d);return((i*a+h)*a+g)*a+f},i=function(){var a;this._maxdelaytime=this.inputs[1][0],this._delaytime=this.inputs[2][0],this._decaytime=this.inputs[3][0],a=Math.ceil(this._maxdelaytime*this.rate.sampleRate+1),a+=this.rate.bufLength,a=1<<Math.ceil(Math.log(a)*Math.LOG2E),this._fdelaylen=this._idelaylen=a,this._dlybuf=new Float32Array(a),this._mask=a-1,this._dsamp=f(this,this._delaytime,1),this._iwrphase=0,this._feedbk=g(this._delaytime,this._decaytime)};d.unit.specs.CombN=function(){var a=function(){this.process=b,i.call(this)},b=function(a){var b,c,d,e,h,i,j,k=this.outputs[0],l=this.inputs[0],m=this.inputs[2][0],n=this.inputs[3][0],o=this._dlybuf,p=this._iwrphase,q=this._dsamp,r=this._feedbk,s=this._mask;if(m===this._delaytime)if(b=p-(0|q),n===this._decaytime)for(j=0;a>j;++j)c=o[b&s],o[p&s]=l[j]+r*c,1/0===Math.abs(o[p&s])&&(o[p&s]=0),k[j]=c,b++,p++;else{for(d=g(m,n),e=(d-r)*this.rate.slopeFactor,j=0;a>j;++j)c=o[b&s],o[p&s]=l[j]+r*c,1/0===Math.abs(o[p&s])&&(o[p&s]=0),k[j]=c,r+=e,b++,p++;this._feedbk=d,this._decaytime=n}else{for(h=f(this,m,1),i=(h-q)*this.rate.slopeFactor,d=g(m,n),e=(d-r)*this.rate.slopeFactor,j=0;a>j;++j)b=p-(0|q),c=o[b&s],o[p&s]=l[j]+r*c,1/0===Math.abs(o[p&s])&&(o[p&s]=0),k[j]=c,q+=i,r+=e,b++,p++;this._feedbk=r,this._dsamp=q,this._delaytime=m,this._decaytime=n}this._iwrphase=p};return a}(),d.unit.specs.CombL=function(){var a=function(){this.process=b,i.call(this)},b=function(a){var b,c,d,e,h,i,j,k,l,m=this.outputs[0],n=this.inputs[0],o=this.inputs[2][0],p=this.inputs[3][0],q=this._dlybuf,r=this._iwrphase,s=this._dsamp,t=this._feedbk,u=this._mask,v=s-(0|s);if(o===this._delaytime)if(b=r-(0|s),p===this._decaytime)for(l=0;a>l;++l)d=q[b&u],e=q[b-1&u],c=d+v*(e-d),q[r&u]=n[l]+t*c,1/0===Math.abs(q[r&u])&&(q[r&u]=0),m[l]=c,b++,r++;else{for(h=g(o,p),i=(h-t)*this.rate.slopeFactor,l=0;a>l;++l)d=q[b&u],e=q[b-1&u],c=d+v*(e-d),q[r&u]=n[l]+t*c,1/0===Math.abs(q[r&u])&&(q[r&u]=0),m[l]=c,t+=i,b++,r++;this._feedbk=h,this._decaytime=p}else{for(j=f(this,o,1),k=(j-s)*this.rate.slopeFactor,h=g(o,p),i=(h-t)*this.rate.slopeFactor,l=0;a>l;++l)b=r-(0|s),d=q[b&u],e=q[b-1&u],c=d+v*(e-d),q[r&u]=n[l]+t*c,1/0===Math.abs(q[r&u])&&(q[r&u]=0),m[l]=c,s+=k,t+=i,b++,r++;this._feedbk=t,this._dsamp=s,this._delaytime=o,this._decaytime=p}this._iwrphase=r};return a}(),d.unit.specs.CombC=function(){var a=function(){this.process=b,i.call(this)},b=function(a){var b,c,d,e,i,j,k,l,m,n,o,p=this.outputs[0],q=this.inputs[0],r=this.inputs[2][0],s=this.inputs[3][0],t=this._dlybuf,u=this._iwrphase,v=this._dsamp,w=this._feedbk,x=this._mask,y=v-(0|v);if(r===this._delaytime)if(b=u-(0|v),s===this._decaytime)for(o=0;a>o;++o)d=t[b+1&x],e=t[b&x],i=t[b-1&x],j=t[b-2&x],c=h(y,d,e,i,j),t[u&x]=q[o]+w*c,1/0===Math.abs(t[u&x])&&(t[u&x]=0),p[o]=c,b++,u++;else{for(k=g(r,s),l=(k-w)*this.rate.slopeFactor,o=0;a>o;++o)d=t[b+1&x],e=t[b&x],i=t[b-1&x],j=t[b-2&x],c=h(y,d,e,i,j),t[u&x]=q[o]+w*c,1/0===Math.abs(t[u&x])&&(t[u&x]=0),p[o]=c,w+=l,b++,u++;this._feedbk=k,this._decaytime=s}else{for(m=f(this,r,1),n=(m-v)*this.rate.slopeFactor,k=g(r,s),l=(k-w)*this.rate.slopeFactor,o=0;a>o;++o)b=u-(0|v),d=t[b+1&x],e=t[b&x],i=t[b-1&x],j=t[b-2&x],c=h(y,d,e,i,j),t[u&x]=q[o]+w*c,1/0===Math.abs(t[u&x])&&(t[u&x]=0),p[o]=c,v+=n,w+=l,b++,u++;this._feedbk=w,this._dsamp=v,this._delaytime=r,this._decaytime=s}this._iwrphase=u};return a}(),c.exports={}}),e("cc/server/unit/filter",function(a,b,c){var d=a("../cc"),e=a("./utils"),f=e.nanToZero,g=e.zapgremlins;d.unit.specs.RLPF=function(){var a=function(){this.process=1===this.bufLength?c:b,this._a0=0,this._b1=0,this._b2=0,this._y1=0,this._y2=0,this._freq=void 0,this._reson=void 0,c.call(this,1)},b=function(){var a,b,c,d=this.outputs[0],e=this.inputs[0],h=this.inputs[1][0],i=this.inputs[2][0],j=this._y1,k=this._y2,l=this._a0,m=this._b1,n=this._b2,o=0;if(h!==this._freq||i!==this._reson){var p=Math.max(.001,i),q=h*this.rate.radiansPerSample,r=Math.tan(.5*q*p),s=(1-r)/(1+r),t=Math.cos(q),u=(1+s)*t,v=-s,w=.25*(1+s-u),x=(w-l)*this.rate.filterSlope,y=(u-m)*this.rate.filterSlope,z=(v-n)*this.rate.filterSlope;for(b=0,c=this.rate.filterLoops;c>b;++b)a=l*e[o]+m*j+n*k,d[o++]=a+2*j+k,k=l*e[o]+m*a+n*j,d[o++]=k+2*a+j,j=l*e[o]+m*k+n*a,d[o++]=j+2*k+a,l+=x,m+=y,n+=z;for(b=0,c=this.rate.filterRemain;c>b;++b)a=l*e[o]+m*j+n*k,d[o++]=a+2*j+k,k=j,j=a;this._freq=h,this._reson=i,this._a0=w,this._b1=u,this._b2=v}else{for(b=0,c=this.rate.filterLoops;c>b;++b)a=l*e[o]+m*j+n*k,d[o++]=a+2*j+k,k=l*e[o]+m*a+n*j,d[o++]=k+2*a+j,j=l*e[o]+m*k+n*a,d[o++]=j+2*k+a;for(b=0,c=this.rate.filterRemain;c>b;++b)a=l*e[o]+m*j+n*k,d[o++]=a+2*j+k,k=j,j=a}this._y1=g(j),this._y2=g(k),f(d)},c=function(){var a,b=this.outputs[0],c=this.inputs[0],d=this.inputs[1][0],e=this.inputs[2][0],f=this._y1,h=this._y2,i=this._a0,j=this._b1,k=this._b2;if(d!==this._freq||e!==this._reson){var l=Math.max(.001,e),m=d*this.rate.radiansPerSample,n=Math.tan(.5*m*l),o=(1-n)/(1+n),p=Math.cos(m);j=(1+o)*p,k=-o,i=.25*(1+o-j),a=i*c[0]+j*f+k*h,b[0]=a+2*f+h,h=f,f=a,this._freq=d,this._reson=e,this._a0=i,this._b1=j,this._b2=k}else a=i*c[0]+j*f+k*h,b[0]=a+2*f+h,h=f,f=a;this._y1=g(f),this._y2=g(h),isNaN(b[0])&&(b[0]=0)};return a}(),d.unit.specs.RHPF=function(){var a=function(){this.process=1===this.bufLength?c:b,this._a0=0,this._b1=0,this._b2=0,this._y1=0,this._y2=0,this._freq=void 0,this._reson=void 0,c.call(this,1)},b=function(){var a,b,c,d=this.outputs[0],e=this.inputs[0],h=this.inputs[1][0],i=this.inputs[2][0],j=this._y1,k=this._y2,l=this._a0,m=this._b1,n=this._b2,o=0;if(h!==this._freq||i!==this._reson){var p=Math.max(.001,i),q=h*this.rate.radiansPerSample,r=Math.tan(.5*q*p),s=(1-r)/(1+r),t=Math.cos(q),u=(1+s)*t,v=-s,w=.25*(1+s+u),x=(w-l)*this.rate.filterSlope,y=(u-m)*this.rate.filterSlope,z=(v-n)*this.rate.filterSlope;for(b=0,c=this.rate.filterLoops;c>b;++b)a=l*e[o]+m*j+n*k,d[o++]=a-2*j+k,k=l*e[o]+m*a+n*j,d[o++]=k-2*a+j,j=l*e[o]+m*k+n*a,d[o++]=j-2*k+a,l+=x,m+=y,n+=z;for(b=0,c=this.rate.filterRemain;c>b;++b)a=l*e[o]+m*j+n*k,d[o++]=a-2*j+k,k=j,j=a;this._freq=h,this._reson=i,this._a0=w,this._b1=u,this._b2=v}else{for(b=0,c=this.rate.filterLoops;c>b;++b)a=l*e[o]+m*j+n*k,d[o++]=a-2*j+k,k=l*e[o]+m*a+n*j,d[o++]=k-2*a+j,j=l*e[o]+m*k+n*a,d[o++]=j-2*k+a;for(b=0,c=this.rate.filterRemain;c>b;++b)a=l*e[o]+m*j+n*k,d[o++]=a-2*j+k,k=j,j=a}this._y1=g(j),this._y2=g(k),f(d)},c=function(){var a,b=this.outputs[0],c=this.inputs[0],d=this.inputs[1][0],e=this.inputs[2][0],f=this._y1,h=this._y2,i=this._a0,j=this._b1,k=this._b2;if(d!==this._freq||e!==this._reson){var l=Math.max(.001,e),m=d*this.rate.radiansPerSample,n=Math.tan(.5*m*l),o=(1-n)/(1+n),p=Math.cos(m);j=(1+o)*p,k=-o,i=.25*(1+o+j),a=i*c[0]+j*f+k*h,b[0]=a-2*f+h,h=f,f=a,this._freq=d,this._reson=e,this._a0=i,this._b1=j,this._b2=k}else a=i*c[0]+j*f+k*h,b[0]=a-2*f+h,h=f,f=a;this._y1=g(f),this._y2=g(h),isNaN(b[0])&&(b[0]=0)};return a}(),c.exports={}}),e("cc/server/unit/utils",function(a,b,c){var d=function(a){for(var b=a.length;b--;)isNaN(a[b])&&(a[b]=0);return a},e=function(a){return isNaN(a)||a>-1e-6&&0>a||a>=0&&1e-6>a?0:a},f=function(a){return 0>a?a>-1e-6&&(a=-1e-6):1e-6>a&&(a=1e-6),a};c.exports={nanToZero:d,zapgremlins:e,avoidzero:f}}),e("cc/server/unit/inout",function(a,b,c){var d=a("../cc");d.unit.specs.Control=function(){var a=function(){this.process=1===this.numOfOutputs?b:c,this.process(1)},b=function(){this.outputs[0][0]=this.parent.controls[this.specialIndex]},c=function(){for(var a=this.parent.controls,b=this.outputs,c=this.specialIndex,d=0,e=b.length;e>d;++d)b[d][0]=a[d+c]};return a}(),d.unit.specs.In=function(){var a=function(){this._bufLength=d.server.bufLength,2===this.calcRate?(this.process=b,this._busOffset=0):(this.process=c,this._busOffset=16*this._bufLength)},b=function(a,b){for(var c=this.outputs[0],d=b.bus,e=this._bufLength,f=0|this.inputs[0][0]*e,g=0;a>g;++g)c[g]=d[f+g]},c=function(a,b){for(var c=this.outputs[0],d=b.bus[this._busOffset+(0|this.inputs[0][0])],e=0;a>e;++e)c[e]=d};return a}(),d.unit.specs.Out=function(){var a=function(){this._bufLength=d.server.bufLength,2===this.calcRate?(this.process=b,this._busOffset=0):(this.process=c,this._busOffset=16*this._bufLength)},b=function(a,b){for(var c,d,e=this.inputs,f=b.bus,g=this._bufLength,h=(0|e[0][0])-1,i=1,j=e.length;j>i;++i){c=(h+i)*g,d=e[i];for(var k=0;a>k;k++)f[c+k]+=d[k]}},c=function(a,b){for(var c=this.inputs,d=b.bus,e=this._busOffset+(0|c[0][0])-1,f=1,g=c.length;g>f;++f)d[e+f]+=c[f][0]};return a}(),c.exports={}}),e("cc/server/unit/line",function(a,b,c){var d=a("../cc");d.unit.specs.Line=function(){var a=function(){this.process=b;var a=this.inputs[0][0],c=this.inputs[1][0],d=this.inputs[2][0],e=Math.round(d*this.rate.sampleRate);this._counter=Math.max(1,e),0===e?(this._level=c,this._slope=0):(this._slope=(c-a)/this._counter,this._level=a+this._slope),this._endLevel=c,this._doneAction=this.inputs[3][0],this.outputs[0][0]=this._level},b=function(a){var b,c=this.outputs[0],d=this._level,e=this._counter,f=this._slope,g=a;do{var h;if(0===e){h=g,g=0;var i=this._endLevel;for(b=0;h>b;++b)c[b]=i}else{for(h=Math.min(g,e),e-=h,g-=h,b=0;h>b;++b)c[b]=d,d+=f;0===e&&this.doneAction(this._doneAction)}}while(g);this._counter=e,this._level=d};return a}(),c.exports={}}),e("cc/server/unit/madd",function(a,b,c){var d=a("../cc");d.unit.specs.MulAdd=function(){var a=function(){var a=this.inRates,c=b[a[0]][a[1]][a[2]];this.process=c,this._in=this.inputs[0][0],this._mul=this.inputs[1][0],this._add=this.inputs[2][0],this.process?this.process(1):this.outputs[0][0]=this._in*this._mul+this._add},b={};return b[2]={},b[2][2]={},b[2][1]={},b[2][0]={},b[1]={},b[1][2]={},b[1][1]={},b[1][0]={},b[0]={},b[0][2]={},b[0][1]={},b[0][0]={},b[2][2][2]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this.inputs[2],f=0;a>f;f+=8)b[f]=c[f]*d[f]+e[f],b[f+1]=c[f+1]*d[f+1]+e[f+1],b[f+2]=c[f+2]*d[f+2]+e[f+2],b[f+3]=c[f+3]*d[f+3]+e[f+3],b[f+4]=c[f+4]*d[f+4]+e[f+4],b[f+5]=c[f+5]*d[f+5]+e[f+5],b[f+6]=c[f+6]*d[f+6]+e[f+6],b[f+7]=c[f+7]*d[f+7]+e[f+7]},b[2][2][1]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this._add,f=this.inputs[2][0],g=(f-e)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]*d[h]+e,e+=g,b[h+1]=c[h+1]*d[h+1]+e,e+=g,b[h+2]=c[h+2]*d[h+2]+e,e+=g,b[h+3]=c[h+3]*d[h+3]+e,e+=g,b[h+4]=c[h+4]*d[h+4]+e,e+=g,b[h+5]=c[h+5]*d[h+5]+e,e+=g,b[h+6]=c[h+6]*d[h+6]+e,e+=g,b[h+7]=c[h+7]*d[h+7]+e,e+=g;this._add=f},b[2][2][0]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this._add,f=0;a>f;f+=8)b[f]=c[f]*d[f]+e,b[f+1]=c[f+1]*d[f+1]+e,b[f+2]=c[f+2]*d[f+2]+e,b[f+3]=c[f+3]*d[f+3]+e,b[f+4]=c[f+4]*d[f+4]+e,b[f+5]=c[f+5]*d[f+5]+e,b[f+6]=c[f+6]*d[f+6]+e,b[f+7]=c[f+7]*d[f+7]+e},b[2][1][2]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._mul,e=this.inputs[2],f=this.inputs[1][0],g=(f-d)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]*d+e[h],d+=g,b[h+1]=c[h+1]*d+e[h+1],d+=g,b[h+2]=c[h+2]*d+e[h+2],d+=g,b[h+3]=c[h+3]*d+e[h+3],d+=g,b[h+4]=c[h+4]*d+e[h+4],d+=g,b[h+5]=c[h+5]*d+e[h+5],d+=g,b[h+6]=c[h+6]*d+e[h+6],d+=g,b[h+7]=c[h+7]*d+e[h+7],d+=g;this._mul=f},b[2][1][1]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._mul,e=this._add,f=this.inputs[1][0],g=(f-d)*this.rate.slopeFactor,h=this.inputs[2][0],i=(h-e)*this.rate.slopeFactor,j=0;a>j;j+=8)b[j]=c[j]*d+e,d+=g,e+=i,b[j+1]=c[j+1]*d+e,d+=g,e+=i,b[j+2]=c[j+2]*d+e,d+=g,e+=i,b[j+3]=c[j+3]*d+e,d+=g,e+=i,b[j+4]=c[j+4]*d+e,d+=g,e+=i,b[j+5]=c[j+5]*d+e,d+=g,e+=i,b[j+6]=c[j+6]*d+e,d+=g,e+=i,b[j+7]=c[j+7]*d+e,d+=g,e+=i;this._mul=f,this._add=h},b[2][1][0]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._mul,e=this._add,f=this.inputs[1][0],g=(f-d)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]*d+e,d+=g,b[h+1]=c[h+1]*d+e,d+=g,b[h+2]=c[h+2]*d+e,d+=g,b[h+3]=c[h+3]*d+e,d+=g,b[h+4]=c[h+4]*d+e,d+=g,b[h+5]=c[h+5]*d+e,d+=g,b[h+6]=c[h+6]*d+e,d+=g,b[h+7]=c[h+7]*d+e,d+=g;this._mul=f},b[2][0][2]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._mul,e=this.inputs[2],f=0;a>f;f+=8)b[f]=c[f]*d+e[f],b[f+1]=c[f+1]*d+e[f+1],b[f+2]=c[f+2]*d+e[f+2],b[f+3]=c[f+3]*d+e[f+3],b[f+4]=c[f+4]*d+e[f+4],b[f+5]=c[f+5]*d+e[f+5],b[f+6]=c[f+6]*d+e[f+6],b[f+7]=c[f+7]*d+e[f+7]},b[2][0][1]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._mul,e=this._add,f=this.inputs[2][0],g=(f-e)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]*d+e,e+=g,b[h+1]=c[h+1]*d+e,e+=g,b[h+2]=c[h+2]*d+e,e+=g,b[h+3]=c[h+3]*d+e,e+=g,b[h+4]=c[h+4]*d+e,e+=g,b[h+5]=c[h+5]*d+e,e+=g,b[h+6]=c[h+6]*d+e,e+=g,b[h+7]=c[h+7]*d+e,e+=g;this._add=f},b[2][0][0]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._mul,e=this._add,f=this.inputs[1][0],g=(f-d)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]*d+e,d+=g,b[h+1]=c[h+1]*d+e,d+=g,b[h+2]=c[h+2]*d+e,d+=g,b[h+3]=c[h+3]*d+e,d+=g,b[h+4]=c[h+4]*d+e,d+=g,b[h+5]=c[h+5]*d+e,d+=g,b[h+6]=c[h+6]*d+e,d+=g,b[h+7]=c[h+7]*d+e,d+=g;this._mul=f},b[1][1][2]=function(a){for(var b=this.outputs[0],c=this._in,d=this._mul,e=this.inputs[2],f=this.inputs[0][0],g=(f-c)*this.rate.slopeFactor,h=this.inputs[1][0],i=(h-d)*this.rate.slopeFactor,j=0;a>j;j+=8)b[j]=c*d+e[j],c+=g,d+=i,b[j+1]=c*d+e[j+1],c+=g,d+=i,b[j+2]=c*d+e[j+2],c+=g,d+=i,b[j+3]=c*d+e[j+3],c+=g,d+=i,b[j+4]=c*d+e[j+4],c+=g,d+=i,b[j+5]=c*d+e[j+5],c+=g,d+=i,b[j+6]=c*d+e[j+6],c+=g,d+=i,b[j+7]=c*d+e[j+7],c+=g,d+=i;this._in=f,this._mul=h},b[1][1][1]=function(){this.outputs[0][0]=this.inputs[0][0]*this.inputs[1][0]+this.inputs[2][0]},b[1][1][0]=function(){this.outputs[0][0]=this.inputs[0][0]*this.inputs[1][0]+this._add},b[1][0][2]=function(a){for(var b=this.outputs[0],c=this._in,d=this._mul,e=this.inputs[2],f=this.inputs[0][0],g=(f-c)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c*d+e[h],c+=g,b[h+1]=c*d+e[h+1],c+=g,b[h+2]=c*d+e[h+2],c+=g,b[h+3]=c*d+e[h+3],c+=g,b[h+4]=c*d+e[h+4],c+=g,b[h+5]=c*d+e[h+5],c+=g,b[h+6]=c*d+e[h+6],c+=g,b[h+7]=c*d+e[h+7],c+=g;this._in=f},b[1][0][1]=function(){this.outputs[0][0]=this.inputs[0][0]*this._mul+this.inputs[2][0]},b[1][0][0]=function(){this.outputs[0][0]=this.inputs[0][0]*this._mul+this._add},a}(),d.unit.specs.Sum3=function(){var a=function(){var a=this.inRates,c=b[a[0]][a[1]][a[2]];this.process=c,this._in0=this.inputs[0][0],this._in1=this.inputs[1][0],this._in2=this.inputs[2][0],this.process?this.process(1):this.outputs[0][0]=this._in0+this._in1+this._in2},b={};return b[2]={},b[2][2]={},b[2][1]={},b[2][0]={},b[1]={},b[1][1]={},b[1][0]={},b[0]={},b[0][0]={},b[2][2][2]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this.inputs[2],f=0;a>f;f+=8)b[f]=c[f]+d[f]+e[f],b[f+1]=c[f+1]+d[f+1]+e[f+1],b[f+2]=c[f+2]+d[f+2]+e[f+2],b[f+3]=c[f+3]+d[f+3]+e[f+3],b[f+4]=c[f+4]+d[f+4]+e[f+4],b[f+5]=c[f+5]+d[f+5]+e[f+5],b[f+6]=c[f+6]+d[f+6]+e[f+6],b[f+7]=c[f+7]+d[f+7]+e[f+7]},b[2][2][1]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this._in2,f=this.inputs[2][0],g=(f-e)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]+d[h]+e,e+=g,b[h+1]=c[h+1]+d[h+1]+e,e+=g,b[h+2]=c[h+2]+d[h+2]+e,e+=g,b[h+3]=c[h+3]+d[h+3]+e,e+=g,b[h+4]=c[h+4]+d[h+4]+e,e+=g,b[h+5]=c[h+5]+d[h+5]+e,e+=g,b[h+6]=c[h+6]+d[h+6]+e,e+=g,b[h+7]=c[h+7]+d[h+7]+e,e+=g;this._in2=f},b[2][2][0]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this._in2,f=0;a>f;f+=8)b[f]=c[f]+d[f]+e,b[f+1]=c[f+1]+d[f+1]+e,b[f+2]=c[f+2]+d[f+2]+e,b[f+3]=c[f+3]+d[f+3]+e,b[f+4]=c[f+4]+d[f+4]+e,b[f+5]=c[f+5]+d[f+5]+e,b[f+6]=c[f+6]+d[f+6]+e,b[f+7]=c[f+7]+d[f+7]+e},b[2][1][1]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._in1+this._in2,e=this.inputs[1][0]+this.inputs[2][0],f=(e-d)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c[g]+d,d+=f,b[g+1]=c[g+1]+d,d+=f,b[g+2]=c[g+2]+d,d+=f,b[g+3]=c[g+3]+d,d+=f,b[g+4]=c[g+4]+d,d+=f,b[g+5]=c[g+5]+d,d+=f,b[g+6]=c[g+6]+d,d+=f,b[g+7]=c[g+7]+d,d+=f;this._in1=this.inputs[1][0],this._in2=this.inputs[2][0]},b[2][1][0]=b[2][1][1],b[2][0][0]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._in1+this._in2,e=0;a>e;e+=8)b[e]=c[e]+d,b[e+1]=c[e+1]+d,b[e+2]=c[e+2]+d,b[e+3]=c[e+3]+d,b[e+4]=c[e+4]+d,b[e+5]=c[e+5]+d,b[e+6]=c[e+6]+d,b[e+7]=c[e+7]+d},b[1][1][1]=function(){this.outputs[0][0]=this.inputs[0][0]+this.inputs[1][0]+this.inputs[2][0]},b[1][1][0]=b[1][1][1],b[1][0][0]=b[1][1][1],a}(),d.unit.specs.Sum4=function(){var a=function(){var a=this.inRates,c=b[a[0]][a[1]][a[2]][a[3]];this.process=c,this._in0=this.inputs[0][0],this._in1=this.inputs[1][0],this._in2=this.inputs[2][0],this._in3=this.inputs[3][0],this.process?this.process(1):this.outputs[0][0]=this._in0*this._in1+this._in2+this._in3},b={};return b[2]={},b[2][2]={},b[2][2][2]={},b[2][2][1]={},b[2][2][0]={},b[2][1]={},b[2][1][1]={},b[2][1][0]={},b[2][0]={},b[2][0][0]={},b[1]={},b[1][1]={},b[1][1][1]={},b[1][1][0]={},b[1][0]={},b[1][0][0]={},b[0]={},b[0][0]={},b[0][0][0]={},b[2][2][2][2]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this.inputs[2],f=this.inputs[3],g=0;a>g;g+=8)b[g]=c[g]+d[g]+e[g]+f[g],b[g+1]=c[g+1]+d[g+1]+e[g+1]+f[g+1],b[g+2]=c[g+2]+d[g+2]+e[g+2]+f[g+2],b[g+3]=c[g+3]+d[g+3]+e[g+3]+f[g+3],b[g+4]=c[g+4]+d[g+4]+e[g+4]+f[g+4],b[g+5]=c[g+5]+d[g+5]+e[g+5]+f[g+5],b[g+6]=c[g+6]+d[g+6]+e[g+6]+f[g+6],b[g+7]=c[g+7]+d[g+7]+e[g+7]+f[g+7]},b[2][2][2][1]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this.inputs[2],f=this._in3,g=this.inputs[3][0],h=(g-f)*this.rate.slopeFactor,i=0;a>i;i+=8)b[i]=c[i]+d[i]+e[i]+f,f+=h,b[i+1]=c[i+1]+d[i+1]+e[i+1]+f,f+=h,b[i+2]=c[i+2]+d[i+2]+e[i+2]+f,f+=h,b[i+3]=c[i+3]+d[i+3]+e[i+3]+f,f+=h,b[i+4]=c[i+4]+d[i+4]+e[i+4]+f,f+=h,b[i+5]=c[i+5]+d[i+5]+e[i+5]+f,f+=h,b[i+6]=c[i+6]+d[i+6]+e[i+6]+f,f+=h,b[i+7]=c[i+7]+d[i+7]+e[i+7]+f,f+=h;this._in3=g},b[2][2][2][0]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this.inputs[2],f=this._in3,g=0;a>g;g+=8)b[g]=c[g]+d[g]+e[g]+f,b[g+1]=c[g+1]+d[g+1]+e[g+1]+f,b[g+2]=c[g+2]+d[g+2]+e[g+2]+f,b[g+3]=c[g+3]+d[g+3]+e[g+3]+f,b[g+4]=c[g+4]+d[g+4]+e[g+4]+f,b[g+5]=c[g+5]+d[g+5]+e[g+5]+f,b[g+6]=c[g+6]+d[g+6]+e[g+6]+f,b[g+7]=c[g+7]+d[g+7]+e[g+7]+f},b[2][2][1][1]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this._in2+this._in3,f=this.inputs[2][0]+this.inputs[3][0],g=(f-e)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]+d[h]+e,e+=g,b[h+1]=c[h+1]+d[h+1]+e,e+=g,b[h+2]=c[h+2]+d[h+2]+e,e+=g,b[h+3]=c[h+3]+d[h+3]+e,e+=g,b[h+4]=c[h+4]+d[h+4]+e,e+=g,b[h+5]=c[h+5]+d[h+5]+e,e+=g,b[h+6]=c[h+6]+d[h+6]+e,e+=g,b[h+7]=c[h+7]+d[h+7]+e,e+=g;this._in2=this.inputs[2][0],this._in3=this.inputs[2][0]},b[2][2][1][0]=b[2][2][1][1],b[2][2][0][0]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this.inputs[1],e=this._in2+this._in3,f=0;a>f;f+=8)b[f]=c[f]+d[f]+e,b[f+1]=c[f+1]+d[f+1]+e,b[f+2]=c[f+2]+d[f+2]+e,b[f+3]=c[f+3]+d[f+3]+e,b[f+4]=c[f+4]+d[f+4]+e,b[f+5]=c[f+5]+d[f+5]+e,b[f+6]=c[f+6]+d[f+6]+e,b[f+7]=c[f+7]+d[f+7]+e},b[2][1][1][1]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._in1+this._in2+this._in3,e=this.inputs[1][0]+this.inputs[2][0]+this.inputs[3][0],f=(e-d)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c[g]+d,d+=f,b[g+1]=c[g+1]+d,d+=f,b[g+2]=c[g+2]+d,d+=f,b[g+3]=c[g+3]+d,d+=f,b[g+4]=c[g+4]+d,d+=f,b[g+5]=c[g+5]+d,d+=f,b[g+6]=c[g+6]+d,d+=f,b[g+7]=c[g+7]+d,d+=f;this._in1=this.inputs[1][0],this._in2=this.inputs[2][0],this._in3=this.inputs[3][0]},b[2][1][1][0]=b[2][1][1][1],b[2][1][0][0]=b[2][1][1][1],b[2][0][0][0]=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._in1+this._in2+this._in3,e=0;a>e;e+=8)b[e]=c[e]+d,b[e+1]=c[e+1]+d,b[e+2]=c[e+2]+d,b[e+3]=c[e+3]+d,b[e+4]=c[e+4]+d,b[e+5]=c[e+5]+d,b[e+6]=c[e+6]+d,b[e+7]=c[e+7]+d},b[1][1][1][1]=function(){this.outputs[0][0]=this.inputs[0][0]+this.inputs[1][0]+this.inputs[2][0]+this.inputs[3][0]},b[1][1][1][0]=b[1][1][1][1],b[1][1][0][0]=b[1][1][1][1],b[1][0][0][0]=b[1][1][1][1],a}(),c.exports={}}),e("cc/server/unit/osc",function(a,b,c){var d=a("../cc"),e=a("./table"),f=2*Math.PI,g=e.kSineSize,h=e.kSineMask,i=e.gSineWavetable;d.unit.specs.SinOsc=function(){var a=function(){this._freq=this.inputs[0][0],this._phase=this.inputs[1][0],this._radtoinc=g/f,this._cpstoinc=g*this.rate.sampleDur,this._mask=h,this._table=i,2===this.inRates[0]?(this.process=2===this.inRates[1]?b:1===this.inRates[1]?c:d,this._x=0):2===this.inRates[1]?(this.process=e,this._x=0):(this.process=j,this._x=this._phase*this._radtoinc),j.call(this,1)},b=function(a){var b,c,d,e=this.outputs[0],f=this.inputs[0],g=this.inputs[1],h=this._mask,i=this._table,j=this._cpstoinc,k=this._radtoinc,l=this._x;for(d=0;a>d;++d)b=l+k*g[d],c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],l+=f[d]*j;this._x=l},c=function(a){var b,c,d,e=this.outputs[0],f=this.inputs[0],g=this.inputs[1][0],h=this._mask,i=this._table,j=this._radtoinc,k=this._cpstoinc,l=this._phase,m=this._x;if(g===l)for(l*=j,d=0;a>d;++d)b=m+l,c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],m+=f[d]*k;else{var n=(g-l)*this.rate.slopeFactor;for(d=0;a>d;++d)b=m+j*l,c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],l+=n,m+=f[d]*k;this._phase=g}this._x=m},d=function(a){var b,c,d,e=this.outputs[0],f=this.inputs[0],g=this._phase*this._radtoinc,h=this._mask,i=this._table,j=this._cpstoinc,k=this._x;for(d=0;a>d;++d)b=k+g,c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],k+=j*f[d];this._x=k},e=function(a){var b,c,d,e=this.outputs[0],f=this.inputs[0][0],g=this.inputs[1],h=this._mask,i=this._table,j=this._radtoinc,k=this._cpstoinc,l=this._freq,m=this._x;if(f===l)for(l*=k,d=0;a>d;++d)b=m+j*g[d],c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],m+=l;else{var n=(f-l)*this.rate.slopeFactor;for(d=0;a>d;++d)b=m+j*g[d],c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],m+=l*k,l+=n;this._freq=f}this._x=m},j=function(a){var b,c,d,e=this.outputs[0],f=this.inputs[0][0],g=this.inputs[1][0],h=this._mask,i=this._table,j=this._radtoinc,k=this._cpstoinc,l=this._freq,m=this._phase,n=this._x;if(f===l&&g===m)for(l*=k,m*=j,d=0;a>d;++d)b=n+m,c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],n+=l;else{var o=(f-l)*this.rate.slopeFactor,p=(g-m)*this.rate.slopeFactor;for(d=0;a>d;++d)b=n+j*m,c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],n+=l*k,l+=o,m+=p;this._freq=f,this._phase=g}this._x=n};return a}(),d.unit.specs.SinOscFB=function(){var a=function(){this.process=b,this._radtoinc=g/f,this._cpstoinc=g*this.rate.sampleDur,this._mask=h,this._table=i,this._freq=this.inputs[0][0],this._feedback=this.inputs[1][0]*this._radtoinc,this._y=0,this._x=0,this.process(1)},b=function(a){var b,c,d,e=this.outputs[0],f=this.inputs[0][0],g=this.inputs[1][0],h=this._mask,i=this._table,j=this._radtoinc,k=this._cpstoinc,l=this._freq,m=this._feedback,n=this._y,o=this._x;if(f===l&&g===m)for(l*=k,m*=j,d=0;a>d;++d)b=o+m*n,c=(b&h)<<1,e[d]=n=i[c]+(b-(0|b))*i[c+1],o+=l;else{var p=(f-l)*this.rate.slopeFactor,q=(g-m)*this.rate.slopeFactor;for(d=0;a>d;++d)b=o+j*m*n,c=(b&h)<<1,e[d]=n=i[c]+(b-(0|b))*i[c+1],o+=l*k,l+=p,m+=q;this._freq=f,this._feedback=g}this._y=n,this._x=o};return a}(),d.unit.specs.LFSaw=function(){var a=function(){this.process=2===this.inRates[0]?b:c,this._cpstoinc=2*this.rate.sampleDur,this._phase=this.inputs[1][0],this.process(1)},b=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._cpstoinc,e=this._phase,f=0;a>f;++f)b[f]=e,e+=c[f]*d,e>=1?e-=2:-1>=e&&(e+=2);this._phase=e},c=function(a){var b,c=this.outputs[0],d=this.inputs[0][0]*this._cpstoinc,e=this._phase;if(d>=0)for(b=0;a>b;++b)c[b]=e,e+=d,e>=1&&(e-=2);else for(b=0;a>b;++b)c[b]=e,e+=d,-1>=e&&(e+=2);this._phase=e};return a}(),d.unit.specs.LFPar=function(){var a=function(){this.process=2===this.inRates[0]?b:c,this._cpstoinc=4*this.rate.sampleDur,this._phase=this.inputs[1][0],this.process(1)},b=function(a){for(var b,c,d=this.outputs[0],e=this.inputs[0],f=this._cpstoinc,g=this._phase,h=0;a>h;++h)1>g?(b=g,c=1-b*b):3>g?(b=g-2,c=b*b-1):(g-=4,b=g,c=1-b*b),d[h]=c,g+=e[h]*f;this._phase=g},c=function(a){for(var b,c,d=this.outputs[0],e=this.inputs[0][0]*this._cpstoinc,f=this._phase,g=0;a>g;++g)1>f?(b=f,c=1-b*b):3>f?(b=f-2,c=b*b-1):(f-=4,b=f,c=1-b*b),d[g]=c,f+=e;this._phase=f};return a}(),d.unit.specs.LFCub=function(){var a=function(){this.process=2===this.inRates[0]?b:c,this._cpstoinc=2*this.rate.sampleDur,this._phase=this.inputs[1][0]+.5,this.process(1)},b=function(a){for(var b,c=this.outputs[0],d=this.inputs[0],e=this._cpstoinc,f=this._phase,g=0;a>g;++g)1>f?b=f:2>f?b=2-f:(f-=2,b=f),c[g]=b*b*(6-4*b)-1,f+=d[g]*e;this._phase=f},c=function(a){for(var b,c=this.outputs[0],d=this.inputs[0][0]*this._cpstoinc,e=this._phase,f=0;a>f;++f)1>e?b=e:2>e?b=2-e:(e-=2,b=e),c[f]=b*b*(6-4*b)-1,e+=d;this._phase=e};return a}(),d.unit.specs.LFTri=function(){var a=function(){this.process=2===this.inRates[0]?b:c,this._cpstoinc=4*this.rate.sampleDur,this._phase=this.inputs[1][0],this.process(1)},b=function(a){for(var b=this.outputs[0],c=this.inputs[0],d=this._cpstoinc,e=this._phase,f=0;a>f;++f)b[f]=e>1?2-e:e,e+=c[f]*d,e>=3&&(e-=4);this._phase=e},c=function(a){for(var b=this.outputs[0],c=this.inputs[0][0]*this._cpstoinc,d=this._phase,e=0;a>e;++e)b[e]=d>1?2-d:d,d+=c,d>=3&&(d-=4);this._phase=d};return a}(),d.unit.specs.LFPulse=function(){var a=function(){this.process=2===this.inRates[0]?b:c,this._cpstoinc=this.rate.sampleDur,this._phase=this.inputs[1][0],this._duty=this.inputs[2][0],this.process(1)},b=function(a){for(var b,c=this.outputs[0],d=this.inputs[0],e=this._cpstoinc,f=this.inputs[2][0],g=this._duty,h=this._phase,i=0;a>i;++i)h>1?(h-=1,g=f,b=.5>g?1:0):b=g>h?1:0,c[i]=b,h+=d[i]*e;this._duty=g,this._phase=h},c=function(a){for(var b,c=this.outputs[0],d=this.inputs[0][0]*this._cpstoinc,e=this.inputs[2][0],f=this._duty,g=this._phase,h=0;a>h;++h)g>1?(g-=1,f=e,b=.5>f?1:0):b=f>g?1:0,c[h]=b,g+=d;this._duty=f,this._phase=g};return a}(),c.exports={}}),e("cc/server/unit/table",function(a,b,c){var d=2*Math.PI,e=8192,f=e-1,g=new Float32Array([1e20])[0],h=new Float32Array(e+1),i=new Float32Array(e+1),j=new Float32Array(2*e);!function(){var a;for(a=0;e>a;++a){var b=Math.sin(d*(a/e));h[a]=b,i[a]=1/b}h[e]=h[0],i[0]=i[e>>1]=i[e]=g;var c=e,f=c>>1;for(a=1;8>=a;++a)i[a]=i[c-a]=i[f-a]=i[f+a]=g}(),function(){!function(a,b,c){var d,e,f,g;for(f=g=0;c-1>f;++f)d=a[f],e=a[f+1],b[g++]=2*d-e,b[g++]=e-d;d=a[c-1],e=a[0],b[g++]=2*d-e,b[g++]=e-d}(h,j,e)}(),c.exports={kSineSize:e,kSineMask:f,gSine:h,gInvSine:i,gSineWavetable:j}}),e("cc/server/unit/pan",function(a,b,c){var d=a("../cc"),e=a("./table"),f=e.gSine;d.unit.specs.Pan2=function(){var a=function(){this.process=2===this.inRates[1]?c:b,this._pos=this.inputs[1][0],this._level=this.inputs[2][0];var a=0|1024*this._pos+1024+.5;a=Math.max(0,Math.min(a,2048)),this._leftAmp=this._level*f[2048-a],this._rightAmp=this._level*f[a],c.call(this,1)},b=function(a){a=0|a},c=function(a){a=0|a;var b,c,d,e,g,h=this.outputs[0],i=this.outputs[1],j=this.inputs[0],k=this.inputs[1],l=this.inputs[2][0],m=this._level;if(m!==l){var n=(l-m)*this.rate.slopeFactor;for(b=0;a>b;++b)d=0|1024*k[b]+1024+.5,d=Math.max(0,Math.min(d,2048)),e=m*f[2048-d],g=m*f[d],c=j[b],h[b]=c*e,i[b]=c*g,m+=n;this._level=l}else for(b=0;a>b;++b)d=0|1024*k[b]+1024+.5,d=Math.max(0,Math.min(d,2048)),e=m*f[2048-d],g=m*f[d],c=j[b],h[b]=c*e,i[b]=c*g};return a}(),c.exports={}}),e("cc/server/unit/ui",function(a,b,c){var d=a("../cc"),e=Math.log(.001);d.unit.specs.MouseX=function(){var a=function(){this.process=b,this._y1=0,this._b1=0,this._lag=0,this.process(1)},b=function(a,b){var c=this.inputs[0][0]||.01,d=this.inputs[1][0],f=this.inputs[2][0],g=this.inputs[3][0],h=this._y1,i=this._b1;g!==this._lag&&(this._b1=0===g?0:Math.exp(e/(g*this.rate.sampleRate)),this._lag=g);var j=b?b.f32_syncItems[2]:0;0===f?j=(d-c)*j+c:(j=Math.pow(d/c,j)*c,isNaN(j)&&(j=0)),this.outputs[0][0]=h=j+i*(h-j),this._y1=h};return a}(),d.unit.specs.MouseY=function(){var a=function(){this.process=b,this._y1=0,this._b1=0,this._lag=0,this.process(1)},b=function(a,b){var c=this.inputs[0][0]||.01,d=this.inputs[1][0],f=this.inputs[2][0],g=this.inputs[3][0],h=this._y1,i=this._b1;g!==this._lag&&(this._b1=0===g?0:Math.exp(e/(g*this.rate.sampleRate)),this._lag=g);var j=b?b.f32_syncItems[3]:0;0===f?j=(d-c)*j+c:(j=Math.pow(d/c,j)*c,isNaN(j)&&(j=0)),this.outputs[0][0]=h=j+i*(h-j),this._y1=h};return a}(),d.unit.specs.MouseButton=function(){var a=function(){this.process=b,this._y1=0,this._b1=0,this._lag=0,this.process(1)},b=function(a,b){var c=this.inputs[0][0],d=this.inputs[1][0],f=this.inputs[2][0],g=this._y1,h=this._b1;f!==this._lag&&(this._b1=0===f?0:Math.exp(e/(f*this.rate.sampleRate)),this._lag=f);var i=b?b.f32_syncItems[4]?d:c:c;this.outputs[0][0]=g=i+h*(g-i),this._y1=g};return a}(),c.exports={}}),e("cc/server/unit/uop",function(a,b,c){var d=a("../cc"),e=a("../../common/ops"),f=a("./utils").avoidzero,g={};d.unit.specs.UnaryOpUGen=function(){var a=function(){var a,b=g[e.UNARY_OP_UGEN_MAP[this.specialIndex]];if(b){switch(this.inRates[0]){case 2:a=b.a;break;case 1:a=b.k}this.process=a,this.process?this.process(1):this.outputs[0][0]=b(this.inputs[0][0])}else d.console.warn("UnaryOpUGen["+e.UNARY_OP_UGEN_MAP[this.specialIndex]+"] is not defined.")};return a}();var h=function(a){return function(){this.outputs[0][0]=a(this.inputs[0][0])}},i=function(a){return function(b){for(var c=this.outputs[0],d=this.inputs[0],e=0;b>e;e+=8)c[e]=a(d[e]),c[e+1]=a(d[e+1]),c[e+2]=a(d[e+2]),c[e+3]=a(d[e+3]),c[e+4]=a(d[e+4]),c[e+5]=a(d[e+5]),c[e+6]=a(d[e+6]),c[e+7]=a(d[e+7])}};g.neg=function(a){return-a},g.not=function(a){return 0===a?1:0},g.abs=function(a){return Math.abs(a)},g.ceil=function(a){return Math.ceil(a)},g.floor=function(a){return Math.floor(a)},g.frac=function(a){return 0>a?1+(a-(0|a)):a-(0|a)},g.sign=function(a){return 0===a?0:a>0?1:-1},g.squared=function(a){return a*a},g.cubed=function(a){return a*a*a},g.sqrt=function(a){return Math.sqrt(Math.abs(a))},g.exp=function(a){return Math.exp(a)},g.reciprocal=function(a){return 1/f(a)},g.midicps=function(a){return 440*Math.pow(2,1*(a-69)/12)},g.cpsmidi=function(a){return 12*Math.log(1*Math.abs(f(a))/440)*Math.LOG2E+69},g.midiratio=function(a){return Math.pow(2,1*a/12)},g.ratiomidi=function(a){return 12*Math.log(Math.abs(f(a)))*Math.LOG2E},g.dbamp=function(a){return Math.pow(10,.05*a)},g.ampdb=function(a){return 20*Math.log(Math.abs(f(a)))*Math.LOG10E},g.octcps=function(a){return 440*Math.pow(2,f(a)-4.75)},g.cpsoct=function(a){return Math.log(1*Math.abs(a)/440)*Math.LOG2E+4.75},g.log=function(a){return Math.log(Math.abs(f(a)))},g.log2=function(a){return Math.log(Math.abs(f(a)))*Math.LOG2E},g.log10=function(a){return Math.log(Math.abs(f(a)))*Math.LOG10E},g.sin=function(a){return Math.sin(a)},g.cos=function(a){return Math.cos(a)},g.tan=function(a){return Math.tan(a)},g.asin=function(a){return Math.asin(Math.max(-1,Math.min(a,1)))},g.acos=function(a){return Math.acos(Math.max(-1,Math.min(a,1)))},g.atan=function(a){return Math.atan(a)},g.sinh=function(a){return.5*(Math.pow(Math.E,a)-Math.pow(Math.E,-a))},g.cosh=function(a){return.5*(Math.pow(Math.E,a)+Math.pow(Math.E,-a))},g.tanh=function(a){var b=.5*(Math.pow(Math.E,a)-Math.pow(Math.E,-a)),c=.5*(Math.pow(Math.E,a)+Math.pow(Math.E,-a));return b/c},g.rand=function(a){return Math.random()*a},g.rand2=function(a){return(2*Math.random()-1)*a},g.linrand=function(a){return Math.min(Math.random(),Math.random())*a},g.bilinrand=function(a){return(Math.random()-Math.random())*a},g.sum3rand=function(a){return.666666667*(Math.random()+Math.random()+Math.random()-1.5)*a},g.distort=function(a){return a/(1+Math.abs(a))},g.softclip=function(a){var b=Math.abs(a);return.5>=b?a:(b-.25)/a},g.coin=function(a){return Math.random()<a?1:0},g.num=function(a){return+a
},g.tilde=function(a){return~a},g.pi=function(a){return Math.PI*a},g.to_i=function(a){return 0|a},Object.keys(g).forEach(function(a){var b=g[a];b.a=i(b),b.k=h(b)}),c.exports={calcFunc:g,unary_k:h,unary_a:i}}),e("cc/server/commands",function(a,b,c){var d=a("./node"),e=a("./buffer"),f={};f["/n_run"]=function(a){var b=0|a[1],c=!!a[2],d=this.nodes[b];d&&(d.running=c)},f["/n_free"]=function(a){var b=0|a[1],c=this.nodes[b];c&&c.doneAction(2)},f["/n_set"]=function(a){var b=0|a[1],c=a[2],d=this.nodes[b];d&&d.set(c)},f["/g_new"]=function(a){var b=0|a[1],c=0|a[2],e=0|a[3],f=this.nodes[e];f&&(this.nodes[b]=new d.Group(b,f,c,this))},f["/s_def"]=function(a){var b=0|a[1],c=JSON.parse(a[2]);this.defs[b]=c},f["/s_new"]=function(a){var b=0|a[1],c=0|a[2],e=0|a[3],f=0|a[4],g=a[5],h=this.nodes[e];h&&(this.nodes[b]=new d.Synth(b,h,c,f,g,this))},f["/b_new"]=function(a){var b=0|a[1];this.buffers[b]=new e.AudioBuffer(b)},f["/b_bind"]=function(a){var b=0|a[1],c=0|a[2],d=0|a[3],e=0|a[4],f=this.buffers[b],g=this.bufSrc[c];f&&(g?f.bindBufferSource(g,d,e):(g=new f.BufferSource(c),g.pendings.push([f,d,e]),this.bufSrc[c]=g))},f[0]=function(a){this.syncItems.set(a);var b=this.manager.server,c=new Uint32Array(a.buffer)[1];b.sysSyncCount<c&&(b.sysSyncCount=c)},f[1]=function(a){var b=(a[3]<<8)+a[2],c=(a[7]<<8)+a[6],d=(a[11]<<24)+(a[10]<<16)+(a[9]<<8)+a[8],f=(a[15]<<24)+(a[14]<<16)+(a[13]<<8)+a[12],g=new Float32Array(a.subarray(16).buffer),h=this.bufSrc[b];h||(h=new e.BufferSource(b)),h.set(c,d,f,g),this.bufSrc[b]=h},c.exports=f}),e("cc/server/buffer",function(a,b,c){var d=function(){function a(a){this.bufSrcId=a,this.channels=0,this.sampleRate=0,this.frames=0,this.samples=null,this.pendings=[]}return a.prototype.set=function(a,b,c,d){this.channels=a,this.sampleRate=b,this.frames=c,this.samples=d,this.pendings.forEach(function(a){var b=a[0],c=a[1],d=a[2];b.bindBufferSource(this,c,d)},this),this.pendings=null},a}(),e=function(){function a(a){this.bufId=a,this.frames=0,this.channels=0,this.sampleRate=0,this.samples=null}return a.prototype.bindBufferSource=function(a,b,c){b=Math.max(0,Math.min(0|b,a.frames)),c=Math.max(-1,Math.min(0|c,a.frames-b)),0===b?-1===c?(this.samples=a.samples,this.frames=a.frames):(this.samples=new Float32Array(a.samples.buffer,0,c),this.frames=c):-1===c?(this.samples=new Float32Array(a.samples.buffer,4*b),this.frames=a.frames-b):(this.samples=new Float32Array(a.samples.buffer,4*b,c),this.frames=c),this.channels=a.channels,this.sampleRate=a.sampleRate},a}();c.exports={BufferSource:d,AudioBuffer:e}}),e("cc/server/rate",function(a,b,c){var d=a("./cc"),e=function(){function a(a,c){this.sampleRate=a,this.sampleDur=1/a,this.radiansPerSample=b/a,this.bufLength=c,this.bufDuration=c/a,this.bufRate=1/this.bufDuration,this.slopeFactor=1/c,this.filterLoops=0|c/3,this.filterRemain=0|c%3,this.filterSlope=0===this.filterLoops?0:1/this.filterLoops}var b=2*Math.PI;return a}();c.exports={use:function(){d.createRate=function(a,b){return new e(a,b)},d.getRateInstance=function(){var a={};return function(b){if(!a[b])switch(b){case 2:a[2]=new e(d.server.sampleRate,d.server.bufLength);break;case 1:a[1]=new e(d.server.sampleRate/d.server.bufLength,1)}return a[b]}}()}},c.exports.use()}),e("cc/server/server-worker",function(a,b,c){var d=a("./cc"),e=a("../common/extend"),f=function(){function a(){d.SynthServer.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=1024,this.bufLength=64,this.offset=0}return e(a,d.SynthServer),a.prototype.sendToLang=function(a){postMessage(a)},a.prototype.connect=function(){this.sendToLang(["/connected",this.sampleRate,this.channels])},a.prototype.process=function(){if(!(this.sysSyncCount<this.syncCount[0]-4)){for(var a=this.strm,b=this.instanceManager,c=this.strmLength,e=this.bufLength,f=b.busOutL,g=b.busOutR,h=d.lang,i=0,j=0,k=c/e;k>j;++j){h.process(),b.process(e);for(var l=e,m=c+e;m--,l--;)a[l+i]=Math.max(-32768,Math.min(32768*f[l],32767)),a[m+i]=Math.max(-32768,Math.min(32768*g[l],32767));i+=e}this.sendToLang(a),this.syncCount[0]+=1}},a}();c.exports={use:function(){d.createWorkerSynthServer=function(){var a=new f;return d.opmode="worker",a}}},c.exports.use()}),e("cc/server/server-iframe",function(b,c,d){var e=b("./cc"),f=b("../common/extend"),g=function(){function a(){e.SynthServer.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=2048,this.bufLength=128}return f(a,e.SynthServer),a.prototype.sendToLang=function(a){postMessage(a)},a.prototype.connect=function(){this.sendToLang(["/connected",this.sampleRate,this.channels])},a.prototype.process=function(){if(!(this.sysSyncCount<this.syncCount[0]-4)){for(var a=this.strm,b=this.instanceManager,c=this.strmLength,d=this.bufLength,e=b.busOutL,f=b.busOutR,g=0,h=0,i=c/d;i>h;++h){b.process(d);for(var j=d,k=c+d;k--,j--;)a[j+g]=Math.max(-32768,Math.min(32768*e[j],32767)),a[k+g]=Math.max(-32768,Math.min(32768*f[j],32767));g+=d}this.sendToLang(a),this.sendToLang(["/process"]),this.syncCount+=1}},a}();d.exports={use:function(){e.createIFrameSynthServer=function(){var b=new g;return a.onmessage=function(a){b.recvFromLang(a.data,0)},e.opmode="iframe",b}}},d.exports.use()}),e("cc/server/server-nodejs",function(a,b,c){var d=a("./cc"),e=a("../common/extend"),f=function(){function b(){a("../common/audioapi"),d.SynthServer.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=4096,this.bufLength=64}return e(b,d.SynthServer),b.prototype.init=function(){this.initialized||(d.SynthServer.prototype.init.call(this),this.api=d.createAudioAPI(this))},b.prototype.connect=function(){this.sendToLang(["/connected",this.sampleRate,this.channels])},b.prototype.play=function(a,b){b=0|b,this.instanceManager.play(b),this.api&&(this._strm=new Int16Array(this.strmLength*this.channels),this.strmList=new Array(8),this.strmListReadIndex=0,this.strmListWriteIndex=0,this.api.isPlaying||this.api.play()),this.timer.isRunning()||this.timer.start(this.process.bind(this),10)},b.prototype.pause=function(a,b){b=0|b,this.instanceManager.pause(b),this.api&&this.api.isPlaying&&(this.instanceManager.isRunning()||this.api.pause()),this.timer.isRunning()&&(this.instanceManager.isRunning()||this.timer.stop())},b.prototype.process=function(){if(!(this.sysSyncCount<this.syncCount[0]-4)){for(var a=this.strm,b=this.instanceManager,c=this.strmLength,e=this.bufLength,f=b.busOutL,g=b.busOutR,h=d.lang,i=0,j=0,k=c/e;k>j;++j){h.process(),b.process(e);for(var l=e,m=c+e;m--,l--;)a[l+i]=Math.max(-32768,Math.min(32768*f[l],32767)),a[m+i]=Math.max(-32768,Math.min(32768*g[l],32767));i+=e}this.sendToLang(a),this.syncCount[0]+=1,this.api&&(this.strmList[this.strmListWriteIndex]=new Int16Array(a),this.strmListWriteIndex=7&this.strmListWriteIndex+1)}},b.prototype._process=function(){var a=this.strmList[this.strmListReadIndex];a&&(this.strmListReadIndex=7&this.strmListReadIndex+1,this._strm.set(a)),this.sysSyncCount+=1},b}();d.NodeJSSynthServer=f,c.exports={use:function(){d.createNodeJSSynthServer=function(){var a=new f;return d.opmode="nodejs",a}}},c.exports.use()}),e("cc/server/server-socket",function(b,c,d){var e=b("./cc"),f=b("../common/extend"),g=b("../common/emitter"),h=function(){function b(){e.NodeJSSynthServer.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=4096,this.bufLength=128,this.list=[],this.map={},this.exports=null}var c;return a.require&&(c=a.require("ws").Server),f(b,e.NodeJSSynthServer),b.prototype._init=function(a){var b=this,d=0,f=this.exports;"undefined"!=typeof a.speaker&&(a.speaker&&(this.api=e.createAudioAPI(this)),delete a.speaker),this.socket=new c(a),this.socket.on("connection",function(a){var c=d++;b.list.push(a),b.map[c]=a,b.instanceManager.append(c),a.on("message",function(a){a="string"!=typeof a?new Uint8Array(a):JSON.parse(a),b.recvFromLang(a,c)}),a.on("close",function(){b.map[c]&&(b.pause([],c),b.instanceManager.remove(c),b.list.splice(b.list.indexOf(a),1),delete b.map[c]),f.emit("close",c)}),a.on("error",function(a){f.emit("error",c,a)}),b.sendToLang(["/connected",b.sampleRate,b.channels],c),f.emit("open",c)}),this.init()},b.prototype.connect=function(){},b.prototype.sendToLang=function(a,b){if(a instanceof Int16Array)this.list.forEach(function(b){1===b.readyState&&b.send(a.buffer,{binary:!0,mask:!1})});else if(a=JSON.stringify(a),void 0===b)this.list.forEach(function(b){1===b.readyState&&b.send(a)});else{var c=this.map[b];c&&1===c.readyState&&c.send(a)}},b.prototype.process=function(){if(!(this.sysSyncCount<this.syncCount[0]-4)){for(var a=this.strm,b=this.instanceManager,c=this.strmLength,d=this.bufLength,e=b.busOutL,f=b.busOutR,g=0,h=0,i=c/d;i>h;++h){b.process(d);for(var j=d,k=c+d;k--,j--;)a[j+g]=Math.max(-32768,Math.min(32768*e[j],32767)),a[k+g]=Math.max(-32768,Math.min(32768*f[j],32767));g+=d}this.sendToLang(a),this.sendToLang(["/process"]),this.syncCount[0]+=1,this.api&&(this.strmList[this.strmListWriteIndex]=new Int16Array(a),this.strmListWriteIndex=7&this.strmListWriteIndex+1)}},b}(),i=function(){function a(a,c){return b?(e.console.warn("CoffeeColliderSocketServer has been created already."),b):(g.mixin(this),this.server=a,this.server.exports=this,this.server._init(c||{}),b=this,void 0)}var b=null;return a.prototype.send=function(a,b){return this.server.sendToLang(["/socket/sendToClient",a],b),this},a}();d.exports={use:function(){e.createSocketSynthServer=function(){var a=new h;return a.exports={createServer:function(b){return new i(a,b)}},e.opmode="socket",a}}},d.exports.use()});var f=c("cc/cc","cc/loader");"undefined"!=typeof module&&(module.exports=f)}(this.self||global);
//# sourceMappingURL=build/coffee-collider-min.map