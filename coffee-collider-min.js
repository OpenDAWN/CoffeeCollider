!function(a){"use strict";var b=function(a,c){b.modules||(b.modules={},b.payloads={}),b.payloads[a]=c,b.modules[a]=null},c=function(a,e){e=d(a,e);var f=b.modules[e];if(!f){f=b.payloads[e];var g={},h={id:e,exports:g},i=function(a){return c(e,a)},j=f(i,g,h);g=j||h.exports,b.modules[e]=g,delete b.payloads[e]}return f=b.modules[e]=g||f},d=function(a,b){if("."===b.charAt(0)){var c=a.split("/").slice(0,-1).join("/");b=c+"/"+b;for(var d;-1!==b.indexOf(".")&&d!==b;)d=b,b=b.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return b};"function"==typeof require&&(a.require=require);var e=b;e("cc/loader",function(b,c,d){var e=b("./cc");if("undefined"!=typeof document){var f=document.getElementsByTagName("script");if(f&&f.length)for(var g=0;g<f.length;g++){var h=/^(.*\/)coffee-collider(?:-min)?\.js(\#.*)?$/.exec(f[g].src);if(h){e.rootPath=h[1],e.coffeeColliderPath=h[0],e.coffeeColliderHash=h[2];break}}"#iframe"===e.coffeeColliderHash?(e.opmode="iframe",e.context="client",b("./client/client").use(),e.client=e.createSynthClient()):"#socket"===e.coffeeColliderHash?(e.opmode="socket",e.context="client",b("./client/client").use(),e.client=e.createSynthClient()):(e.opmode="exports",e.context="exports",b("./exports/coffeecollider").use(),a.CoffeeCollider=function(a){return e.createCoffeeCollider(a)})}else"undefined"!=typeof WorkerLocation?"#iframe"===location.hash?(e.opmode="iframe",e.context="server",b("./server/server").use(),e.server=e.createSynthServer(),e.server.connect()):(e.opmode="worker",e.context="client/server",b("./client/client").use(),b("./server/server").use(),e.client=e.createSynthClient(),e.server=e.createSynthServer(),e.client.sendToServer=e.server.recvFromClient.bind(e.server),e.server.sendToClient=e.client.recvFromServer.bind(e.client),e.server.connect()):"undefined"!=typeof a.GLOBAL&&(e.opmode="socket",e.context="server",b("./server/server").use(),e.server=e.createSynthServer(),d.exports.createServer=e.server.exports.createServer)}),e("cc/cc",function(a,b,c){function d(){}c.exports={version:"0",Object:d}}),e("cc/client/client",function(b,c,d){var e=b("./cc"),f=b("../common/extend"),g=b("../common/pack").pack,h={},i=function(){function a(){this.klassName="SynthClient",this.sampleRate=0,this.channels=0,this.strmLength=0,this.bufLength=0,this.rootNode=e.createGroup(),this.timeline=e.createTimeline(),this.timelineResult=[],this.bufferRequestId=0,this.bufferRequestCallback={},this.phase=0}return a.prototype.sendToIF=function(){throw"should be overridden"},a.prototype.recvFromIF=function(a){if(a){var b=h[a[0]];b&&b.call(this,a)}},a.prototype.sendToServer=function(){throw"should be overridden"},a.prototype.recvFromServer=function(a){if(a instanceof Int16Array)this.sendToIF(a);else{var b=h[a[0]];if(!b)throw new Error("Unknown command: "+a[0]);b.call(this,a)}},a.prototype.pushToTimeline=function(a){this.timelineResult.push(a)},a.prototype.play=function(a){this.timeline.play(1e3*(this.bufLength/this.sampleRate)),this.sendToServer(a)},a.prototype.pause=function(a){this.sendToServer(a)},a.prototype.reset=function(a){e.resetBuffer(),e.resetNode(),e.resetNativeTimers(),this.timeline.reset(),this.sendToServer(a)},a.prototype.requestBuffer=function(a,b){if("string"==typeof a&&"function"==typeof b){var c=this.bufferRequestId++;this.bufferRequestCallback[c]=b,this.sendToIF(["/buffer/request",a,c])}},a.prototype.process=function(){throw"should be overridden"},a}(),j=function(){function a(){i.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=1024,this.bufLength=64}return f(a,i),a.prototype.sendToIF=function(a){postMessage(a)},a.prototype.process=function(){this.timeline.process();var a=this.timelineResult.splice(0);this.sendToServer(["/processed",a])},a}(),k=function(){function a(){i.call(this);var a=this;this.sampleRate=44100,this.channels=2,this.strmLength=2048,this.bufLength=128,this.server=e.createWebWorker(e.coffeeColliderPath),this.server.onmessage=function(b){a.recvFromServer(b.data)},b("../common/console").bindConsoleApply(h)}return b("../common/browser").use(),f(a,i),a.prototype.sendToServer=function(a){this.server.postMessage(a)},a.prototype.process=function(){for(var a=this.timeline,b=this.strmLength/this.bufLength,c=[];b--;)a.process(),c=c.concat(this.timelineResult.splice(0),0);this.sendToServer(["/processed",c])},a}(),l=function(){function a(){i.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=4096,this.bufLength=128,this.socketPath=null}return b("../common/browser").use(),f(a,i),a.prototype.openSocket=function(){var a=this,b=this.socket=e.createWebSocket(this.socketPath),c=[];b.binaryType="arraybuffer",b.onopen=function(){c.forEach(function(a){b.send(a)}),c=[]},b.onmessage=function(b){var c=b.data;return"string"!=typeof c?(a.sendToIF(new Int16Array(c)),void 0):(a.recvFromServer(JSON.parse(c)),void 0)},b.onclose=function(){},b.onerror=function(){},this.sendToServer=function(a){a instanceof Uint8Array?b.readyState===WebSocket.OPEN&&b.send(a.buffer):b.readyState===WebSocket.OPEN?b.send(JSON.stringify(a)):c.push(JSON.stringify(a))}},a.prototype.closeSocket=function(){this.socket.close(),this.socket=null},a.prototype.process=function(){for(var a=this.timeline,b=this.strmLength/this.bufLength,c=[];b--;)a.process(),c=c.concat(this.timelineResult.splice(0),0);this.sendToServer(["/processed",c])},a}();h["/connected"]=function(a){this.sendToIF(a)},h["/init"]=function(a){this.sampleRate=0|a[1],this.channels=0|a[2],this.sendToServer(a)},h["/play"]=function(a){this.play(a)},h["/pause"]=function(a){this.pause(a)},h["/reset"]=function(a){this.reset(a)},h["/process"]=function(){this.process()},h["/socket/open"]=function(){this.openSocket()},h["/socket/close"]=function(){this.closeSocket()},h["/socket/sendToServer"]=function(a){this.sendToServer(a)},h["/socket/sendToIF"]=function(a){this.sendToIF(a)},h["/execute"]=function(b){var c=b[1],d=b[2],f=b[3],h=b[4],i=b[5];f||this.reset(["/reset"]),e.DATA=h,a._gltc_=this.timeline.context;var j=eval.call(a,d);i&&this.sendToIF(["/executed",c,g(j)])},h["/buffer/response"]=function(a){var b=a[1],c=a[2],d=this.bufferRequestCallback[c];d&&(d(b),delete this.bufferRequestCallback[c])},h["/importScripts"]=function(a){importScripts(a[1])},h["/console/log"]=function(a){this.sendToIF(a)},h["/console/debug"]=function(a){this.sendToIF(a)},h["/console/info"]=function(a){this.sendToIF(a)},h["/console/warn"]=function(a){this.sendToIF(a)},h["/console/error"]=function(a){this.sendToIF(a)},h["/emit/n_end"]=function(a){var b=0|a[1],c=e.getNode(b);c&&c.emit("end")},h["/emit/n_done"]=function(a){var b=0|a[1],c=a[2],d=e.getNode(b);d&&d.emit("done",c)},d.exports={use:function(){b("../common/timer").use(),b("./buffer").use(),b("./node").use(),b("./sched").use(),b("./ugen/exports").use(),e.client_exports=function(){b("./object").exports(),b("./number").exports(),b("./data").exports(),b("./buffer").exports(),b("./node").exports(),b("./sched").exports(),b("./scale").exports(),b("./ugen/exports").exports()},e.createSynthClient=function(){switch(e.client_exports(),e.opmode){case"worker":return e.createWorkerSynthClient();case"iframe":return e.createIFrameSynthClient();case"socket":return e.createSocketSynthClient()}throw new Error("A SynthClient is not defined for: "+e.opmode)};var c=function(a){var b=a.data;b instanceof Uint8Array?e.client.sendToServer(b):e.client.recvFromIF(b)};e.createWorkerSynthClient=function(){var b=new j;return a.onmessage=c,e.opmode="worker",b},e.createIFrameSynthClient=function(){var a=new k;return"undefined"!=typeof window&&(window.onmessage=function(b){b.ports[0].onmessage=c,a.sendToIF=function(a){b.ports[0].postMessage(a)},window.onmessage=null}),e.opmode="iframe",a},e.createSocketSynthClient=function(){var a=new l;return"undefined"!=typeof window&&(window.onmessage=function(b){b.ports[0].onmessage=c,a.sendToIF=function(a){b.ports[0].postMessage(a)},a.socketPath=b.data,window.onmessage=null}),e.opmode="socket",a},e.replaceNativeTimerFunctions()}}}),e("cc/client/cc",function(a,b,c){c.exports=a("../cc")}),e("cc/common/extend",function(a,b,c){var d=function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c.exports=d}),e("cc/common/pack",function(a,b,c){var d=function(){var a=function(b,c){if(!b)return b;if(-1!==c.indexOf(b))return{klassName:"Circular"};if("function"==typeof b)return"[Function]";var d;if("object"==typeof b){if(b.buffer instanceof ArrayBuffer)return b;c.push(b),Array.isArray(b)?d=b.map(function(b){return a(b,c)}):(d={},Object.keys(b).forEach(function(e){"_"!==e.charAt(0)&&(d[e]=a(b[e],c))})),c.pop()}else d=b;return d};return function(b){return a(b,[])}}(),e=function(){var a=function(){},b=function(c){if(!c)return c;if("string"==typeof c)return"[Function]"===c?a:c;var d;if("object"==typeof c){if(c.buffer instanceof ArrayBuffer)return c;Array.isArray(c)?d=c.map(function(a){return b(a)}):(c.klassName&&/^[_a-z$][_a-z0-9$]*$/i.test(c.klassName)?(d=eval.call(null,"new (function "+c.klassName+"(){})"),delete c.klassName):d={},Object.keys(c).forEach(function(a){d[a]=b(c[a])}))}else d=c;return d};return function(a){return b(a)}}();c.exports={pack:d,unpack:e}}),e("cc/common/browser",function(a,b,c){var d=a("../cc");c.exports={use:function(){d.createWebWorker=function(a){return new Worker(a)},d.createWebSocket=function(a){return new WebSocket(a)},d.createXMLHttpRequest=function(){return new XMLHttpRequest},d.createMessageChannel=function(){return new MessageChannel},d.createHTMLIFrameElement=function(){var a=document.createElement("iframe");return a.style.width=0,a.style.height=0,a.style.border=0,document.body.appendChild(a),a}}}}),e("cc/common/console",function(a,b,c){var d=a("./pack").unpack,e=function(a){a["/console/log"]=function(a){console.log.apply(console,d(a[1]))},a["/console/debug"]=function(a){console.debug.apply(console,d(a[1]))},a["/console/info"]=function(a){console.info.apply(console,d(a[1]))},a["/console/warn"]=function(a){console.warn.apply(console,d(a[1]))},a["/console/error"]=function(a){console.error.apply(console,d(a[1]))}};c.exports={bindConsoleApply:e}}),e("cc/common/timer",function(b,c,d){var e=b("../cc"),f=setInterval,g=clearInterval,h=setTimeout,i=clearTimeout,j=function(){function a(){this._timerId=0}return a.prototype.start=function(a,b){this._timerId&&g(this._timerId),this._timerId=0,"function"==typeof a&&"number"==typeof b&&(this._timerId=f(a,b))},a.prototype.stop=function(){this._timerId&&g(this._timerId),this._timerId=0},a.prototype.isRunning=function(){return!!this._timerId},a}(),k=function(){function a(){this._worker=new Worker(b),this._worker.onmessage=null}if("undefined"!=typeof Worker){var b=function(){try{var a="var t=0;onmessage=function(e){if(t)t=clearInterval(t),0;if(typeof e.data=='number'&&e.data>0)t=setInterval(function(){postMessage(0);},e.data);};",b=new Blob([a],{type:"text/javascript"}),c=URL.createObjectURL(b);return new Worker(c),c}catch(d){}}();if(b)return a.prototype.start=function(a,b){this._worker.onmessage&&this._worker.postMessage(0),this._worker.onmessage=null,"function"==typeof a&&"number"==typeof b&&(this._worker.onmessage=a,this._worker.postMessage(b))},a.prototype.stop=function(){this._worker.onmessage&&this._worker.postMessage(0),this._worker.onmessage=null},j.prototype.isRunning=function(){return!!this._worker.onmessage},a}}(),l=[],m=function(){a.setInterval=function(a,b){var c=f(a,b);return l.push(c),c},a.clearInterval=function(a){g(a);var b=l.indexOf(a);-1!==b&&l.splice(b,1)},a.setTimeout=function(a,b){var c=h(a,b);return l.push(c),c},a.clearTimeout=function(a){i(a);var b=l.indexOf(a);-1!==b&&l.splice(b,1)}},n=function(){a.setInterval=f,a.clearInterval=g,a.setTimeout=h,a.clearTimeout=i},o=function(){l.splice(0).forEach(function(a){g(a),i(a)})};d.exports={WorkerTimer:k,NativeTimer:j,use:function(){e.createTimer=function(){return k?new k:new j},e.replaceNativeTimerFunctions=m,e.restoreNativeTimerFunctions=n,e.resetNativeTimers=o}}}),e("cc/client/buffer",function(b,c,d){var e=b("./cc"),f=b("./fn"),g=b("../common/extend"),h=b("../common/emitter"),i=0,j={},k=function(){function a(){h.mixin(this),this.klassName="Buffer",this.frames=0,this.channels=0,this.sampleRate=0,this._blocking=!0,this._bufId=b++,e.client.pushToTimeline(["/b_new",this._bufId])}var b=0;return g(a,e.Object),a.prototype.performWait=function(){return this._blocking},a}(),l=function(a,b){var c=new Uint8Array(16+4*b.samples.length),d=new Uint16Array(c.buffer),f=new Uint32Array(c.buffer),g=new Float32Array(c.buffer),h=i++;return d[0]=1,d[1]=h,d[3]=b.numChannels,f[2]=b.sampleRate,f[3]=b.numFrames,g.set(b.samples,4),e.client.sendToServer(c),j[a]=h,delete b.samples,h},m=function(a,b,c){e.client.pushToTimeline(["/b_bind",this._bufId,a,b,c])},n=function(){};n.read=f(function(a,b,c){if("string"!=typeof a)throw new TypeError("Buffer.Read: arguments[0] should be a string.");var d=j[a],f=new k;return"number"==typeof d?m.call(f,d,b,c):e.client.requestBuffer(a,function(d){if(d){var e=l(a,d);m.call(f,e,b,c)}}),f}).defaults("path,startFrame=0,numFrames=-1").multiCall().build();var o=function(){j={},i=0};d.exports={AudioBuffer:k,use:function(){e.createAudioBuffer=function(){return new k},e.instanceOfAudioBuffer=function(a){return a instanceof k},e.resetBuffer=o},exports:function(){"undefined"==typeof Buffer&&(a.Buffer=n)}}}),e("cc/client/fn",function(a,b,c){var d=a("./cc"),e=a("./utils"),f=[].slice,g=function(){function a(a){this.func=a,this.def=null,this.multi=!1}a.prototype.defaults=function(a){return this.def=a,this},a.prototype.multiCall=function(a){return this.multi=void 0===a?!0:!!a,this},a.prototype.build=function(){var a=this.func,d=[],g=[];this.def&&this.def.split(",").forEach(function(a){a=a.trim().split("="),d.push(a[0].trim()),g.push(a.length>1?+a[1].trim():void 0)});var h=a;return this.multi?h=this.def?function(){var h=f.call(arguments);return h=c(d,g,f.call(arguments)),b(h)?e.flop(h).map(function(b){return a.apply(this,b)},this):a.apply(this,h)}:function(){var c=f.call(arguments);return b(c)?e.flop(c).map(function(b){return a.apply(this,b)},this):a.apply(this,c)}:this.def&&(h=function(){var b=f.call(arguments);return b=c(d,g,f.call(arguments)),a.apply(this,b)}),h};var b=function(a){for(var b=0,c=a.length;c>b;++b)if(Array.isArray(a[b]))return!0;return!1},c=function(a,b,c){var d,f=b.slice();if(e.isDict(c[c.length-1])){d=c.pop();for(var g in d){var h=a.indexOf(g);-1!==h&&(f[h]=d[g])}}for(var i=0,j=Math.min(c.length,f.length);j>i;++i)f[i]=c[i];return d&&f.length<a.length-1&&f.push(d),f};return function(b){return new a(b)}}();g.sync=function(a){return function(){return d.timeline.push(this,a,f.call(arguments)),this}},g.definePrototypeProperty=function(a,b,c){Object.defineProperty(a.prototype,b,{configurable:!0,enumerable:!1,writable:!0,value:c})},c.exports=g}),e("cc/client/utils",function(a,b,c){var d=function(a){return!(!a||a.constructor!==Object)},e=function(a){var b=a.reduce(function(a,b){return Math.max(a,Array.isArray(b)?b.length:1)},0),c=new Array(b),d=a.length;if(d)for(var e=0;b>e;++e)for(var f=c[e]=new Array(d),g=0;d>g;++g)f[g]=Array.isArray(a[g])?a[g][e%a[g].length]:a[g];return c},f=function(){var a=function(b,c){for(var d=0,e=b.length;e>d;++d)Array.isArray(b[d])?c=a(b[d],c):c.push(b[d]);return c};return function(b){return a(b,[])}}(),g=function(a,b){for(var c=[],d=[],e=0,f=a.length;f>e;++e)d.push(a[e]),d.length>=b&&(c.push(d),d=[]);return d.length&&c.push(d),c};c.exports={isDict:d,flop:e,flatten:f,clump:g}}),e("cc/common/emitter",function(a,b,c){var d=function(){function a(a){this.__context=a||this,this.__callbacks={}}return a.prototype.getListeners=function(a){return this.__callbacks[a]||(this.__callbacks[a]=[])},a.prototype.hasListeners=function(a){return this.getListeners(a).length>0},a.prototype.on=function(a,b){var c=this.getListeners(a);return-1===c.indexOf(b)&&c.push(b),this},a.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(d.__context,arguments)}var d=this;return c.callback=b,this.on(a,c),this},a.prototype.off=function(a,b){if(0===arguments.length)return this.__callbacks={},this;var c=this.getListeners(a);if(1===arguments.length)return c.splice(0),this;var d=c.indexOf(b);if(-1===d)for(var e=0,f=c.length;f>e;++e)if(c[e].callback===b){d=e;break}return-1!==d&&c.splice(d,1),this},a.prototype.emit=function(a){for(var b=Array.prototype.slice.call(arguments,1),c=this.getListeners(a).slice(0),d=0,e=c.length;e>d;++d)c[d].apply(this.__context,b);return this},a}(),e=function(a){return["getListeners","hasListeners","on","once","off","emit"].forEach(function(b){a[b]||(a[b]=d.prototype[b])}),d.call(a),a};c.exports={Emitter:d,mixin:e}}),e("cc/client/node",function(b,c,d){var e=b("./cc"),f=b("./fn"),g=b("../common/extend"),h=b("./utils"),i=b("../common/emitter"),j={},k=function(){function a(){i.mixin(this),this.klassName="Node",this.nodeId=b++,this._blocking=!0,j[this.nodeId]=this}var b=0;return g(a,e.Object),a.prototype.play=f.sync(function(){return e.client.pushToTimeline(["/n_run",this.nodeId,!0]),this}),a.prototype.pause=f.sync(function(){return e.client.pushToTimeline(["/n_run",this.nodeId,!1]),this}),a.prototype.stop=f.sync(function(){return e.client.pushToTimeline(["/n_free",this.nodeId]),this._blocking=!1,this}),a.prototype.performWait=function(){return this._blocking},a}(),l=function(){function a(a,b){if(k.call(this),this.klassName="Group",a){var c=this,d=e.client.timeline;d.push(function(){e.client.pushToTimeline(["/g_new",c.nodeId,b,a.nodeId])})}}return g(a,k),a}(),m=function(){function a(a,c,d,f){if(k.call(this),this.klassName="Synth",this.params=d.specs.params,a){var g=this,h=e.client.timeline,i=b(f,this.params);h.push(function(){e.client.pushToTimeline(["/s_new",g.nodeId,c,a.nodeId,d._defId,i])})}}g(a,k);var b=function(a,b){var c=[];return h.isDict(a)&&Object.keys(a).forEach(function(d){var e=a[d],f=b.names.indexOf(d);if(-1!==f){f=b.indices[f];var g=b.length[f];Array.isArray(e)?e.forEach(function(a,b){g>b&&("number"!=typeof a||isNaN(a)||c.push(f+b,a))}):"number"!=typeof e||isNaN(e)||c.push(f,e)}}),c};return a.prototype._set=function(a){var c=b(a,this.params);c.length&&e.client.pushToTimeline(["/n_set",this.nodeId,c])},a.prototype.set=f.sync(a.prototype._set),a}(),n=function(){function a(a,d){this.klassName="SynthDef",this._defId=b++;var f=!1;if(d){if(/^[ a-zA-Z0-9_$,.=\-\[\]]+$/.test(d)&&(d=g(d),d&&(f=d.vals.every(function(a){return"number"==typeof a?!0:Array.isArray(a)?a.every(function(a){return"number"==typeof a}):void 0===a||null===a?!0:!1}))),!f)throw"UgenGraphFunc's arguments should be a constant number or an array that contains it."}else d={keys:[],vals:[]};var h=[];e.setSynthDef(function(a){h.push(a)});var i,j,k,l={names:[],indices:[],length:[],values:[]},m=[];for(i=0,j=d.vals.length;j>i;++i)k=Array.isArray(d.vals[i])?d.vals[i].length:1,l.names.push(d.keys[i]),l.indices.push(m.length),l.length.push(k),l.values=l.values.concat(d.vals[i]),m=m.concat(d.vals[i]);var n=[],o=e.createControl(1).init(m);Array.isArray(o)||(o=[o]);var p=o.slice();for(i=0;j>i;++i)Array.isArray(d.vals[i])?n.push(p.splice(0,d.vals[i].length)):n.push(p.shift());try{a.apply(null,n)}catch(q){throw q.toString()}finally{e.setSynthDef(null)}var r=[];h.forEach(function(a){a.inputs&&a.inputs.forEach(function(a){"number"==typeof a&&-1===r.indexOf(a)&&r.push(a)})}),r.sort();var s=c(h).filter(function(a){return!("number"==typeof a||e.instanceOfOutputProxy(a))}),t=s.map(function(a){var b=[];a.inputs&&a.inputs.forEach(function(a){var c=s.indexOf(e.instanceOfOutputProxy(a)?a.inputs[0]:a),d=-1!==c?a.outputIndex:r.indexOf(a);b.push(c,d)});var c;return c=e.instanceOfMultiOutUGen(a)?a.channels.map(function(a){return a.rate}):1===a.numOfOutputs?[a.rate]:[],[a.klassName,a.rate,0|a.specialIndex,b,c,a.tag]}),u={consts:r,defs:t,params:l};return this.specs=u,e.client.pushToTimeline(["/s_def",this._defId,JSON.stringify(u)]),this}var b=0;a.prototype.play=f(function(){var a,b,c,d=0;switch(a=arguments[d]instanceof k?arguments[d++]:e.client.rootNode,h.isDict(arguments[d])&&(b=arguments[d++]),c="string"==typeof arguments[d]?arguments[d]:"addToHead",b&&1===arguments.length&&(b.target instanceof k&&(a=b.target,delete b.target),"string"==typeof b.addAction&&(c=b.addAction,delete b.addAction)),c){case"addToHead":return p.head(a,this,b);case"addToTail":return p.tail(a,this,b);case"addBefore":return p.before(a,this,b);case"addAfter":return p.after(a,this,b);default:return p.head(a,this,b)}}).multiCall().build();var c=function(){var a=function(b,c,d){d.push(b);var e=c.indexOf(b);-1!==e&&c.splice(e,1),c.unshift(b),b.inputs&&b.inputs.forEach(function(b){a(b,c,d)})};return function(b){var c=[];return b.slice().forEach(function(d){e.instanceOfOut(d)&&(c.push(d),d.inputs.forEach(function(d){a(d,b,c)}))}),b=b.filter(function(a){return-1!==c.indexOf(a)})}}(),d=function(a){for(var b=[],c=0,d=0,e=null,f=0,g=a.length;g>f;++f){var h=a.charAt(f);if(("\\"!==a.charAt(f-1)||"\\"===a.charAt(f-2))&&(('"'===h||"'"===h)&&(null===e?e=h:e===h&&(e=null)),!e))switch(h){case",":0===d&&(b.push(a.slice(c,f).trim()),c=f+1);break;case"[":d+=1;break;case"]":d-=1}}return c!==f&&b.push(a.slice(c,f).trim()),b},g=function(a){var b=[],c=[];if(a)try{d(a).forEach(function(a){var d,e,f=a.indexOf("=");-1===f?(d=a,e=void 0):(d=a.substr(0,f).trim(),e=JSON.parse(a.substr(f+1))),b.push(d),c.push(e)})}catch(e){return}return{keys:b,vals:c}};return a}(),o=function(){return new l};o.after=function(a){if(a=a||e.client.rootNode,!(a instanceof k))throw new TypeError("Group.after: arguments[0] is not a Node.");return new l(a,3)},o.before=function(a){if(a=a||e.client.rootNode,!(a instanceof k))throw new TypeError("Group.before: arguments[0] is not a Node.");return new l(a,2)},o.head=function(a){if(a=a||e.client.rootNode,!(a instanceof l))throw new TypeError("Group.head: arguments[0] is not a Group.");return new l(a,0)},o.tail=function(a){if(a=a||e.client.rootNode,!(a instanceof l))throw new TypeError("Group.tail: arguments[0] is not a Group.");return new l(a,1)},o.replace=function(a){if(!(a instanceof k))throw new TypeError("Group.replace: arguments[0] is not a Node.");return new l(a,4)};var p=function(){return new m};p.def=function(a,b){if("function"!=typeof a)throw new TypeError("Synth.def: arguments[0] is not a Function.");return new n(a,b)},p.after=function(){var a,b,c;if(arguments[0]instanceof n?(a=e.client.rootNode,b=arguments[0],c=arguments[1]||{}):arguments[1]instanceof n&&(a=arguments[0],b=arguments[1],c=arguments[2]||{}),!(a instanceof k))throw new TypeError("Synth.after: arguments[0] is not a Node.");if(!(b instanceof n))throw new TypeError("Synth.after: arguments[1] is not a SynthDef.");return new m(a,3,b,c)},p.before=function(){var a,b,c;if(arguments[0]instanceof n?(a=e.client.rootNode,b=arguments[0],c=arguments[1]||{}):arguments[1]instanceof n&&(a=arguments[0],b=arguments[1],c=arguments[2]||{}),!(a instanceof k))throw new TypeError("Synth.before: arguments[0] is not a Node.");if(!(b instanceof n))throw new TypeError("Synth.before: arguments[1] is not a SynthDef.");return new m(a,2,b,c)},p.head=function(){var a,b,c;if(arguments[0]instanceof n?(a=e.client.rootNode,b=arguments[0],c=arguments[1]||{}):arguments[1]instanceof n&&(a=arguments[0],b=arguments[1],c=arguments[2]||{}),!(a instanceof l))throw new TypeError("Synth.head: arguments[0] is not a Group.");if(!(b instanceof n))throw new TypeError("Synth.head: arguments[1] is not a SynthDef.");return new m(a,0,b,c)},p.tail=function(){var a,b,c;if(arguments[0]instanceof n?(a=e.client.rootNode,b=arguments[0],c=arguments[1]||{}):arguments[1]instanceof n&&(a=arguments[0],b=arguments[1],c=arguments[2]||{}),!(a instanceof l))throw new TypeError("Synth.tail: arguments[0] is not a Group.");if(!(b instanceof n))throw new TypeError("Synth.tail: arguments[1] is not a SynthDef.");return new m(a,1,b,c)},p.replace=function(a,b,c){if(!(a instanceof k))throw new TypeError("Synth.replace: arguments[0] is not a Node.");if(!(b instanceof n))throw new TypeError("Synth.replace: arguments[1] is not a SynthDef.");return new m(a,4,b,c)};var q=function(){j={}},r=function(a){return j[a]};d.exports={Node:k,Group:l,Synth:m,use:function(){b("./ugen/ugen").use(),e.createGroup=function(a,b){return new l(a,b)},e.getNode=r,e.resetNode=q},exports:function(){a.Group=o,a.Synth=p}}}),e("cc/client/ugen/ugen",function(b,c,d){var e=b("../cc"),f=b("../fn"),g=b("../../common/extend"),h=b("../utils"),i=[].slice,j=null,k=function(){function a(a){this.klassName=a,this.tag="",this.rate=2,this.signalRange=2,this.specialIndex=0,this.outputIndex=0,this.numOfInputs=0,this.numOfOutputs=1,this.inputs=[]}return g(a,e.Object),a.prototype.init=function(a){return this.rate=a,j&&j(this),this.inputs=i.call(arguments,1),this.numOfInputs=this.inputs.length,this},a.prototype.madd=f(function(a,b){return e.createMulAdd(this,a,b)}).defaults("mul=1,add=0").multiCall().build(),a.prototype.range=f(function(a,b){var c,d;return 2===this.signalRange?(c=.5*(b-a),d=c+a):(c=b-a,d=a),e.createMulAdd(this,c,d)}).defaults("lo=0,hi=1").multiCall().build(),a.prototype.unipolar=f(function(a){return this.range(0,a)}).defaults("mul=1").multiCall().build(),a.prototype.bipolar=f(function(a){return this.range(a.neg(),a)}).defaults("mul=1").multiCall().build(),a}(),l=function(){function a(a){k.call(this,a||"MultiOutUGen"),this.channels=null}return g(a,k),a.prototype.initOutputs=function(a,b){for(var c=new Array(a),d=0;a>d;++d)c[d]=new m(b,this,d);return this.channels=c,this.numOfOutputs=c.length,this.inputs=this.inputs.map(function(a){return a instanceof k||(a=+a,isNaN(a)&&(a=0)),a}),this.numOfInputs=this.inputs.length,1===a?c[0]:c},a}(),m=function(){function a(a,b,c){k.call(this,"OutputProxy"),this.init(a),this.inputs=[b],this.numOfOutputs=1,this.outputIndex=c}return g(a,k),a}(),n=function(){function a(a){l.call(this,"Control"),this.rate=a,this.values=null}return g(a,l),a.prototype.init=function(a){return k.prototype.init.apply(this,[this.rate].concat(a)),this.values=a.slice(),this.initOutputs(this.values.length,this.rate)},a}(),o=function(){function a(){k.call(this,"Out")}return g(a,k),a}(),p=function(a){function b(b,c){if(!(b instanceof k||"number"==typeof b))throw new TypeError("Out: arguments[0] should be an UGen or a number.");Array.isArray(c)||(c=[c]),c=h.flatten(c),c=c.filter(function(a){return 0!==a}),c.length&&k.prototype.init.apply(new o,[a,b].concat(c))}return function(a,c){return Array.isArray(a)?a.forEach(function(a){b(a,c)}):b(a,c),0}},q={ar:{defaults:"bus=0,channelsArray=0",ctor:p(2),multiCall:!1,Klass:null},kr:{defaults:"bus=0,channelsArray=0",ctor:p(1),multiCall:!1,Klass:null}},r={ar:{defaults:"bus=0,numChannels=1",ctor:function(a,b){return this.init.call(this,2),this.inputs=[a],this.initOutputs(b,this.rate)},Klass:l},kr:{defaults:"bus=0,numChannels=1",ctor:function(a,b){return this.init.call(this,1),this.inputs=[a],this.initOutputs(b,this.rate)},Klass:l}},s=function(b,c){var d=a[b]=function(){return new k(b)};Object.keys(c).forEach(function(a){var e=c[a],g=e.defaults+",tag",h=e.ctor,j=e.multiCall;if(void 0===j&&(j=!0),null!==e.Klass){var l=e.Klass||k;d[a]=f(function(){var a=i.call(arguments,0,arguments.length-1),c=arguments[arguments.length-1],d=h.apply(new l(b,c),a);return d instanceof k&&(d.tag=c||""),d}).defaults(g).multiCall(j).build()}else d[a]=f(function(){var a=i.call(arguments,0,arguments.length-1),b=arguments[arguments.length-1],c=h.apply(null,a);return c instanceof k&&(c.tag=b||""),c}).defaults(g).multiCall(j).build()})};e.UGen=k,e.MultiOutUGen=l,e.registerUGen=s,d.exports={UGen:k,MultiOutUGen:l,OutputProxy:m,Control:n,Out:o,use:function(){e.createUGen=function(){return new k},e.createOutputProxy=function(a,b,c){return new m(a,b,c)},e.createControl=function(a){return new n(a)},e.instanceOfUGen=function(a){return a instanceof k},e.instanceOfMultiOutUGen=function(a){return a instanceof l},e.instanceOfOutputProxy=function(a){return a instanceof m},e.instanceOfOut=function(a){return a instanceof o},e.setSynthDef=function(a){if(a&&null!==j)throw new Error("nested Synth.def");j=a},e.UGen=k,e.MultiOutUGen=l,e.registerUGen=s},exports:function(){s("Out",q),s("In",r)}}}),e("cc/client/sched",function(b,c,d){var e=b("./cc"),f=b("./fn"),g=b("../common/extend"),h=b("../common/emitter"),i=function(){function a(){this.klassName="Timeline",this.reset()}return g(a,e.Object),a.prototype.play=function(a){this.counterIncr=a},a.prototype.pause=function(){this.counterIncr=0},a.prototype.reset=function(){var a=e.createTaskGlobal(this);this._list=[a],this._stack=[a],this.context=a.context},a.prototype.append=function(a){var b=this._list.indexOf(a);-1===b&&this._list.push(a)},a.prototype.remove=function(a){var b=this._list.indexOf(a);-1!==b&&this._list.splice(b,1)},a.prototype.push=function(a,b,c){this._stack[this._stack.length-1].push(a,b,c)},a.prototype.process=function(){var a=this.counterIncr;if(a)for(var b=this._list,c=0;c<b.length;++c)b[c].process(a)},a}(),j=function(){function a(a){h.mixin(this),this.klassName="TaskWaitToken",this.item=a,this._blocking=!0}return g(a,e.Object),a.prototype.performWait=function(){return this._blocking&&(this._blocking=!!this.item,this._blocking||this.emit("end")),this._blocking},a}(),k=function(){function a(a){j.call(this,a),this.klassName="TaskWaitTokenNumber"}return g(a,j),a.prototype.performWait=function(a){return this._blocking&&(this.item-=a,this.item<=0&&(this._blocking=!1,this.emit("end"))),this._blocking},a}(),l=function(){function a(a){j.call(this,a),this.klassName="TaskWaitTokenFunction"}return g(a,j),a.prototype.performWait=function(){return this._blocking&&(this._blocking=!!this.item(),this._blocking||this.emit("end")),this._blocking},a}(),m=function(){function a(a){j.call(this,a),this.klassName="TaskWaitTokenBoolean"}return g(a,j),a.prototype.performWait=function(){return this._blocking&&(this._blocking=this.item,this._blocking||this.emit("end")),this._blocking},a}(),n=function(){function a(a){j.call(this,a),this.klassName="TaskWaitTokenBlock"}return g(a,j),a.prototype.performWait=function(a){return this._blocking&&(this._blocking=this.item.performWait(a),this._blocking||this.emit("end")),this._blocking},a}(),o=function(){function a(b){h.mixin(this),this.klassName="TaskWaitAND";var c=[];b.forEach(function(b){b instanceof a?c=c.concat(b.list):c.push(b)}),this.items=c,this._blocking=!0}return g(a,j),a.prototype.performWait=function(a){return this._blocking&&(this._blocking=this.items.reduce(function(b,c){return c.performWait(a)||b},!1)),this._blocking||this.emit("end"),this._blocking},a}(),p=function(){function a(b){h.mixin(this),this.klassName="TaskWaitOR";var c=[];b.forEach(function(b){b instanceof a?c=c.concat(b.list):c.push(b)}),this.items=c,this._blocking=!0}return g(a,j),a.prototype.performWait=function(a){return this._blocking&&(this._blocking=this.items.reduce(function(b,c){return c.performWait(a)&&b},!0),this._blocking||this.emit("end")),this._blocking},a}(),q=function(){function a(a){this.klassName="TaskContext",this.wait=function(b){var c=e.createTaskWaitToken(b);return a._queue.push(c),c},this.pause=function(){a.pause()},this.stop=function(){a.stop()}}return a}(),r=function(){function a(){h.mixin(this),this.klassName="Task",this._blocking=!0,this.timeline=e.timeline,this.context=e.createTaskContext(this),this._queue=[],this._bang=!1,this._index=0,this._prev=null,this._next=null}return g(a,e.Object),a.prototype.play=f.sync(function(){for(var a=this;null!==a._prev;)a=a._prev;a.timeline&&a.timeline.append(a),0===a._queue.length&&(a._bang=!0)}),a.prototype.pause=f.sync(function(){this.timeline&&this.timeline.remove(this),this._bang=!1}),a.prototype.stop=f.sync(function(){this.timeline&&this.timeline.remove(this),this._bang=!1,this.timeline=null,this._blocking=!1,this.emit("end"),this._next&&(this._next._prev=null,this._next.play(),this._next=null)}),a.prototype.performWait=function(){return this._blocking},a.prototype["do"]=function(a){var b=e.createTaskDo(a);return b._prev=this,this._next=b,b},a.prototype.loop=function(a){var b=e.createTasLoop(a);
return b._prev=this,this._next=b,b},a.prototype.each=function(a,b){var c=e.createTaskEach(a,b);return c._prev=this,this._next=c,c},a.prototype.timeout=function(a,b){var c=e.createTaskTimeout(a,b);return c._prev=this,this._next=c,c},a.prototype.interval=function(a,b){var c=e.createTaskInterval(a,b);return c._prev=this,this._next=c,c},a.prototype.push=function(a,b,c){"function"==typeof a?this._queue.push([a,null,c]):this._queue.push([b,a,c])},a.prototype.done=function(){},a.prototype.process=function(a){var b=this.timeline,c=this._queue,d=!1;do{this._bang&&(b._stack.push(this),this._execute(),this._index+=1,b._stack.pop(),this._bang=!1);var e=0;a:for(;e<c.length;){var f=c[e];if(Array.isArray(f))f[0].apply(f[1],f[2]);else if(f.performWait&&f.performWait(a))break a;e+=1}d=!1,e&&(c.splice(0,e),0===c.length&&(d=this.done()))}while(d)},a}(),s=function(){function a(a){r.call(this,a),this.klassName="TaskGlobal"}return g(a,r),a.prototype.play=function(){},a.prototype.pause=function(){},a.prototype.stop=function(){},a}(),t=function(){function a(a){if("function"!=typeof a)throw new TypeError("Task.do: First argument must be a Function.");r.call(this),this.klassName="TaskDo",this.func=a}return g(a,r),a.prototype._execute=function(){this.func.call(this.context,this._index)},a.prototype.done=function(){this.stop()},a}(),u=function(){function a(a){if("function"!=typeof a)throw new TypeError("Task.loop: First argument must be a Function.");t.call(this,a),this.klassName="TaskLoop"}return g(a,t),a.prototype.done=function(){this._bang=!0},a}(),v=function(){function a(a,b){if(!Array.isArray(a))throw new TypeError("Task.each: First argument must be an Array.");if("function"!=typeof b)throw new TypeError("Task.each: Second argument must be a Function.");r.call(this),this.klassName="TaskEach",this.list=a,this.func=b}return g(a,r),a.prototype._execute=function(){this._index<this.list.length&&this.func.call(this.context,this.list[this._index],this._index)},a.prototype.done=function(){this._index<this.list.length?this._bang=!0:this.stop()},a}(),w=function(){function a(a,b){if("number"!=typeof a)throw new TypeError("Task.timeout: First argument must be a Number.");if("function"!=typeof b)throw new TypeError("Task.timeout: Second argument must be a Function.");r.call(this),this.klassName="TaskTimeout",a=Math.max(0,a),isNaN(a)&&(a=0),this.func=b,this._queue.push(e.createTaskWaitToken(a))}return g(a,r),a.prototype._execute=function(){this.func.call(this.context,this._index)},a.prototype.done=function(){return 0===this._index?(this._bang=!0,!0):(this.stop(),void 0)},a}(),x=function(){function a(a,b){if("number"!=typeof a)throw new TypeError("Task.interval: First argument must be a Number.");if("function"!=typeof b)throw new TypeError("Task.interval: Second argument must be a Function.");w.call(this,a,b),this.klassName="TaskInterval"}return g(a,w),a.prototype.done=function(){return this._bang=!0,!0},a}(),y=function(){function a(a){this.klassName="TaskBlock","number"!=typeof a&&(a=1),this._count=a,this._blocking=!0}return a.prototype.lock=f.sync(function(a){"number"!=typeof a&&(a=1),this._count+=a}),a.prototype.free=f.sync(function(a){"number"!=typeof a&&(a=1),this._count-=a,this._count<=0&&(this._blocking=!1)}),a.prototype.performWait=function(){return this._blocking},a}();d.exports={Timeline:i,TaskWaitToken:j,TaskWaitTokenNumber:k,TaskWaitTokenFunction:l,TaskWaitTokenBoolean:m,TaskWaitTokenBlock:n,TaskWaitAND:o,TaskWaitOR:p,TaskContext:q,Task:r,TaskGlobal:s,TaskDo:t,TaskLoop:u,TaskEach:v,TaskTimeout:w,TaskInterval:x,TaskBlock:y,use:function(){e.createTimeline=function(){return e.timeline=new i,e.timeline},e.createTaskGlobal=function(a){return new s(a)},e.createTaskDo=function(a){return new t(a)},e.createTaskLoop=function(a){return new u(a)},e.createTaskEach=function(a,b){return new v(a,b)},e.createTaskTimeout=function(a,b){return new w(a,b)},e.createTaskInterval=function(a,b){return new x(a,b)},e.createTaskBlock=function(){return new y},e.createTaskContext=function(a){return new q(a)},e.createTaskWaitToken=function(a){if(a instanceof j)return a;switch(typeof a){case"number":return new k(a);case"function":return new l(a);case"boolean":return new m(a);default:if(a){if(Array.isArray(a))return e.createTaskWaitLogic("and",a);if("function"==typeof a.performWait)return new n(a)}}throw new TypeError("TaskWaitToken: Invalid type")},e.createTaskWaitLogic=function(a,b){return b=b.map(function(a){return e.createTaskWaitToken(a)}),"and"===a?new o(b):new p(b)},e.instanceOfWaitToken=function(a){return a instanceof j}},exports:function(){a.Task={"do":function(a){return e.createTaskDo(a)},loop:function(a){return e.createTaskLoop(a)},each:function(a,b){return e.createTaskEach(a,b)},timeout:function(a,b){return e.createTaskTimeout(a,b)},interval:function(a,b){return e.createTaskInterval(a,b)},block:function(){return e.createTaskBlock()}}}}}),e("cc/client/ugen/exports",function(a,b,c){b=function(){a("./ugen").exports(),a("./bufio").exports(),a("./line").exports(),a("./osc").exports(),a("./pan").exports(),a("./delay").exports(),a("./ui").exports()};var d=function(){a("./ugen").use(),a("./uop").use(),a("./bop").use(),a("./madd").use()};c.exports={use:d,exports:b}}),e("cc/client/ugen/bufio",function(a,b,c){var d=a("../cc"),e=[].slice,f=function(a){return function(b,c){if("number"!=typeof b)throw new TypeError("Buffer: arguments[0] should be an integer.");if(!d.instanceOfAudioBuffer(c))throw new TypeError("Buffer: arguments[1] should be a buffer.");return b=Math.max(0,0|b),this.init.apply(this,[a].concat(e.call(arguments,1))),this.specialIndex=c._bufId,this.initOutputs(b,this.rate)}},g={ar:{defaults:"numChannels=0,buffer,rate=1,trigger=1,startPos=0,loop=0,doneAction=0",ctor:f(2),Klass:d.MultiOutUGen},kr:{defaults:"numChannels=0,buffer,rate=1,trigger=1,startPos=0,loop=0,doneAction=0",ctor:f(1),Klass:d.MultiOutUGen}};c.exports={exports:function(){d.registerUGen("PlayBuf",g)}}}),e("cc/client/ugen/line",function(a,b,c){var d=a("../cc"),e={ar:{defaults:"start=0,end=1,dur=1,mul=1,add=0,doneAction=0",ctor:function(a,b,c,d,e,f){return this.init(2,a,b,c,f).madd(d,e)}},kr:{defaults:"start=0,end=1,dur=1,mul=1,add=0,doneAction=0",ctor:function(a,b,c,d,e,f){return this.init(1,a,b,c,f).madd(d,e)}}};c.exports={exports:function(){d.registerUGen("Line",e)}}}),e("cc/client/ugen/osc",function(a,b,c){var d=a("../cc"),e={ar:{defaults:"freq=440,phase=0,mul=1,add=0",ctor:function(a,b,c,d){return this.init(2,a,b).madd(c,d)}},kr:{defaults:"freq=440,phase=0,mul=1,add=0",ctor:function(a,b,c,d){return this.init(1,a,b).madd(c,d)}}};c.exports={exports:function(){d.registerUGen("SinOsc",e)}}}),e("cc/client/ugen/pan",function(a,b,c){var d=a("../cc"),e=function(a){return function(b,c,e){return this.init.call(this,a,b,c,e),this.channels=[d.createOutputProxy(this.rate,this,0),d.createOutputProxy(this.rate,this,1)],this.numOfOutputs=2,this.channels}},f={ar:{defaults:"in=0,pos=0,level=1",ctor:e(2),Klass:d.MultiOutUGen},kr:{defaults:"in=0,pos=0,level=1",ctor:e(1),Klass:d.MultiOutUGen}};c.exports={exports:function(){d.registerUGen("Pan2",f)}}}),e("cc/client/ugen/delay",function(a,b,c){var d=a("../cc"),e={ar:{defaults:"in=0,maxdelaytime=0.2,delaytime=0.2,decaytime=1,mul=1,add=0",ctor:function(a,b,c,d,e,f){return this.init(2,a,b,c,d).madd(e,f)}},kr:{defaults:"in=0,maxdelaytime=0.2,delaytime=0.2,decaytime=1,mul=1,add=0",ctor:function(a,b,c,d,e,f){return this.init(2,a,b,c,d).madd(e,f)}}};c.exports={exports:function(){d.registerUGen("CombN",e),d.registerUGen("CombL",e),d.registerUGen("CombC",e)}}}),e("cc/client/ugen/ui",function(a,b,c){var d=a("../cc"),e={kr:{defaults:"minval=0,maxval=1,warp=0,lag=0.2",ctor:function(a,b,c,d){return"exponential"===c?c=1:"number"!=typeof c&&(c=0),this.init(1,a,b,c,d)}}},f={kr:{defaults:"minval=0,maxval=1,lag=0.2",ctor:function(a,b,c){return this.init(1,a,b,c)}}};c.exports={exports:function(){d.registerUGen("MouseX",e),d.registerUGen("MouseY",e),d.registerUGen("MouseButton",f)}}}),e("cc/client/ugen/uop",function(a,b,c){var d=a("../cc"),e=a("../../common/extend"),f=a("../../common/ops"),g=function(){function a(){d.UGen.call(this,"UnaryOpUGen")}return e(a,d.UGen),a.prototype.init=function(a,b){var c=f.UNARY_OP_UGEN_MAP.indexOf(a);if(-1===c)throw new TypeError("UnaryOpUGen: unknown operator '"+a+"'");var e=0|b.rate;return d.UGen.prototype.init.call(this,e),this.op=a,this.specialIndex=c,this.inputs=[b],this.numOfInputs=1,this},a}();c.exports={use:function(){d.createUnaryOpUGen=function(a,b){return(new g).init(a,b)},d.instanceOfUnaryOpUGen=function(a){return a instanceof g}}}}),e("cc/common/ops",function(a,b,c){var d="num neg not tilde pi abs midicps cpsmidi ampdb dbamp coin".split(" "),e="+ - * / %".split(" ");c.exports={UNARY_OP_UGEN_MAP:d,BINARY_OP_UGEN_MAP:e}}),e("cc/client/ugen/bop",function(a,b,c){var d=a("../cc"),e=a("../../common/extend"),f=a("../../common/ops"),g=a("../utils"),h=function(){function a(){d.UGen.call(this,"BinaryOpUGen")}return e(a,d.UGen),a.prototype.init=function(a,b,c){if("-"===a&&"number"==typeof c&&(a="+",c=-c),"/"===a&&"number"==typeof c&&(a="*",c=1/c),"*"===a)return"number"==typeof b&&"number"==typeof c?b*c:0===b||0===c?0:j(b,c);if("+"===a){if("number"==typeof b&&"number"==typeof c)return b+c;if(0===b)return c;if(0===c)return b;if(d.instanceOfBinaryOpUGen(b)){if("*"===b.op)return d.createMulAdd(b.inputs[0],b.inputs[1],c)}else if(d.instancrOfMulAdd(b))return"number"==typeof b.inputs[2]&&"number"==typeof c?0===b.inputs[2]+c?d.createBinaryOpUGen("*!",b.inputs[0],b.inputs[1]):(b.inputs[2]+=c,b):(c=d.createBinaryOpUGen("+",b.inputs[2],c),b=d.createBinaryOpUGen("*!",b.inputs[0],b.inputs[1]),d.createBinaryOpUGen("+",b,c));return i(b,c)}"+!"===a?a="+":"*!"===a&&(a="*");var e=f.BINARY_OP_UGEN_MAP.indexOf(a);if(-1===e)throw new TypeError("BinaryOpUGen: unknown operator '"+a+"'");var g=Math.max(0|b.rate,0|c.rate);return d.UGen.prototype.init.call(this,g),this.op=a,this.specialIndex=e,this.inputs=[b,c],this.numOfInputs=2,this},a}(),i=function(){var a=function(b){if("number"==typeof b)return b;var c=b.inputs;return d.instanceOfBinaryOpUGen(b)&&"+"===b.op?[a(c[0]),a(c[1])]:d.instanceOfSum3(b)?[a(c[0]),a(c[1]),a(c[2])]:d.instanceOfSum4(b)?[a(c[0]),a(c[1]),a(c[2]),a(c[3])]:b},b=function(a){switch(a=a.map(function(a){switch(a.length){case 4:return d.createSum4(a[0],a[1],a[2],a[3]);case 3:return d.createSum3(a[0],a[1],a[2]);case 2:return d.createBinaryOpUGen("+!",a[0],a[1]);case 1:return a[0]}}),a.length){case 4:return d.createSum4(a[0],a[1],a[2],a[3]);case 3:return d.createSum4(a[0],a[1],a[2]);case 2:return d.createBinaryOpUGen("+!",a[0],a[1]);case 1:return a[0];default:return b(g.clump(a,4))}};return function(c,e){var f=g.flatten([a(c),a(e)]),h=0;return f=f.filter(function(a){return"number"==typeof a?(h+=a,!1):!0}),0!==h&&f.push(h),f=g.clump(f,4),1===f.length&&2===f[0].length?d.createBinaryOpUGen("+!",f[0][0],f[0][1]):b(f)}}(),j=function(){var a=function(b){if("number"==typeof b)return b;var c=b.inputs;return d.instanceOfBinaryOpUGen(b)&&"*"===b.op?[a(c[0]),a(c[1])]:b},b=function(a){switch(a=a.map(function(a){return 2===a.length?d.createBinaryOpUGen("*!",a[0],a[1]):a[0]}),a.length){case 2:return d.createBinaryOpUGen("*!",a[0],a[1]);case 1:return a[0];default:return b(g.clump(a,2))}};return function(c,e){var f=g.flatten([a(c),a(e)]),h=1;return f=f.filter(function(a){return"number"==typeof a?(h*=a,!1):!0}),1!==h&&f.push(h),f=g.clump(f,2),1===f.length&&2===f[0].length?d.createBinaryOpUGen("*!",f[0][0],f[0][1]):b(f)}}();c.exports={use:function(){d.createBinaryOpUGen=function(a,b,c){return(new h).init(a,b,c)},d.instanceOfBinaryOpUGen=function(a){return a instanceof h}}}}),e("cc/client/ugen/madd",function(a,b,c){var d=a("../cc"),e=a("../../common/extend"),f=function(a){return Array.isArray(a)?a.reduce(function(a,b){return Math.max(a,f(b))},0):a&&a.rate||0},g=function(){function a(){d.UGen.call(this,"MulAdd")}e(a,d.UGen),a.prototype.init=function(a,c,e){var g,h,i,j,k;return a.rate-c.rate<0&&(g=a,a=c,c=g),0===c?e:(h=-1===c,i=1===c,j=0===e,i&&j?a:h&&j?d.createBinaryOpUGen("*",a,-1):j?d.createBinaryOpUGen("*",a,c):h?d.createBinaryOpUGen("-",e,a):i?d.createBinaryOpUGen("+",a,e):b(a,c,e)?(k=f([a,c,e]),d.UGen.prototype.init.apply(this,[k,a,c,e])):b(c,a,e)?(k=f([c,a,e]),d.UGen.prototype.init.apply(this,[k,c,a,e])):a*c+e)};var b=function(a,b,c){return a=f(a),b=f(b),c=f(c),2===a?!0:1!==a||1!==b&&0!==b||1!==c&&0!==c?!1:!0};return a}(),h=function(){function a(){d.UGen.call(this,"Sum3")}return e(a,d.UGen),a.prototype.init=function(a,b,c){if(0===a)return d.createBinaryOpUGen("+",b,c);if(0===b)return d.createBinaryOpUGen("+",a,c);if(0===c)return d.createBinaryOpUGen("+",a,b);var e=f([a,b,c]),g=[a,b,c].sort(function(a,b){return b.rate-a.rate});return d.UGen.prototype.init.apply(this,[e].concat(g))},a}(),i=function(){function a(){d.UGen.call(this,"Sum4")}return e(a,d.UGen),a.prototype.init=function(a,b,c,e){if(0===a)return d.createSum3(b,c,e);if(0===b)return d.createSum3(a,c,e);if(0===c)return d.createSum3(a,b,e);if(0===e)return d.createSum3(a,b,c);var g=f([a,b,c,e]),h=[a,b,c,e].sort(function(a,b){return b.rate-a.rate});return d.UGen.prototype.init.apply(this,[g].concat(h))},a}();c.exports={use:function(){d.createMulAdd=function(a,b,c){return(new g).init(a,b,c)},d.createSum3=function(a,b,c){return(new h).init(a,b,c)},d.createSum4=function(a,b,c,d){return(new i).init(a,b,c,d)},d.instanceOfMulAdd=function(a){return a instanceof g},d.instanceOfSum3=function(a){return a instanceof h},d.instanceOfSum4=function(a){return a instanceof i}}}}),e("cc/client/object",function(a,b,c){var d=a("./cc"),e=a("./fn"),f=a("./utils"),g=function(a,b){[d.Object,Array,Boolean,Date,Function,Number,String].forEach(function(c){e.definePrototypeProperty(c,a,b)})},h=function(a,b,c){c=c||a,[d.Object,Boolean,Date,Function,Number,String].forEach(function(c){e.definePrototypeProperty(c,a,b)}),e.definePrototypeProperty(Array,a,function(){return this.map(function(b){return b[a]()})}),e.definePrototypeProperty(d.UGen,a,function(){return d.createUnaryOpUGen(c,this)})},i=function(a,b){return function(c){return Array.isArray(c)?c.map(function(a){return this[b](a)},this):a(this,c)}},j=function(a,b,c){return function(e){return Array.isArray(e)?e.map(function(a){return this[b](a)},this):d.instanceOfUGen(e)?d.createBinaryOpUGen(c,this,e):a(this,e)}},k=function(a,b){return function(c){var e=this;return Array.isArray(c)?e.length===c.length?e.map(function(b,d){return b[a](c[d])}):e.length>c.length?e.map(function(b,d){return b[a](c[d%c.length])}):c.map(function(b,c){return e[c%e.length][a](b)}):d.instanceOfUGen(c)?e.map(function(a){return d.createBinaryOpUGen(b,a,c)}):e.map(function(b){return b[a](c)})}},l=function(a){return function(b){var c=this;return Array.isArray(b)?b.map(function(b){return d.createBinaryOpUGen(a,c,b)}):d.createBinaryOpUGen(a,c,b)}},m=function(a,b,c){c=c||a,[d.Object,Boolean,Date,Function,String].forEach(function(c){e.definePrototypeProperty(c,a,i(b,a))}),e.definePrototypeProperty(Number,a,j(b,a,c)),e.definePrototypeProperty(Array,a,k(a,c)),e.definePrototypeProperty(d.UGen,a,l(c))};c.exports={exports:function(){h("__plus__",function(){return+this},"+"),h("__minus__",function(){return-this},"-"),m("__add__",function(a,b){return a+b},"+"),m("__sub__",function(a,b){return a-b},"-"),m("__mul__",function(a,b){return a*b},"*"),e.definePrototypeProperty(String,"__mul__",function(a){if("number"==typeof a){for(var b=new Array(Math.max(0,a)),c=0;a>c;c++)b[c]=this;return b.join("")}return Array.isArray(a)?a.map(function(a){return this.__mul__(a)},this):this*a}),e.definePrototypeProperty(Function,"__mul__",function(a){if("function"==typeof a){var b=this,c=a;return function(){return b.call(null,c.apply(null,arguments))}}return Array.isArray(a)?a.map(function(){return 0/0}):this*a}),m("__div__",function(a,b){return a/b},"/"),e.definePrototypeProperty(String,"__div__",function(a){return"number"==typeof a?f.clump(this.split(""),Math.ceil(this.length/a)).map(function(a){return a.join("")}):Array.isArray(a)?a.map(function(a){return this.__div__(a)},this):this/a}),m("__mod__",function(a,b){return a%b},"%"),e.definePrototypeProperty(String,"__mod__",function(a){return"number"==typeof a?f.clump(this.split(""),0|a).map(function(a){return a.join("")}):Array.isArray(a)?a.map(function(a){return this.__mod__(a)},this):this%a}),g("__and__",function(a){return d.createTaskWaitLogic("and",[this].concat(a))}),e.definePrototypeProperty(Array,"__and__",function(a){return d.createTaskWaitLogic("and",this.concat(a))}),g("__or__",function(a){return d.createTaskWaitLogic("or",[this].concat(a))}),e.definePrototypeProperty(Array,"__or__",function(a){return d.createTaskWaitLogic("or",this.concat(a))}),g("to_i",function(){return 0|this}),e.definePrototypeProperty(Array,"to_i",function(){return this.map(function(a){return a.to_i()})}),g("to_f",function(){return+this}),e.definePrototypeProperty(Array,"to_f",function(){return this.map(function(a){return a.to_f()})}),g("to_s",function(){return this.toString()}),e.definePrototypeProperty(Array,"to_s",function(){return this.map(function(a){return a.to_s()})}),g("to_a",function(){return[this]}),e.definePrototypeProperty(Array,"to_a",function(){return this}),e.definePrototypeProperty(Number,"madd",e(function(a,b){return d.createMulAdd(this,a,b)}).defaults("mul=1,add=0").multiCall().build()),e.definePrototypeProperty(Array,"madd",e(function(a,b){return f.flop([this,a,b]).map(function(a){var b=a[0],c=a[1],e=a[2];return d.createMulAdd(b,c,e)})}).defaults("mul=1,add=0").multiCall().build())}}}),e("cc/client/number",function(a,b,c){var d=a("./cc"),e=a("./fn"),f=function(a,b){e.definePrototypeProperty(Number,a,b),e.definePrototypeProperty(Array,a,function(){return this.map(function(b){return b[a]()})}),e.definePrototypeProperty(d.UGen,a,function(){return d.createUnaryOpUGen(a,this)})};c.exports={exports:function(){f("pi",function(){return this*Math.PI}),f("abs",function(){return Math.abs(this)}),f("midicps",function(){return 440*Math.pow(2,1*(this-69)/12)}),f("cpsmidi",function(){return 12*Math.log(1*Math.abs(this)/440)*Math.LOG2E+69}),f("ampdb",function(){return 20*Math.log(this)*Math.LOG10E}),f("dbamp",function(){return Math.pow(10,.05*this)}),f("coin",function(){return Math.random()<this})}}}),e("cc/client/data",function(b,c,d){var e=b("./cc");d.exports={exports:function(){a.DATA={get:function(a){return e.DATA[a]||""}}}}}),e("cc/client/scale",function(b,c,d){var e=b("./cc"),f=b("./fn"),g=b("../common/extend"),h=function(a){return a.map(function(a){return 12*Math.log(a)*Math.LOG2E})},i=function(a){for(var b=new Array(a),c=0;a>=c;++c)b[c]=c;return b},j=function(){function a(a,b,c){this.klassName="Tuning",this._tuning=a,this._octaveRatio=b,this.name=c}return g(a,e.Object),a.prototype.semitones=function(){return this._tuning.slice()},a.prototype.cents=function(){return this._tuning.map(function(a){return 100*a})},a.prototype.ratios=function(){return this._tuning.map(function(a){return Math.pow(2,1*a/12)})},a.prototype.at=f(function(a){return this._tuning[a]}).multiCall().build(),a.prototype.wrapAt=f(function(a){return a%=this._tuning.length,0>a&&(a=this._tuning.length+a),this._tuning[a]}).multiCall().build(),a.prototype.octaveRatio=function(){return this._octaveRatio},a.prototype.size=function(){return this._tuning.length},a.prototype.stepsPerOctave=function(){return 12*Math.log(this._octaveRatio)*Math.LOG2E},a.prototype.tuning=function(){return this._tuning},a.prototype.equals=function(b){return b instanceof a&&this._octaveRatio===b._octaveRatio&&this._tuning.every(function(a,c){return a===b._tuning[c]},this)},a.prototype.copy=function(){return new a(this._tuning.slice(0),this._octaveRatio,this.name)},a}(),k={et12:[[0,1,2,3,4,5,6,7,8,9,10,11],2,"ET12"],pythagorean:[h([1,256/243,9/8,32/27,81/64,4/3,729/512,1.5,128/81,27/16,16/9,243/128]),2,"Pythagorean"],just:[h([1,16/15,9/8,1.2,5/4,4/3,45/32,1.5,1.6,5/3,1.8,15/8]),2,"Limit Just Intonation"],sept1:[h([1,16/15,9/8,1.2,5/4,4/3,1.4,1.5,1.6,5/3,1.8,15/8]),2,"Septimal Tritone Just Intonation"],sept2:[h([1,16/15,9/8,1.2,5/4,4/3,1.4,1.5,1.6,5/3,7/4,15/8]),2,"7-Limit Just Intonation"],mean4:[[0,.755,1.93,3.105,3.86,5.035,5.79,6.965,7.72,8.895,10.07,10.82],2,"Meantone, 1/4 Syntonic Comma"],mean5:[[0,.804,1.944,3.084,3.888,5.028,5.832,6.972,7.776,8.916,10.056,10.86],2,"Meantone, 1/5 Pythagorean Comma"],mean6:[[0,.86,1.96,3.06,3.92,5.02,5.88,6.98,7.84,8.94,10.04,10.9],2,"Meantone, 1/6 Pythagorean Comma"],kirnberger:[h([1,256/243,Math.sqrt(5)/2,32/27,5/4,4/3,45/32,Math.pow(5,.25),128/81,Math.pow(5,.75)/2,16/9,15/8]),2,"Kirnberger III"],werckmeister:[[0,.92,1.93,2.94,3.915,4.98,5.9,6.965,7.93,8.895,9.96,10.935],2,"Werckmeister III"],vallotti:[[0,.94135,1.9609,2.98045,3.9218,5.01955,5.9218,6.98045,7.9609,8.94135,10,10.90225],2,"Vallotti"],young:[[0,.9,1.96,2.94,3.92,4.98,5.88,6.98,7.92,8.94,9.96,10.9],2,"Young"],reinhard:[h([1,14/13,13/12,16/13,1.3,18/13,13/9,20/13,13/8,22/13,13/7,208/105]),2,"Mayumi Reinhard"],wcHarm:[h([1,17/16,9/8,19/16,5/4,21/16,11/8,1.5,13/8,27/16,7/4,15/8]),2,"Wendy Carlos Harmonic"],wcSJ:[h([1,17/16,9/8,1.2,5/4,4/3,11/8,1.5,13/8,5/3,7/4,15/8]),2,"Wendy Carlos Super Just"],lu:[h([1,2187/2048,9/8,19683/16384,81/64,177147/131072,729/612,1.5,6561/4096,27/16,59049/32768,243/128]),2,"Chinese Shi-er-lu scale"],et19:[i(18).map(function(a){return 12*a/19}),2,"ET19"],et22:[i(22).map(function(a){return 12*a/22}),2,"ET22"],et24:[i(24).map(function(a){return 12*a/24}),2,"ET24"],et31:[i(31).map(function(a){return 12*a/31}),2,"ET31"],et41:[i(41).map(function(a){return 12*a/41}),2,"ET41"],et53:[i(53).map(function(a){return 12*a/53}),2,"ET53"],johnston:[h([1,25/24,135/128,16/15,10/9,9/8,75/64,1.2,5/4,81/64,1.28,4/3,1.35,45/32,1.44,1.5,25/16,1.6,5/3,27/16,225/128,16/9,1.8,15/8,1.92]),2,"Ben Johnston"],partch:[h([1,81/80,33/32,1.05,16/15,12/11,1.1,10/9,9/8,8/7,7/6,32/27,1.2,11/9,5/4,14/11,9/7,21/16,4/3,1.35,11/8,1.4,10/7,16/11,40/27,1.5,32/21,14/9,11/7,1.6,18/11,5/3,27/16,12/7,7/4,16/9,1.8,20/11,11/6,15/8,40/21,64/33,160/81]),2,"Harry Partch"],catler:[h([1,33/32,16/15,9/8,8/7,7/6,1.2,128/105,16/13,5/4,21/16,4/3,11/8,45/32,16/11,1.5,1.6,13/8,5/3,27/16,7/4,16/9,24/13,15/8]),2,"Jon Catler"],chalmers:[h([1,1.05,16/15,9/8,7/6,1.2,5/4,21/16,4/3,1.4,35/24,1.5,1.575,1.6,5/3,7/4,1.8,28/15,63/32]),2,"John Chalmers"],harrison:[h([1,16/15,10/9,8/7,7/6,1.2,5/4,4/3,17/12,1.5,1.6,5/3,12/7,7/4,1.8,15/8]),2,"Lou Harrison"],sruti:[h([1,256/243,16/15,10/9,9/8,32/27,1.2,5/4,81/64,4/3,1.35,45/32,729/512,1.5,128/81,1.6,5/3,27/16,16/9,1.8,15/8,243/128]),2,"Sruti"],parret:[h([1,1.05,35/32,9/8,7/6,1.2,5/4,21/16,4/3,1.4,35/24,1.5,1.575,1.6,5/3,7/4,1.8,15/8,63/32]),2,"Wilfrid Perret"],michael_harrison:[h([1,28/27,135/128,16/15,243/224,9/8,8/7,7/6,32/27,1.2,135/112,5/4,81/64,9/7,21/16,4/3,112/81,45/32,64/45,81/56,1.5,32/21,14/9,128/81,1.6,224/135,5/3,27/16,12/7,7/4,16/9,15/8,243/128,27/14]),2,"Michael Harrison 24 tone 7-limit"],harmonic:[h(i(24).slice(1)),2,"Harmonic Series 24"],bp:[h(i(12).map(function(a){return 19.019550008654*a/13})),3,"Bohlen-Pierce"],wcAlpha:[i(14).map(function(a){return.78*a}),1.9656411970852,"Wendy Carlos Alpha"],wcBeta:[i(18).map(function(a){return.638*a}),2.0141437696805,"Wendy Carlos Beta"],wcGamma:[i(33).map(function(a){return.351*a}),1.9923898962606,"Wendy Carlos Gamma"]},l=f(function(a,b,c){return Array.isArray(a)||(a=[0,1,2,3,4,5,6,7,8,9,10,11]),"number"!=typeof b&&(b=2),"string"!=typeof c&&(c="Unknown Tuning"),new j(a,b,c)}).defaults("tuning,octaveRatio,name").build(),m={};Object.keys(k).forEach(function(a){var b=k[a];m[a]=new j(b[0],b[1],b[2]),l[a]=m[a]}),l.at=function(a){var b=m[a];return b&&(b=b.copy()),b},l.choose=f(function(a){"number"!=typeof a&&(a=12);for(var b,c=[],d=Object.keys(m),e=0,f=d.length;f>e;++e)b=m[d[e]],b._tuning.length===a&&c.push(b);return b=c[0|Math.random()*c.length],b?b.copy():void 0}).multiCall().build(),l.et=function(a){for(var b=new Array(a),c=0;a>c;++c)b[c]=c*(12/a);return new j(b,2,"ET"+a)},l.names=function(){return Object.keys(m).sort()};var n=function(){function a(a,b,c,d){this.klassName="Scale",this._degrees=a,this._pitchesPerOctave=b,this.name=d,this.tuning(c)}g(a,e.Object),a.prototype.tuning=function(a){if(0===arguments.length)return this._tuning;if(null===a?a=l["default"](this._pitchesPerOctave):"string"==typeof a&&(a=m[a]),!(a instanceof j))throw new TypeError("Scale: arguments[2] should be a tuning.");if(this._pitchesPerOctave!==a.size())throw new TypeError("Scale steps per octave "+this._pitchesPerOctave+" does not match tuning size.");return this._tuning=a,a},a.prototype.semitones=function(){return this._degrees.map(function(a){return this._tuning.wrapAt(a)},this)},a.prototype.cents=function(){return this.semitones().map(function(a){return 100*a})},a.prototype.ratios=function(){return this.semitones().map(function(a){return Math.pow(2,1*a/12)})},a.prototype.size=function(){return this._degrees.length},a.prototype.pitchesPerOctave=function(){return this._pitchesPerOctave},a.prototype.stepsPerOctave=function(){return 12*Math.log(this.octaveRatio())*Math.LOG2E},a.prototype.at=f(function(a){return a%=this._degrees.length,0>a&&(a=this._degrees.length+a),this._tuning.at(this._degrees[a])}).multiCall().build(),a.prototype.wrapAt=f(function(a){return a%=this._degrees.length,0>a&&(a=this._degrees.length+a),this._tuning.wrapAt(this._degrees[a])}).multiCall().build(),a.prototype.degreeToFreq=f(function(a,c,d){return b(this,a,d)*c}).defaults("degree=0,rootFreq=0,octave=0").multiCall().build(),a.prototype.degreeToRatio=f(function(a,c){return b(this,a,c)}).defaults("degree=0,octave=0").multiCall().build(),a.prototype.degrees=function(){return this._degrees},a.prototype.octaveRatio=function(){return this._tuning.octaveRatio()},a.prototype.equals=function(b){return b instanceof a&&this._degrees.every(function(a,c){return a===b._degrees[c]})&&this._tuning.equals(b._tuning)},a.prototype.copy=function(){return new a(this._degrees.slice(),this._pitchesPerOctave,this._tuning.copy(),this.name)};var b=function(a,b,c){c+=0|b/a._degrees.length;var d=a.ratios(),e=b%d.length;return 0>e&&(e=d.length+e),d[e]*Math.pow(a.octaveRatio(),c)};return a}(),o=function(a){var b,c=a[0]||0;for(b=a.length;b--;)c<a[b]&&(c=a[b]);var d=[53,24,19,12];for(b=d.length;b--;)if(c<d[b])return d[b];return 128},p={major:[[0,2,4,5,7,9,11],12,0,"Major"],minor:[[0,2,3,5,7,8,10],12,0,"Natural Minor"],minorPentatonic:[[0,3,5,7,10],12,0,"Minor Pentatonic"],majorPentatonic:[[0,2,4,7,9],12,0,"Major Pentatonic"],ritusen:[[0,2,5,7,9],12,0,"Ritusen"],egyptian:[[0,2,5,7,10],12,0,"Egyptian"],kumoi:[[0,2,3,7,9],12,0,"Kumoi"],hirajoshi:[[0,2,3,7,8],12,0,"Hirajoshi"],iwato:[[0,1,5,6,10],12,0,"Iwato"],ryukyu:[[0,4,5,7,11],12,0,"Ryukyu"],chinese:[[0,4,6,7,11],12,0,"Chinese"],indian:[[0,4,5,7,10],12,0,"Indian"],pelog:[[0,1,3,7,8],12,0,"Pelog"],prometheus:[[0,2,4,6,11],12,0,"Prometheus"],scriabin:[[0,1,4,7,9],12,0,"Scriabin"],gong:[[0,2,4,7,9],12,0,"Gong"],shang:[[0,2,5,7,10],12,0,"Shang"],jiao:[[0,3,5,8,10],12,0,"Jiao"],zhi:[[0,2,5,7,9],12,0,"Zhi"],yu:[[0,3,5,7,10],12,0,"Yu"],whole:[[0,2,4,6,8,10],12,0,"Whole Tone"],augmented:[[0,3,4,7,8,11],12,0,"Augmented"],augmented2:[[0,1,4,5,8,9],12,0,"Augmented 2"],partch_o1:[[0,8,14,20,25,34],43,"partch","Partch Otonality 1"],partch_o2:[[0,7,13,18,27,35],43,"partch","Partch Otonality 2"],partch_o3:[[0,6,12,21,29,36],43,"partch","Partch Otonality 3"],partch_o4:[[0,5,15,23,30,37],43,"partch","Partch Otonality 4"],partch_o5:[[0,10,18,25,31,38],43,"partch","Partch Otonality 5"],partch_o6:[[0,9,16,22,28,33],43,"partch","Partch Otonality 6"],partch_u1:[[0,9,18,23,29,35],43,"partch","Partch Utonality 1"],partch_u2:[[0,8,16,25,30,36],43,"partch","Partch Utonality 2"],partch_u3:[[0,7,14,22,31,37],43,"partch","Partch Utonality 3"],partch_u4:[[0,6,13,20,28,38],43,"partch","Partch Utonality 4"],partch_u5:[[0,5,12,18,25,33],43,"partch","Partch Utonality 5"],partch_u6:[[0,10,15,21,27,34],43,"partch","Partch Utonality 6"],hexMajor7:[[0,2,4,7,9,11],12,0,"Hex Major 7"],hexDorian:[[0,2,3,5,7,10],12,0,"Hex Dorian"],hexPhrygian:[[0,1,3,5,8,10],12,0,"Hex Phrygian"],hexSus:[[0,2,5,7,9,10],12,0,"Hex Sus"],hexMajor6:[[0,2,4,5,7,9],12,0,"Hex Major 6"],hexAeolian:[[0,3,5,7,8,10],12,0,"Hex Aeolian"],ionian:[[0,2,4,5,7,9,11],12,0,"Ionian"],dorian:[[0,2,3,5,7,9,10],12,0,"Dorian"],phrygian:[[0,1,3,5,7,8,10],12,0,"Phrygian"],lydian:[[0,2,4,6,7,9,11],12,0,"Lydian"],mixolydian:[[0,2,4,5,7,9,10],12,0,"Mixolydian"],aeolian:[[0,2,3,5,7,8,10],12,0,"Aeolian"],locrian:[[0,1,3,5,6,8,10],12,0,"Locrian"],harmonicMinor:[[0,2,3,5,7,8,11],12,0,"Harmonic Minor"],harmonicMajor:[[0,2,4,5,7,8,11],12,0,"Harmonic Major"],melodicMinor:[[0,2,3,5,7,9,11],12,0,"Melodic Minor"],melodicMinorDesc:[[0,2,3,5,7,8,10],12,0,"Melodic Minor Descending"],melodicMajor:[[0,2,4,5,7,8,10],12,0,"Melodic Major"],bartok:[[0,2,4,5,7,8,10],12,0,"Bartok"],hindu:[[0,2,4,5,7,8,10],12,0,"Hindu"],todi:[[0,1,3,6,7,8,11],12,0,"Todi"],purvi:[[0,1,4,6,7,8,11],12,0,"Purvi"],marva:[[0,1,4,6,7,9,11],12,0,"Marva"],bhairav:[[0,1,4,5,7,8,11],12,0,"Bhairav"],ahirbhairav:[[0,1,4,5,7,9,10],12,0,"Ahirbhairav"],superLocrian:[[0,1,3,4,6,8,10],12,0,"Super Locrian"],romanianMinor:[[0,2,3,6,7,9,10],12,0,"Romanian Minor"],hungarianMinor:[[0,2,3,6,7,8,11],12,0,"Hungarian Minor"],neapolitanMinor:[[0,1,3,5,7,8,11],12,0,"Neapolitan Minor"],enigmatic:[[0,1,4,6,8,10,11],12,0,"Enigmatic"],spanish:[[0,1,4,5,7,8,10],12,0,"Spanish"],leadingWhole:[[0,2,4,6,8,10,11],12,0,"Leading Whole Tone"],lydianMinor:[[0,2,4,6,7,8,10],12,0,"Lydian Minor"],neapolitanMajor:[[0,1,3,5,7,9,11],12,0,"Neapolitan Major"],locrianMajor:[[0,2,4,5,6,8,10],12,0,"Locrian Major"],diminished:[[0,1,3,4,6,7,9,10],12,0,"Diminished"],diminished2:[[0,2,3,5,6,8,9,11],12,0,"Diminished 2"],chromatic:[[0,1,2,3,4,5,6,7,8,9,10,11],12,0,"Chromatic"],chromatic24:[i(23),24,0,"Chromatic 24"],ajam:[[0,4,8,10,14,18,22],24,0,"Ajam"],jiharkah:[[0,4,8,10,14,18,21],24,0,"Jiharkah"],shawqAfza:[[0,4,8,10,14,16,22],24,0,"Shawq Afza"],sikah:[[0,3,7,11,14,17,21],24,0,"Sikah"],sikahDesc:[[0,3,7,11,13,17,21],24,0,"Sikah Descending"],huzam:[[0,3,7,9,15,17,21],24,0,"Huzam"],iraq:[[0,3,7,10,13,17,21],24,0,"Iraq"],bastanikar:[[0,3,7,10,13,15,21],24,0,"Bastanikar"],mustar:[[0,5,7,11,13,17,21],24,0,"Mustar"],bayati:[[0,3,6,10,14,16,20],24,0,"Bayati"],karjighar:[[0,3,6,10,12,18,20],24,0,"Karjighar"],husseini:[[0,3,6,10,14,17,21],24,0,"Husseini"],nahawand:[[0,4,6,10,14,16,22],24,0,"Nahawand"],nahawandDesc:[[0,4,6,10,14,16,20],24,0,"Nahawand Descending"],farahfaza:[[0,4,6,10,14,16,20],24,0,"Farahfaza"],murassah:[[0,4,6,10,12,18,20],24,0,"Murassah"],ushaqMashri:[[0,4,6,10,14,17,21],24,0,"Ushaq Mashri"],rast:[[0,4,7,10,14,18,21],24,0,"Rast"],rastDesc:[[0,4,7,10,14,18,20],24,0,"Rast Descending"],suznak:[[0,4,7,10,14,16,22],24,0,"Suznak"],nairuz:[[0,4,7,10,14,17,20],24,0,"Nairuz"],yakah:[[0,4,7,10,14,18,21],24,0,"Yakah"],yakahDesc:[[0,4,7,10,14,18,20],24,0,"Yakah Descending"],mahur:[[0,4,7,10,14,18,22],24,0,"Mahur"],hijaz:[[0,2,8,10,14,17,20],24,0,"Hijaz"],hijazDesc:[[0,2,8,10,14,16,20],24,0,"Hijaz Descending"],zanjaran:[[0,2,8,10,14,16,22],24,0,"Zanjaran"],saba:[[0,3,6,8,12,16,20],24,0,"Saba"],zamzam:[[0,2,6,8,14,16,20],24,0,"Zamzam"],kurd:[[0,2,6,10,14,16,20],24,0,"Kurd"],kijazKarKurd:[[0,2,8,10,14,16,22],24,0,"Kijaz Kar Kurd"],nawaAthar:[[0,4,6,12,14,16,22],24,0,"Nawa Athar"],nikriz:[[0,4,6,12,14,18,20],24,0,"Nikriz"],atharKurd:[[0,2,6,12,14,16,22],24,0,"Athar Kurd"]},q=f(function(a,b,c,d){return Array.isArray(a)||(a=[0,2,4,5,7,9,11]),"number"!=typeof b&&(b=o(a)),"string"==typeof c&&(c=m[c]),c instanceof j||(c=m.et12),"string"!=typeof d&&(d="Unknown Scale"),new n(a,b,c,d)}).defaults("degrees,pitchesPerOctave,tuning,name").build(),r={};Object.keys(p).forEach(function(a){var b=p[a];b[2]=b[2]?m[b[2]].copy():l.et(b[1]),r[a]=new n(b[0],b[1],b[2],b[3]),q[a]=r[a]}),q.at=function(a,b){var c=r[a];return c&&(c=c.copy(),b&&c.tuning(b)),c},q.choose=f(function(a,b){"number"!=typeof a&&(a=7),"number"!=typeof b&&(b=12);for(var c,d=[],e=Object.keys(r),f=0,g=e.length;g>f;++f)c=r[e[f]],c._degrees.length===a&&c._pitchesPerOctave===b&&d.push(c);
return c=d[0|Math.random()*d.length],c?c.copy():void 0}).multiCall().build(),q.names=function(){return Object.keys(r).sort()},d.exports={Scale:n,Tuning:j,exports:function(){a.Scale=q,a.Tuning=l}}}),e("cc/exports/coffeecollider",function(a,b,c){var d=a("../cc"),e=a("../common/extend"),f=a("../common/emitter"),g=a("../common/pack").unpack,h={},i=[].slice,j=function(){function a(a){if(f.mixin(this),a=a||{},this.version=d.version,a.socket){var b=d.createCoffeeColliderSocketImpl(this,a);this.impl=b,this.socket={open:function(){b.sendToClient(["/socket/open"])},close:function(){b.sendToClient(["/socket/close"])},send:function(a){b.sendToClient(["/socket/sendToServer",a])}},d.opmode="socket"}else a.iframe?(this.impl=d.createCoffeeColliderIFrameImpl(this,a),d.opmode="iframe"):(this.impl=d.createCoffeeColliderWorkerImpl(this,a),d.opmode="worker");this.sampleRate=this.impl.sampleRate,this.channels=this.impl.channels}return a.prototype.play=function(){return this.impl.play(),this},a.prototype.pause=function(){return this.impl.pause(),this},a.prototype.reset=function(){return this.impl.reset(),this},a.prototype.execute=function(){return this.impl.execute.apply(this.impl,arguments),this},a.prototype.getStream=function(){return this.impl.getStream()},a.prototype.importScripts=function(){return this.impl.importScripts(i.call(arguments)),this},a.prototype.getWebAudioComponents=function(){return this.impl.getWebAudioComponents()},a}(),k=function(){function a(a,b){var c=this;this.exports=a,this.compiler=d.createCompiler("coffee"),this.isPlaying=!1,this.execId=0,this.execCallbacks={},this.sampleRate=44100,this.channels=2,this.api=d.createAudioAPI(this,b),this.sampleRate=this.api.sampleRate,this.channels=this.api.channels,this.strm=new Int16Array(this.strmLength*this.channels),this.clear=new Int16Array(this.strmLength*this.channels),this.strmList=new Array(8),this.strmListReadIndex=0,this.strmListWriteIndex=0,this.speaker=b.speaker!==!1,this.api.init();var e=new Uint8Array(12);if("undefined"!=typeof window&&b.mouse!==!1){var f=new Float32Array(e.buffer);window.addEventListener("mousemove",function(a){f[1]=a.pageX/window.innerWidth,f[2]=a.pageY/window.innerHeight,c.syncItemsChanged=!0},!1),window.addEventListener("mousedown",function(){e[3]=1,c.syncItemsChanged=!0},!1),window.addEventListener("mouseup",function(){e[3]=0,c.syncItemsChanged=!0},!1)}this.syncItems=e}return a.prototype.play=function(){if(!this.isPlaying){this.isPlaying=!0;for(var a=this.strm,b=0,c=a.length;c>b;++b)a[b]=0;this.strmList.splice(0),this.strmListReadIndex=0,this.strmListWriteIndex=0,this.api.play(),this.sendToClient(["/play"]),this.exports.emit("play")}},a.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,this.api.pause(),this.sendToClient(["/pause"]),this.exports.emit("pause"))},a.prototype.reset=function(){this.execId=0,this.execCallbacks={};for(var a=this.strm,b=0,c=a.length;c>b;++b)a[b]=0;this.strmList.splice(0),this.strmListReadIndex=0,this.strmListWriteIndex=0,this.sendToClient(["/reset"]),this.exports.emit("reset")},a.prototype.process=function(){var a=this.strmList[this.strmListReadIndex];a&&(this.strmListReadIndex=7&this.strmListReadIndex+1,this.strm.set(a)),this.syncItemsChanged&&(this.sendToClient(this.syncItems),this.syncItemsChanged=!1)},a.prototype.execute=function(a){var b,c,d=1;b="boolean"==typeof arguments[d]?arguments[d++]:!1,"function"==typeof arguments[d]&&(c=arguments[d++]),"string"==typeof a&&(a=this.compiler.compile(a.trim()),this.sendToClient(["/execute",this.execId,a,b,this.compiler.data,!!c]),c&&(this.execCallbacks[this.execId]=c),this.execId+=1)},a.prototype.getStream=function(){for(var a=new Float32Array(this.strm),b=a.length;b--;)a[b]*=30517578125e-15;var c=this.strmLength;return{getChannelData:function(b){return 0===b?new Float32Array(a.buffer,0,c):1===b?new Float32Array(a.buffer,4*c):void 0}}},a.prototype.importScripts=function(a){this.sendToClient(["/importScripts",a])},a.prototype.sendToClient=function(a){this.client&&this.client.postMessage(a)},a.prototype.recvFromClient=function(a){if(a instanceof Int16Array)this.strmList[this.strmListWriteIndex]=a,this.strmListWriteIndex=7&this.strmListWriteIndex+1;else{var b=h[a[0]];if(!b)throw new Error("Unknown command: "+a[0]);b.call(this,a)}},a.prototype.readAudioFile=function(a,b){var c=this.api;if("string"!=typeof a)throw new TypeError("readAudioFile: first argument must be a String.");if("function"!=typeof b)throw new TypeError("readAudioFile: second argument must be a Function.");if(!c.decodeAudioFile)return b("Audio decoding not supported",null),void 0;var e=d.createXMLHttpRequest();e.open("GET",a),e.responseType="arraybuffer",e.onreadystatechange=function(){4===e.readyState&&(200===e.status&&e.response?c.decodeAudioFile(e.response,function(a,c){b(a,c)}):b("error",null))},e.send()},a.prototype.getWebAudioComponents=function(){return"Web Audio API"===this.api.type?[this.api.context,this.api.jsNode]:[]},a}(),l=function(){function a(a,b){this.strmLength=1024,this.bufLength=64,k.call(this,a,b);var c=this;this.client=d.createWebWorker(d.coffeeColliderPath),this.client.onmessage=function(a){c.recvFromClient(a.data)}}return e(a,k),a}(),m=function(){function a(a,b){this.strmLength=2048,this.bufLength=128,k.call(this,a,b);var c=this,e=this.iframe=d.createHTMLIFrameElement();e.sandbox="allow-scripts allow-same-origin",e.srcdoc="<script src='"+d.coffeeColliderPath+"#iframe'></script>";var f=d.createMessageChannel();e.onload=function(){e.contentWindow.postMessage(null,[f.port2],"*")},f.port1.onmessage=function(a){c.recvFromClient(a.data)},this.client=f.port1}return e(a,k),a}(),n=function(){function a(a,b){this.strmLength=4096,this.bufLength=128,k.call(this,a,b);var c=this,e=this.iframe=d.createHTMLIFrameElement();e.sandbox="allow-scripts",e.srcdoc="<script src='"+d.coffeeColliderPath+"#socket'></script>";var f=d.createMessageChannel();e.onload=function(){e.contentWindow.postMessage(b.socket,[f.port2],"*")},f.port1.onmessage=function(a){c.recvFromClient(a.data)},this.client=f.port1}return e(a,k),a}();h["/connected"]=function(){this.sendToClient(["/init",this.sampleRate,this.channels]),this.exports.emit("connected")},h["/executed"]=function(a){var b=a[1],c=a[2],d=this.execCallbacks[b];d&&(void 0!==c&&(c=g(c)),d(c),delete this.execCallbacks[b])},h["/buffer/request"]=function(a){var b=this,c=a[2];this.readAudioFile(a[1],function(a,d){a||b.sendToClient(["/buffer/response",d,c])})},h["/socket/sendToIF"]=function(a){this.exports.emit("message",a[1])},a("../common/console").bindConsoleApply(h);var o=function(){a("../common/browser").use(),a("../common/audioapi").use(),a("./compiler/compiler").use(),d.createCoffeeCollider=function(a){return new j(a)},d.createCoffeeColliderImpl=function(a,b){return new k(a,b)},d.createCoffeeColliderWorkerImpl=function(a,b){return new l(a,b)},d.createCoffeeColliderIFrameImpl=function(a,b){return new m(a,b)},d.createCoffeeColliderSocketImpl=function(a,b){return new n(a,b)}};c.exports={CoffeeCollider:j,use:o}}),e("cc/common/audioapi",function(b,c,d){var e,f=b("../cc");if("undefined"!=typeof document){var g=a.AudioContext||a.webkitAudioContext;g?e=function(){function a(a,b){this.sys=a,this.context=b.AudioContext||new g,this.sampleRate=this.context.sampleRate,this.channels=2,this.type="Web Audio API",this.delegate=!!b.AudioContext}return a.prototype.init=function(){var a,b=this.sys,c=b.strm,d=b.strmLength;this.sys.speaker?this.sys.sampleRate===this.sampleRate&&(a=function(a){var e=a.outputBuffer,f=e.getChannelData(0),g=e.getChannelData(1),h=d,i=d<<1;for(b.process();i--,h--;)f[h]=30517578125e-15*c[h],g[h]=30517578125e-15*c[i]}):a=function(){b.process()},this.bufSrc=this.context.createBufferSource(),this.jsNode=this.context.createScriptProcessor?this.context.createScriptProcessor(d,2,this.channels):this.context.createJavaScriptNode(d,2,this.channels),this.jsNode.onaudioprocess=a},a.prototype.play=function(){this.bufSrc&&(this.bufSrc.noteOn&&(this.bufSrc.noteOn(0),this.bufSrc.connect(this.jsNode)),this.delegate||this.jsNode.connect(this.context.destination))},a.prototype.pause=function(){this.bufSrc&&(this.bufSrc.disconnect(),this.delegate||this.jsNode.disconnect())},a.prototype.decodeAudioFile=function(a,b){a=this.context.createBuffer(a,!1);var c,d,e=a.length,f=a.numberOfChannels,g=e*f,h=new Float32Array(g),i=0,j=new Array(f);for(d=0;f>d;++d)j[d]=a.getChannelData(d);for(c=0;e>c;++c)for(d=0;f>d;++d)h[i++]=j[d][c];b(null,{sampleRate:a.sampleRate,numChannels:a.numberOfChannels,numFrames:a.length,samples:h})},a}():"function"==typeof Audio&&"function"==typeof(new Audio).mozSetup&&(e=function(){function a(a){this.sys=a,this.sampleRate=44100,this.channels=2,this.type="Audio Data API"}var b=function(){var a="var t=0;onmessage=function(e){if(t)t=clearInterval(t),0;if(typeof e.data=='number'&&e.data>0)t=setInterval(function(){postMessage(0);},e.data);};",b=new Blob([a],{type:"text/javascript"}),c=URL.createObjectURL(b);return new Worker(c)}();return a.prototype.init=function(){this.audio=new Audio,this.interleaved=new Float32Array(this.sys.strmLength*this.sys.channels)},a.prototype.play=function(){if(this.audio){var a=this.sys,c=this.audio,d=this.interleaved,e=1e3*(a.strmLength/a.sampleRate),f=0,g=Date.now(),h=new Int16Array(a.strm.buffer,0,a.strmLength),i=new Int16Array(a.strm.buffer,2*a.strmLength),j=function(){if(!(f>Date.now()-g)){var b=d.length,j=h.length;for(a.process();j--;)d[--b]=30517578125e-15*i[j],d[--b]=30517578125e-15*h[j];c.mozWriteAudio(d),f+=e}};c.mozSetup(a.channels,a.sampleRate),b.onmessage=j,b.postMessage(.8*e)}},a.prototype.pause=function(){this.audio&&b.postMessage(0)},a}()),e||(e=function(){function a(a){this.sys=a,this.sampleRate=44100,this.channels=2,this.type="Fallback"}a.prototype.init=function(){},a.prototype.play=function(){b.play&&(this.play=b.play,this.play())},a.prototype.pause=function(){b.pause&&(this.pause=b.pause,this.pause())};var b={};return window.addEventListener("load",function(){var a=f.rootPath+"coffee-collider-fallback.swf",c=a+"?"+Date.now(),d="coffee-collider-fallback",e=document.createElement("div");e.style.display="inline",e.width=1,e.height=1,e.innerHTML='<object id="'+d+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1"><param name="movie" value="'+c+'"/><param name="bgcolor" value="#FFFFFF"/><param name="quality" value="high"/><param name="allowScriptAccess" value="always"/></object>',document.body.appendChild(e),window.coffeecollider_flashfallback_init=function(){var a=document.getElementById(d),c=0;b.play=function(){if(0===c){var b=this.sys,d=1e3*(b.strmLength/b.sampleRate),e=0,f=Date.now(),g=new Array(b.strmLength*b.channels),h=g.length,i=function(){if(!(e>Date.now()-f)){b.process();for(var c=b.strm,i=0;h>i;++i)g[i]=String.fromCharCode((c[i]+32768>>1)+16384);a.writeAudio(g.join("")),e+=d}};c=setInterval(i,.8*d),a.play()}},b.pause=function(){0!==c&&(a.pause(),clearInterval(c),c=0)}}}),a}())}else"undefined"!=typeof a.GLOBAL&&(e=function(){function b(a){this.sys=a,this.sampleRate=44100,this.channels=2,this.node=null,this.isPlaying=!1}var c=a.require("stream").Readable,d=a.require("speaker");return c||(c=a.require("readable-stream/readable")),b.prototype.init=function(){},b.prototype.play=function(){var a=this.sys;this.isPlaying=!0,this.node=new c,this.node._read=function(b){var c,d,e,f=a._strm,g=a.strmLength,h=new Buffer(b),i=0;for(b=(b>>2)/a.strmLength,c=f;b--;)for(a._process(),d=0,e=g;g>d;++d,++e)h.writeInt16LE(f[d],i),i+=2,h.writeInt16LE(f[e],i),i+=2;this.push(h)},this.node.pipe(new d({sampleRate:this.sampleRate}))},b.prototype.pause=function(){this.node&&process.nextTick(this.node.emit.bind(this.node,"end")),this.node=null,this.isPlaying=!1},b}());d.exports={use:function(){f.createAudioAPI=function(a,b){return new e(a,b)}}}}),e("cc/exports/compiler/compiler",function(a,b,c){var d=a("../../cc"),e=function(){a("./coffee").use(),d.createCompiler=function(a){return"coffee"===a?d.createCoffeeCompiler():void 0}};c.exports={use:e}}),e("cc/exports/compiler/coffee",function(b,c,d){var e=b("../../cc"),f=function(){return a.CoffeeScript?a.CoffeeScript:a.require("coffee-script")}(),g=b("../../common/timevalue").calc,h=0,i=1,j={},k=function(a){var b=0;console.log(a.map(function(a){switch(a[0]){case"OUTDENT":case"CALL_END":case"PARAM_END":case"}":case"]":case")":b-=1}var c=l(b)+a[0]+"	"+a[1];switch(a[0]){case"(":case"[":case"{":case"PARAM_START":case"CALL_START":case"INDENT":b+=1}return c}).join("\n"))},l=function(a){for(var b="";a--;)b+="  ";return b},m=function(a,b){for(var c=0,d=0;b>0;){var e=a[b-1];if(!e||"."!==e[h])switch(e=a[b],e[h]){case"PARAM_START":return b;case"CALL_START":c-=1;break;case"(":case"[":case"{":c-=1;case"IDENTIFIER":case"NUMBER":case"STRING":case"BOOL":case"REGEX":case"NULL":case"UNDEFINED":if(0===d&&0===c){if(e=a[b-1]){if("UNARY"===e[h])return b-1;if("+"===e[i]||"-"===e[i]){if(e=a[b-2],!e)return b-1;switch(e[h]){case"INDENT":case"TERMINATOR":case"CALL_START":case"COMPOUND_ASSIGN":case"UNARY":case"LOGIC":case"SHIFT":case"COMPARE":case"=":case"..":case"...":case"[":case"(":case"{":case",":case"?":return b-1}}}return b}break;case"}":case"]":case")":case"PARAM_END":case"CALL_END":c+=1;break;case"INDENT":d+=1;break;case"OUTDENT":d-=1}b-=1}return 0},n=function(a,b){for(var c=0,d=0,e=!1;b<a.length;){var f=a[b];if(e)e="PARAM_END"!==f[h],b+=1;else{switch(f[h]){case"}":case"]":case")":case"CALL_END":c-=1;break;case"OUTDENT":d-=1;break;case"PARAM_START":e=!0,b+=1;continue}if(f=a[b+1],!f||"."!==f[h])switch(f=a[b],f[h]){case"TERMINATOR":if(0===d)return b-1;break;case"IDENTIFIER":if(f=a[b+1],f&&"CALL_START"===f[h]){c+=1;break}if(0===d&&0===c)return b;break;case"NUMBER":case"STRING":case"BOOL":case"REGEX":case"NULL":case"UNDEFINED":if(0===d&&0===c)return b;break;case"(":case"[":case"{":c+=1;break;case"}":case"]":case")":case"CALL_END":if(0===d&&0===c)return b;break;case"INDENT":d+=1;break;case"OUTDENT":if(0===d&&0===c)return b}b+=1}}return a.length-1},o=function(a){for(var b=a.length-1;b>=0;){var c=a[b];if("STRING"===c[h]&&'"'===c[i].charAt(0)){var d=g(c[i].substr(1,c[i].length-2));"number"==typeof d&&(c[h]="NUMBER",c[i]=d.toString())}b-=1}return a},p=function(a){for(var b=a.length-1;b>=0;){var c=a[b];if("MATH"===c[h]){var d=m(a,b),e=n(a,b)+1;a.splice(e,0,[")",")",j]),a.splice(d,0,["(","(",j])}b-=1}return a},q={"+":"__plus__","-":"__minus__"},r=function(a){for(var b=a.length-1;b>=0;){var c=a[b];if(q.hasOwnProperty(c[i])){var d=q[c[i]];switch(c=a[b-1]||{0:"TERMINATOR"},c[h]){case"INDENT":case"TERMINATOR":case"CALL_START":case"COMPOUND_ASSIGN":case"UNARY":case"LOGIC":case"SHIFT":case"COMPARE":case"=":case"..":case"...":case"[":case"(":case"{":case",":case"?":case"+":case"-":case":":var e=n(a,b);a.splice(e+1,0,[".",".",j]),a.splice(e+2,0,["IDENTIFIER",d,j]),a.splice(e+3,0,["CALL_START","(",j]),a.splice(e+4,0,["CALL_END",")",j]),a.splice(b,1)}}b-=1}return a},s={"+":"__add__","-":"__sub__","*":"__mul__","/":"__div__","%":"__mod__"},t=function(a){for(var b=0,c=!1;b<a.length;){var d=a[b];if(c&&s.hasOwnProperty(d[i])){var e=s[d[i]],f=n(a,b)+1;a.splice(b++,1,[".",".",j]),a.splice(b++,0,["IDENTIFIER",e,j]),a.splice(b,0,["CALL_START","(",j]),a.splice(f+2,0,["CALL_END",")",j]),c=!1}else{switch(d[h]){case"INDENT":case"TERMINATOR":case"CALL_START":case"COMPOUND_ASSIGN":case"UNARY":case"LOGIC":case"SHIFT":case"COMPARE":case"=":case"..":case"...":case"[":case"(":case"{":case",":case"?":c=!1;break;default:c=!0}b+=1}}return a},u={"&&":"__and__","||":"__or__"},v=function(a){for(var b=1,c=!1,d=0;b<a.length;){var e=a[b];if(c&&1===d&&u.hasOwnProperty(e[i])){var f=u[e[i]],g=n(a,b)+1;a.splice(b++,1,[".",".",j]),a.splice(b++,0,["IDENTIFIER",f,j]),a.splice(b++,0,["!CALL_START","(",j]),a.splice(g+2,0,["!CALL_END",")",j])}else{switch(e[h]){case"IDENTIFIER":"@"===a[b-1][h]&&"wait"===e[i]&&(c=!0,d=0);break;case"INDENT":case"TERMINATOR":c&&0===d&&(c=!1);break;case"{":case"PARAM_START":case"CALL_START":c&&(d+=1);break;case"CALL_END":case"PARAM_END":case"}":c&&(d-=1)}b+=1}}return a.forEach(function(a){"!"===a[h].charAt(0)&&(a[h]=a[h].substr(1))}),a},w={"+=":"__add__","-=":"__sub__","*=":"__mul__","/=":"__div__","%=":"__mod__"},x=function(a){for(var b=a.length-1;b>=0;){var c=a[b];if(w.hasOwnProperty(c[i])){var d=w[c[i]],e=m(a,b),f=n(a,b)+1;a[b]=["=","=",j],a.splice(b+1,0,[".",".",j]),a.splice(b+2,0,["IDENTIFIER",d,j]),a.splice(b+3,0,["CALL_START","(",j]),a.splice(f+3,0,["CALL_END",")",j]);for(var g=e;b>g;g++)a.splice(b+1,0,a[g])}b-=1}return a},y=function(){var a=function(a,b){for(var c=-1,d=-1,e=b+1;e<a.length;++e)if("PARAM_START"===a[e][h])c=e;else if("PARAM_END"===a[e][h]){d=e;break}var f="";return-1!==c&&(f=a.slice(c+1,d).map(function(a){return a[i]}).join("").replace(/"/g,"'")),f='"'+f+'"',{begin:c,end:d,replace:f}};return function(b){for(var c=b.length-1;c>=0;){if(b[c-2]&&"Synth"===b[c-2][i]&&"."===b[c-1][h]){var d=b[c];if("def"===d[i]&&(d=b[c+1],"CALL_START"===d[h])){var e=n(b,c+2),f=a(b,c+1);b.splice(++e,0,[",",",",j]),b.splice(++e,0,["STRING",f.replace,j])}}c-=1}return b}}(),z=function(a){for(var b=a.length-2;b>=0;){var c=a[b];if("IDENTIFIER"===c[h]&&"$"===c[i].charAt(0)){var d=c[i];/\d/.test(d.charAt(1))||(d=d.substr(1)),""!==d&&(c=a[b-1],c&&"."===c[h]||(a.splice(b,1,["IDENTIFIER","global",j]),a.splice(b+1,0,[".",".",j]),a.splice(b+2,0,["IDENTIFIER",d,j])))}b-=1}return a},A=function(a){for(var b=0,c=0;b<a.length;){var d=a[b];if("("===d[h]&&(d=a[b+1],d&&"("===d[h])){c=2;for(var e=b+2;e<a.length;e++)if(d=a[e][h],"("===d&&(c+=1),")"===d&&(c-=1,0===c)){")"===a[e-1][h]&&(a.splice(e,1),a.splice(b,1),b-=1);break}}b+=1}return a},B=function(a){a.splice(0,0,["(","(",j]),a.splice(1,0,["PARAM_START","(",j]),a.splice(2,0,["IDENTIFIER","global",j]),a.splice(3,0,["PARAM_END",")",j]),a.splice(4,0,["->","->",j]),a.splice(5,0,["INDENT",2,j]);var b=a.length-1;return a.splice(b++,0,["OUTDENT",2,j]),a.splice(b++,0,[")",")",j]),a.splice(b++,0,[".",".",j]),a.splice(b++,0,["IDENTIFIER","call",j]),a.splice(b++,0,["CALL_START","(",j]),a.splice(b++,0,["IDENTIFIER","_gltc_",j]),a.splice(b++,0,[",",",",j]),a.splice(b++,0,["THIS","this",j]),a.splice(b++,0,[".",".",j]),a.splice(b++,0,["IDENTIFIER","self",j]),a.splice(b++,0,["LOGIC","||",j]),a.splice(b++,0,["IDENTIFIER","global",j]),a.splice(b++,0,["CALL_END",")",j]),a},C=function(){function a(){}return a.prototype.tokens=function(a){var b=[],c=f.tokens(a);return c.length&&(c.forEach(function(a){"HERECOMMENT"===a[h]&&b.push(a[i].trim())}),c=o(c),c=r(c),c=p(c),c=t(c),c=v(c),c=x(c),c=y(c),c=z(c),c=A(c),c=B(c)),this.code=a,this.data=b,c},a.prototype.compile=function(a){var b=this.tokens(a);return f.nodes(b).compile({bare:!0}).trim()},a.prototype.toString=function(a){var b=0;return"string"==typeof a&&(a=this.tokens(a)),a.map(function(a){switch(a[h]){case"TERMINATOR":return"\n"+l(b);case"INDENT":return b+=0|a[i],"\n"+l(b);case"OUTDENT":return b-=0|a[i],"\n"+l(b);case"RETURN":return"return ";case"UNARY":return a[i].length>1?a[i]+" ":a[i];case"{":return"{";case",":case"RELATION":return a[i]+" ";case"=":return" = ";case"COMPOUND_ASSIGN":case"COMPARE":case"MATH":case"+":case"-":return" "+a[i]+" ";default:return a[i]}}).join("").trim()},a}(),D=function(){e.createCoffeeCompiler=function(){return new C}};d.exports={Compiler:C,dumpTokens:k,findOperandHead:m,findOperandTail:n,replaceTimeValue:o,replacePrecedence:p,replaceUnaryOp:r,replaceBinaryOp:t,replaceLogicOp:v,replaceCompoundAssign:x,replaceSynthDef:y,replaceGlobal:z,cleanupParenthesis:A,insertReturn:B,use:D}}),e("cc/common/timevalue",function(a,b,c){var d=a("../cc"),e=function(a){var b,c=null;"~"===a.charAt(0)&&(b=!0,a=a.substr(1));do{if(c=f(a),null!==c)break;if(c=g(a),null!==c)break;if(c=h(a),null!==c)break;if(c=i(a),null!==c)break;if(c=k(a),null!==c)break;if(c=m(a),null!==c)break;c=o(a)}while(!1);if(null!==c){if(!b)return c;if(0!==c)return 1/c}return a},f=function(a){var b=/^(\d+(?:\.\d+)?)hz$/i.exec(a);return b?0===+b[1]?0:1/+b[1]:null},g=function(a){var b=/^(\d+(?:\.\d+)?)(min|sec|m)s?$/i.exec(a);if(b)switch(b[2]){case"min":return 60*+(b[1]||0);case"sec":return+(b[1]||0);case"m":return+(b[1]||0)/1e3}return null},h=function(a){var b=/^(?:([1-9][0-9]*):)?([0-5]?[0-9]):([0-5][0-9])(?:\.(\d{1,3}))?$/.exec(a);if(b){var c=0;return c+=3600*(0|b[1]),c+=60*(0|b[2]),c+=0|b[3],c+=(0|((b[4]||"")+"00").substr(0,3))/1e3}return null},i=function(a){var b=/^(\d+)samples(?:\/(\d+)hz)?$/i.exec(a);return b?b[1]/(0|b[2]||d.sampleRate):null},j=function(a,b,c){var d=60/a*(4/b);return d*=[1,1.5,1.75,1.875][c]||1},k=function(a){var b=/^bpm([1-9]\d+(?:\.\d+)?)\s*l([1-9]\d*)(\.*)$/i.exec(a);return b?j(+b[1],+b[2],b[3].length):null},l=function(a,b,c,d){var e=480*(4*b+c)+d;return 60/a*(e/480)},m=function(a){var b=/^bpm([1-9]\d+(?:\.\d+)?)\s*(\d+)\.(\d+).(\d{1,3})$/i.exec(a);return b?l(+b[1],+b[2],+b[3],+b[4]):null},n=function(a,b){return 60/a*b/480},o=function(a){var b=/^bpm([1-9]\d+(?:\.\d+)?)\s*(\d+)ticks$/i.exec(a);return b?n(+b[1],+b[2]):null};c.exports={hz:f,time:g,hhmmss:h,samples:i,note:k,beat:m,ticks:o,calcNote:j,calcBeat:l,calcTicks:n,calc:e}}),e("cc/server/server",function(b,c,d){var e=b("./cc"),f=b("../common/extend"),g=b("../common/pack").pack,h=b("../common/emitter"),i={},j=function(){function a(){this.sampleRate=0,this.channels=0,this.strmLength=0,this.bufLength=0,this.instanceManager=e.createInstanceManager(),this.strm=null,this.timer=e.createTimer(),this.processed=0,this.processStart=0,this.processInterval=0,this.initialized=!1}return a.prototype.sendToClient=function(){throw"should be overridden"},a.prototype.recvFromClient=function(a,b){if(b=0|b,a instanceof Uint8Array)this.instanceManager.doBinayCommand(b,a);else{var c=i[a[0]];if(!c)throw new Error("Unknown command: "+a[0]);c.call(this,a,b)}},a.prototype.connect=function(){throw"should be overridden"},a.prototype.init=function(a){this.initialized||(this.initialized=!0,a&&(this.sampleRate=0|a[1],this.channels=0|a[2]),this.strm=new Int16Array(this.strmLength*this.channels),this.instanceManager.init(this),this.instanceManager.append(0))},a.prototype.play=function(a,b){b=0|b,this.instanceManager.play(b),this.timer.isRunning()||(this.processStart=Date.now(),this.processDone=0,this.processInterval=1e3*(this.strmLength/this.sampleRate),this.timer.start(this.process.bind(this),10))},a.prototype.pause=function(a,b){b=0|b,this.instanceManager.pause(b),this.timer.isRunning()&&(this.instanceManager.isRunning()||this.timer.stop())},a.prototype.reset=function(a,b){b=0|b,this.instanceManager.reset(b)},a.prototype.process=function(){throw"should be overridden"},a.prototype.pushToTimeline=function(a,b){b=0|b;var c=a[1];this.instanceManager.pushToTimeline(b,c)},a.prototype.process=function(){throw"should be overridden"},a}(),k=function(){function a(){j.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=1024,this.bufLength=64,this.offset=0}return f(a,j),a.prototype.sendToClient=function(a){postMessage(a)},a.prototype.connect=function(){this.sendToClient(["/connected",this.sampleRate,this.channels])},a.prototype.process=function(){if(!(this.processDone-25>Date.now()-this.processStart)){for(var a=this.strm,b=this.instanceManager,c=this.strmLength,d=this.bufLength,f=b.busOutL,g=b.busOutR,h=e.client,i=0,j=0,k=c/d;k>j;++j){h.process(),b.process(d);for(var l=d,m=c+d;m--,l--;)a[l+i]=Math.max(-32768,Math.min(32768*f[l],32767)),a[m+i]=Math.max(-32768,Math.min(32768*g[l],32767));i+=d}this.sendToClient(a),this.processDone+=this.processInterval}},a}(),l=function(){function a(){k.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=2048,this.bufLength=128}return f(a,k),a.prototype.sendToClient=function(a){postMessage(a)},a.prototype.connect=function(){this.sendToClient(["/connected",this.sampleRate,this.channels])},a.prototype.process=function(){if(!(this.processDone-25>Date.now()-this.processStart)){for(var a=this.strm,b=this.instanceManager,c=this.strmLength,d=this.bufLength,e=b.busOutL,f=b.busOutR,g=0,h=0,i=c/d;i>h;++h){b.process(d);for(var j=d,k=c+d;k--,j--;)a[j+g]=Math.max(-32768,Math.min(32768*e[j],32767)),a[k+g]=Math.max(-32768,Math.min(32768*f[j],32767));g+=d}this.sendToClient(a),this.sendToClient(["/process"]),this.processDone+=this.processInterval}},a}(),m=function(){function c(){j.call(this),this.sampleRate=44100,this.channels=2,this.strmLength=4096,this.bufLength=128,this.list=[],this.map={},this.exports=null}var d;return a.require&&(d=a.require("ws").Server),b("../common/audioapi").use(),f(c,j),c.prototype._init=function(a){var b=this,c=0,f=this.exports;"undefined"!=typeof a.speaker&&(a.speaker&&(this.api=e.createAudioAPI(this)),delete a.speaker),this.socket=new d(a),this.socket.on("connection",function(a){var d=c++;b.list.push(a),b.map[d]=a,b.instanceManager.append(d),a.on("message",function(a){a="string"!=typeof a?new Uint8Array(a):JSON.parse(a),b.recvFromClient(a,d)}),a.on("close",function(){b.map[d]&&(b.pause([],d),b.instanceManager.remove(d),b.list.splice(b.list.indexOf(a),1),delete b.map[d]),f.emit("close",d)}),a.on("error",function(a){f.emit("error",d,a)}),b.sendToClient(["/connected",b.sampleRate,b.channels],d),f.emit("open",d)}),this.init()},c.prototype.connect=function(){},c.prototype.sendToClient=function(a,b){if(a instanceof Int16Array)this.list.forEach(function(b){1===b.readyState&&b.send(a.buffer,{binary:!0,mask:!1})});else if(a=JSON.stringify(a),void 0===b)this.list.forEach(function(b){1===b.readyState&&b.send(a)});else{var c=this.map[b];c&&1===c.readyState&&c.send(a)}},c.prototype.play=function(a,b){b=0|b,this.instanceManager.play(b),this.api&&(this._strm=new Int16Array(this.strmLength*this.channels),this.strmList=new Array(8),this.strmListReadIndex=0,this.strmListWriteIndex=0,this.api.isPlaying||this.api.play()),this.timer.isRunning()||(this.processStart=Date.now(),this.processDone=0,this.processInterval=1e3*(this.strmLength/this.sampleRate),this.timer.start(this.process.bind(this),10))},c.prototype.pause=function(a,b){b=0|b,this.instanceManager.pause(b),this.api&&this.api.isPlaying&&(this.instanceManager.isRunning()||this.api.pause()),this.timer.isRunning()&&(this.instanceManager.isRunning()||this.timer.stop())},c.prototype.process=function(){if(!(this.processDone-25>Date.now()-this.processStart)){for(var a=this.strm,b=this.instanceManager,c=this.strmLength,d=this.bufLength,e=b.busOutL,f=b.busOutR,g=0,h=0,i=c/d;i>h;++h){b.process(d);for(var j=d,k=c+d;k--,j--;)a[j+g]=Math.max(-32768,Math.min(32768*e[j],32767)),a[k+g]=Math.max(-32768,Math.min(32768*f[j],32767));g+=d}this.sendToClient(a),this.sendToClient(["/process"]),this.processDone+=this.processInterval,this.api&&(this.strmList[this.strmListWriteIndex]=new Int16Array(a),this.strmListWriteIndex=7&this.strmListWriteIndex+1)}},c.prototype._process=function(){var a=this.strmList[this.strmListReadIndex];a&&(this.strmListReadIndex=7&this.strmListReadIndex+1,this._strm.set(a))},c}(),n=function(){function a(a,c){return b?(console.warn("CoffeeColliderSocketServer has been created already."),b):(h.mixin(this),this.server=a,this.server.exports=this,this.server._init(c||{}),b=this,void 0)}var b=null;return a.prototype.send=function(a,b){return this.server.sendToClient(["/socket/sendToIF",a],b),this},a}();i["/init"]=function(a,b){this.init(a,b)},i["/play"]=function(a,b){this.play(a,b)},i["/pause"]=function(a,b){this.pause(a,b)},i["/reset"]=function(a,b){this.reset(a,b)},i["/processed"]=function(a,b){this.pushToTimeline(a,b)},i["/socket/sendToServer"]=function(a,b){this.exports&&(a=a[1],a.userId=b,this.exports.emit("message",a))},d.exports={use:function(){b("../common/timer").use(),b("./instance").use(),b("./rate").use(),b("./unit/unit").use(),e.unit_install=function(){b("./unit/installer").install()},e.createSynthServer=function(){switch(e.unit_install(),e.opmode){case"worker":return e.createWorkerSynthServer();case"iframe":return e.createIFrameSynthServer();case"socket":return e.createSocketSynthServer()}throw new Error("A SynthServer is not defined for: "+e.opmode)},e.createWorkerSynthServer=function(){var a=new k;return e.opmode="worker",a},e.createIFrameSynthServer=function(){var b=new l;return a.onmessage=function(a){b.recvFromClient(a.data,0)},e.opmode="iframe",b},e.createSocketSynthServer=function(){var a=new m;return a.exports={createServer:function(b){return new n(a,b)}},e.opmode="socket",a},"undefined"==typeof a.console&&(a.console=function(){var a={};return["log","debug","info","warn","error"].forEach(function(b){a[b]=function(){if(e.server){var a=Array.prototype.slice.call(arguments).map(function(a){return g(a)});e.server.sendToClient(["/console/"+b,a])}}}),a}())}}}),e("cc/server/cc",function(a,b,c){var d=a("../cc");d.UGen||(d.UGen=Object),c.exports=d}),e("cc/server/instance",function(a,b,c){var d=a("./cc"),e=a("./node"),f=a("./commands"),g=function(){function a(){this.map={},this.list=[],this.server=null,this.process=b}a.prototype.init=function(a){if(!this.server){var b=128*a.bufLength+4096,c=a.bufLength,d=a.bufLength<<2;this.server=a,this.busClear=new Float32Array(b),this.map={},this.list=[],this.busOut=new Float32Array(b),this.busOutLen=a.bufLength<<1,this.busOutL=new Float32Array(this.busOut.buffer,0,c),this.busOutR=new Float32Array(this.busOut.buffer,d,c)}},a.prototype.append=function(a){if(!this.map[a]){var b=new h(this,a);this.map[a]=b,this.list.push(b),this.process=1===this.list.length?c:d}return this.map[a]},a.prototype.remove=function(a){var d=this.map[a];d&&(this.list.splice(this.list.indexOf(d),1),delete this.map[a],1===this.list.length?this.process=c:0===this.list.length&&(this.process=b))},a.prototype.play=function(a){var b=this.map[a];b&&b.play()},a.prototype.pause=function(a){var b=this.map[a];b&&b.pause()},a.prototype.reset=function(a){var b=this.map[a];b&&b.reset()},a.prototype.isRunning=function(){return this.list.some(function(a){return a.rootNode.running})},a.prototype.pushToTimeline=function(a,b){var c=this.map[a];c&&(c.timeline=c.timeline.concat(b))},a.prototype.doBinayCommand=function(a,b){var c=this.map[a];c&&c.doBinayCommand(b)};var b=function(){this.busOut.set(this.busClear)},c=function(a,b){this.list[0].process(a,b),this.busOut.set(this.list[0].bus)},d=function(a,b){var c,d=this.list,e=this.busOut,f=this.busOutLen;e.set(this.busClear);for(var g=0,h=d.length;h>g;++g){c=d[g],c.process(a,b);for(var i=c.bus,j=c.busAmp,k=f;k--;)e[k]+=i[k]*j}};return a}(),h=function(){function a(a,b){var c=128*a.server.bufLength+4096;this.manager=a,this.userId=0|b,this.bus=new Float32Array(c),this.busClear=a.busClear,this.busIndex=0,this.busAmp=.8,this.timeline=[],this.timelineIndex=0,this.rootNode=new e.Group(0,0,0,this),this.nodes={0:this.rootNode},this.fixNums={},this.defs={},this.buffers={},this.bufSrc={},this.syncItems=new Uint8Array(12),this.i16_syncItems=new Int16Array(this.syncItems.buffer),this.f32_syncItems=new Float32Array(this.syncItems.buffer)}return a.prototype.play=function(){this.rootNode.running=!0,this.bus.set(this.busClear)},a.prototype.pause=function(){this.rootNode.running=!1,this.bus.set(this.busClear),this.timeline=[]},a.prototype.reset=function(){this.manager.busClear&&this.bus.set(this.manager.busClear),this.timeline=[],this.rootNode=new e.Group(0,0,0,this),this.nodes={0:this.rootNode},this.fixNums={},this.defs={},this.buffers={},this.bufSrc={}},a.prototype.doBinayCommand=function(a){var b=f[(a[1]<<8)+a[0]];b&&b.call(this,a)},a.prototype.getFixNum=function(a){var b=this.fixNums;return b[a]||(b[a]={outs:[new Float32Array([a])]})},a.prototype.process=function(a){for(var b,c=this.timeline;b=c.shift();){var d=f[b[0]];d&&d.call(this,b)}this.bus.set(this.busClear),this.rootNode.process(a,this)},a}();c.exports={InstanceManager:g,use:function(){d.createInstanceManager=function(){return new g}}}}),e("cc/server/node",function(a,b,c){var d=a("./cc"),e=a("../common/extend"),f=a("./unit/unit").Unit,g={},h={};g[0]=function(a){var b;this instanceof m&&(null===this.head?this.head=this.tail=a:(b=this.head.prev,b&&(b.next=a),a.next=this.head,this.head.prev=a,this.head=a),a.parent=this)},g[1]=function(a){var b;this instanceof m&&(null===this.tail?this.head=this.tail=a:(b=this.tail.next,b&&(b.prev=a),a.prev=this.tail,this.tail.next=a,this.tail=a),a.parent=this)
},g[2]=function(a){var b=this.prev;this.prev=a,a.prev=b,b&&(b.next=a),a.next=this,this.parent&&this.parent.head===this&&(this.parent.head=a),a.parent=this.parent},g[3]=function(a){var b=this.next;this.next=a,a.next=b,b&&(b.prev=a),a.prev=this,this.parent&&this.parent.tail===this&&(this.parent.tail=a),a.parent=this.parent},g[4]=function(a){a.next=this.next,a.prev=this.prev,a.head=this.head,a.tail=this.tail,a.parent=this.parent,this.prev&&(this.prev.next=a),this.next&&(this.next.prev=a),this.parent&&this.parent.head===this&&(this.parent.head=a),this.parent&&this.parent.tail===this&&(this.parent.tail=a)},h[0]=function(){},h[1]=function(){this.running=!1},h[2]=function(){i.call(this)},h[3]=function(){var a=this.prev;a&&i.call(a),i.call(this)},h[4]=function(){var a=this.next;i.call(this),a&&i.call(a)},h[5]=function(){var a=this.prev;a instanceof m?j(a):i.call(a),i.call(this)},h[6]=function(){var a=this.next;i.call(this),a?j(a):i.call(a)},h[7]=function(){var a=this.parent.head;if(a)for(var b=a;b&&b!==this;)a=b.next,i.call(b),b=a;i.call(this)},h[8]=function(){var a=this.next;if(i.call(this),a)for(var b=a;b;)a=b.next,i.call(b),b=a},h[9]=function(){var a=this.prev;i.call(this),a&&(a.running=!1)},h[10]=function(){var a=this.next;i.call(this),a&&(a.running=!1)},h[11]=function(){var a=this.prev;a instanceof m?k(a):i.call(a),i.call(this)},h[12]=function(){var a=this.next;i.call(this),a?k(a):i.call(a)},h[13]=function(){var a=this.parent.head;if(a)for(var b=a;b;)a=b.next,i.call(b),b=a},h[14]=function(){k(this)};var i=function(){if(this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.parent){this.parent.head===this&&(this.parent.head=this.next),this.parent.tail===this&&(this.parent.tail=this.prev);var a;this.instance&&(a=this.instance.userId),d.server.sendToClient(["/emit/n_end",this.nodeId],a)}this.prev=null,this.next=null,this.parent=null,this.blocking=!1,this.instance&&delete this.instance.nodes[this.nodeId]},j=function(a){var b=a.head;for(i.call(a),a=b;a;)b=a.next,i.call(a),a=b},k=function(a){var b=a.head;for(i.call(a),a=b;a;)b=a.next,i.call(a),a instanceof m&&k(a),a=b},l=function(){function a(a,b){this.nodeId=0|a,this.next=null,this.prev=null,this.parent=null,this.running=!0,this.instance=b}return a.prototype.play=function(){this.running=!0},a.prototype.pause=function(){this.running=!1},a.prototype.stop=function(){i.call(this)},a.prototype.doneAction=function(a,b){var c=h[a];if(c){c.call(this);var e;this.instance&&(e=this.instance.userId),d.server.sendToClient(["/emit/n_done",this.nodeId,b],e)}},a}(),m=function(){function a(a,b,c,d){l.call(this,a,d),this.head=null,this.tail=null,b&&g[c].call(b,this)}return e(a,l),a.prototype.process=function(a,b){this.head&&this.running&&this.head.process(a,b),this.next&&this.next.process(a,b)},a}(),n=function(){function a(a,b,c,d,e,f){if(l.call(this,a,f),f){var h=f.defs[d];h&&this.build(h,e,f)}b&&g[c].call(b,this)}return e(a,l),a.prototype.build=function(a,b,c){this.specs=a;var d=a.consts.map(function(a){return c.getFixNum(a)}),e=a.defs.map(function(a){return new f(this,a)},this);return this.params=a.params,this.controls=new Float32Array(this.params.values),this.set(b),this.unitList=e.filter(function(a){for(var b=a.inputs,c=a.inRates,f=a.specs[3],g=a.specs[5],h=0,i=b.length;i>h;++h){var j=h<<1;-1===f[j]?(b[h]=d[f[j+1]].outs[0],c[h]=0):(b[h]=e[f[j]].outs[f[j+1]],c[h]=e[f[j]].outRates[f[j+1]])}return a.init(g),!!a.process}),this},a.prototype.set=function(a){for(var b=0,c=a.length;c>b;b+=2){var d=a[b],e=a[b+1];this.controls[d]=e}},a.prototype.process=function(a,b){if(this.running&&this.unitList)for(var c=this.unitList,d=0,e=c.length;e>d;++d){var f=c[d];f.process(f.rate.bufLength,b)}this.next&&this.next.process(a,b)},a}();c.exports={Node:l,Group:m,Synth:n}}),e("cc/server/unit/unit",function(a,b,c){var d=a("../cc"),e={},f=function(){function a(a,b){this.parent=a,this.specs=b,this.name=b[0],this.calcRate=b[1],this.specialIndex=b[2],this.numOfInputs=b[3].length>>1,this.numOfOutputs=b[4].length,this.inputs=new Array(this.numOfInputs),this.inRates=new Array(this.numOfInputs),this.outRates=b[4],this.rate=d.getRateInstance(this.calcRate||1);for(var c=this.rate.bufLength,e=new Float32Array(c*this.numOfOutputs),f=new Array(this.numOfOutputs),g=0,h=f.length;h>g;++g)f[g]=new Float32Array(e.buffer,c*g*e.BYTES_PER_ELEMENT,c);this.outs=f,this.allOuts=e,this.bufLength=c,this.done=!1}return a.prototype.init=function(a){var b=e[this.name];return"function"==typeof b?b.call(this):console.warn(this.name+"'s ctor is not found."),this.tag=a,this},a.prototype.doneAction=function(a){this.done||(this.done=!0,this.parent.doneAction(a,this.tag))},a}();e.Control=function(){var a=function(){this.process=1===this.numOfOutputs?b:c,this.process(1)},b=function(){this.outs[0][0]=this.parent.controls[this.specialIndex]},c=function(){for(var a=this.parent.controls,b=this.outs,c=this.specialIndex,d=0,e=b.length;e>d;++d)b[d][0]=a[d+c]};return a}(),e.Out=function(){var a=function(){this._bufLength=d.server.bufLength,2===this.calcRate?(this.process=b,this._busOffset=0):(this.process=c,this._busOffset=128*this._bufLength)},b=function(a,b){a=0|a;for(var c,d,e=this.inputs,f=b.bus,g=this._bufLength,h=(0|e[0][0])-1,i=1,j=e.length;j>i;++i){c=(h+i)*g,d=e[i];for(var k=0;a>k;k++)f[c+k]+=d[k]}},c=function(a,b){for(var c=this.inputs,d=b.bus,e=this._busOffset+(0|c[0][0])-1,f=1,g=c.length;g>f;++f)d[e+f]+=c[f][0]};return a}(),e.In=function(){var a=function(){this._bufLength=d.server.bufLength,2===this.calcRate?(this.process=b,this._busOffset=0):(this.process=c,this._busOffset=128*this._bufLength)},b=function(a,b){a=0|a;for(var c=this.outs[0],d=b.bus,e=this._bufLength,f=0|this.inputs[0][0]*e,g=0;a>g;++g)c[g]=d[f+g]},c=function(a,b){a=0|a;for(var c=this.outs[0],d=b.bus[this._busOffset+(0|this.inputs[0][0])],e=0;a>e;++e)c[e]=d};return a}(),c.exports={Unit:f,specs:e,use:function(){d.createUnit=function(a,b){return new f(a,b)}}}}),e("cc/server/commands",function(a,b,c){var d=a("./node"),e=a("./buffer"),f={};f["/n_run"]=function(a){var b=0|a[1],c=!!a[2],d=this.nodes[b];d&&(d.running=c)},f["/n_free"]=function(a){var b=0|a[1],c=this.nodes[b];c&&c.doneAction(2)},f["/n_set"]=function(a){var b=0|a[1],c=a[2],d=this.nodes[b];d&&d.set(c)},f["/g_new"]=function(a){var b=0|a[1],c=0|a[2],e=0|a[3],f=this.nodes[e];f&&(this.nodes[b]=new d.Group(b,f,c,this))},f["/s_def"]=function(a){var b=0|a[1],c=JSON.parse(a[2]);this.defs[b]=c},f["/s_new"]=function(a){var b=0|a[1],c=0|a[2],e=0|a[3],f=0|a[4],g=a[5],h=this.nodes[e];h&&(this.nodes[b]=new d.Synth(b,h,c,f,g,this))},f["/b_new"]=function(a){var b=0|a[1];this.buffers[b]=new e.AudioBuffer(b)},f["/b_bind"]=function(a){var b=0|a[1],c=0|a[2],d=0|a[3],e=0|a[4],f=this.buffers[b],g=this.bufSrc[c];f&&(g?f.bindBufferSource(g,d,e):(g=new f.BufferSource(c),g.pendings.push([f,d,e]),this.bufSrc[c]=g))},f[0]=function(a){this.syncItems.set(a)},f[1]=function(a){var b=(a[3]<<8)+a[2],c=(a[7]<<8)+a[6],d=(a[11]<<24)+(a[10]<<16)+(a[9]<<8)+a[8],f=(a[15]<<24)+(a[14]<<16)+(a[13]<<8)+a[12],g=new Float32Array(a.subarray(16).buffer),h=this.bufSrc[b];h||(h=new e.BufferSource(b)),h.set(c,d,f,g),this.bufSrc[b]=h},c.exports=f}),e("cc/server/buffer",function(a,b,c){var d=function(){function a(a){this.bufSrcId=a,this.channels=0,this.sampleRate=0,this.frames=0,this.samples=null,this.pendings=[]}return a.prototype.set=function(a,b,c,d){this.channels=a,this.sampleRate=b,this.frames=c,this.samples=d,this.pendings.forEach(function(a){var b=a[0],c=a[1],d=a[2];b.bindBufferSource(this,c,d)},this),this.pendings=null},a}(),e=function(){function a(a){this.bufId=a,this.frames=0,this.channels=0,this.sampleRate=0,this.samples=null}return a.prototype.bindBufferSource=function(a,b,c){b=Math.max(0,Math.min(0|b,a.frames)),c=Math.max(-1,Math.min(0|c,a.frames-b)),0===b?-1===c?(this.samples=a.samples,this.frames=a.frames):(this.samples=new Float32Array(a.samples.buffer,0,c),this.frames=c):-1===c?(this.samples=new Float32Array(a.samples.buffer,4*b),this.frames=a.frames-b):(this.samples=new Float32Array(a.samples.buffer,4*b,c),this.frames=c),this.channels=a.channels,this.sampleRate=a.sampleRate},a}();c.exports={BufferSource:d,AudioBuffer:e}}),e("cc/server/rate",function(a,b,c){var d=a("./cc"),e=function(){function a(a,c){this.sampleRate=a,this.sampleDur=1/a,this.radiansPerSample=b/a,this.bufLength=c,this.bufDuration=c/a,this.bufRate=1/this.bufDuration,this.slopeFactor=1/c,this.filterLoops=0|c/3,this.filterRemain=0|c%3,this.filterSlope=0===this.filterLoops?0:1/this.filterLoops}var b=2*Math.PI;return a}();c.exports={use:function(){d.createRate=function(a,b){return new e(a,b)},d.getRateInstance=function(){var a={};return function(b){if(!a[b])switch(b){case 2:a[2]=new e(d.server.sampleRate,d.server.bufLength);break;case 1:a[1]=new e(d.server.sampleRate/d.server.bufLength,1)}return a[b]}}()}}}),e("cc/server/unit/installer",function(a,b,c){c.exports={install:function(){a("./unit"),a("./madd"),a("./uop"),a("./bop"),a("./bufio"),a("./delay"),a("./line"),a("./osc"),a("./pan"),a("./ui")}}}),e("cc/server/unit/madd",function(a,b,c){var d=a("./unit");d.specs.MulAdd=function(){var a=function(){var a=this.inRates,c=b[a[0]][a[1]][a[2]];this.process=c,this._in=this.inputs[0][0],this._mul=this.inputs[1][0],this._add=this.inputs[2][0],this.process?this.process(1):this.outs[0][0]=this._in*this._mul+this._add},b={};return b[2]={},b[2][2]={},b[2][1]={},b[2][0]={},b[1]={},b[1][2]={},b[1][1]={},b[1][0]={},b[0]={},b[0][2]={},b[0][1]={},b[0][0]={},b[2][2][2]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this.inputs[2],f=0;a>f;f+=8)b[f]=c[f]*d[f]+e[f],b[f+1]=c[f+1]*d[f+1]+e[f+1],b[f+2]=c[f+2]*d[f+2]+e[f+2],b[f+3]=c[f+3]*d[f+3]+e[f+3],b[f+4]=c[f+4]*d[f+4]+e[f+4],b[f+5]=c[f+5]*d[f+5]+e[f+5],b[f+6]=c[f+6]*d[f+6]+e[f+6],b[f+7]=c[f+7]*d[f+7]+e[f+7]},b[2][2][1]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this._add,f=this.inputs[2][0],g=(f-e)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]*d[h]+e,e+=g,b[h+1]=c[h+1]*d[h+1]+e,e+=g,b[h+2]=c[h+2]*d[h+2]+e,e+=g,b[h+3]=c[h+3]*d[h+3]+e,e+=g,b[h+4]=c[h+4]*d[h+4]+e,e+=g,b[h+5]=c[h+5]*d[h+5]+e,e+=g,b[h+6]=c[h+6]*d[h+6]+e,e+=g,b[h+7]=c[h+7]*d[h+7]+e,e+=g;this._add=f},b[2][2][0]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this._add,f=0;a>f;f+=8)b[f]=c[f]*d[f]+e,b[f+1]=c[f+1]*d[f+1]+e,b[f+2]=c[f+2]*d[f+2]+e,b[f+3]=c[f+3]*d[f+3]+e,b[f+4]=c[f+4]*d[f+4]+e,b[f+5]=c[f+5]*d[f+5]+e,b[f+6]=c[f+6]*d[f+6]+e,b[f+7]=c[f+7]*d[f+7]+e},b[2][1][2]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._mul,e=this.inputs[2],f=this.inputs[1][0],g=(f-d)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]*d+e[h],d+=g,b[h+1]=c[h+1]*d+e[h+1],d+=g,b[h+2]=c[h+2]*d+e[h+2],d+=g,b[h+3]=c[h+3]*d+e[h+3],d+=g,b[h+4]=c[h+4]*d+e[h+4],d+=g,b[h+5]=c[h+5]*d+e[h+5],d+=g,b[h+6]=c[h+6]*d+e[h+6],d+=g,b[h+7]=c[h+7]*d+e[h+7],d+=g;this._mul=f},b[2][1][1]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._mul,e=this._add,f=this.inputs[1][0],g=(f-d)*this.rate.slopeFactor,h=this.inputs[2][0],i=(h-e)*this.rate.slopeFactor,j=0;a>j;j+=8)b[j]=c[j]*d+e,d+=g,e+=i,b[j+1]=c[j+1]*d+e,d+=g,e+=i,b[j+2]=c[j+2]*d+e,d+=g,e+=i,b[j+3]=c[j+3]*d+e,d+=g,e+=i,b[j+4]=c[j+4]*d+e,d+=g,e+=i,b[j+5]=c[j+5]*d+e,d+=g,e+=i,b[j+6]=c[j+6]*d+e,d+=g,e+=i,b[j+7]=c[j+7]*d+e,d+=g,e+=i;this._mul=f,this._add=h},b[2][1][0]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._mul,e=this._add,f=this.inputs[1][0],g=(f-d)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]*d+e,d+=g,b[h+1]=c[h+1]*d+e,d+=g,b[h+2]=c[h+2]*d+e,d+=g,b[h+3]=c[h+3]*d+e,d+=g,b[h+4]=c[h+4]*d+e,d+=g,b[h+5]=c[h+5]*d+e,d+=g,b[h+6]=c[h+6]*d+e,d+=g,b[h+7]=c[h+7]*d+e,d+=g;this._mul=f},b[2][0][2]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._mul,e=this.inputs[2],f=0;a>f;f+=8)b[f]=c[f]*d+e[f],b[f+1]=c[f+1]*d+e[f+1],b[f+2]=c[f+2]*d+e[f+2],b[f+3]=c[f+3]*d+e[f+3],b[f+4]=c[f+4]*d+e[f+4],b[f+5]=c[f+5]*d+e[f+5],b[f+6]=c[f+6]*d+e[f+6],b[f+7]=c[f+7]*d+e[f+7]},b[2][0][1]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._mul,e=this._add,f=this.inputs[2][0],g=(f-e)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]*d+e,e+=g,b[h+1]=c[h+1]*d+e,e+=g,b[h+2]=c[h+2]*d+e,e+=g,b[h+3]=c[h+3]*d+e,e+=g,b[h+4]=c[h+4]*d+e,e+=g,b[h+5]=c[h+5]*d+e,e+=g,b[h+6]=c[h+6]*d+e,e+=g,b[h+7]=c[h+7]*d+e,e+=g;this._add=f},b[2][0][0]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._mul,e=this._add,f=this.inputs[1][0],g=(f-d)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]*d+e,d+=g,b[h+1]=c[h+1]*d+e,d+=g,b[h+2]=c[h+2]*d+e,d+=g,b[h+3]=c[h+3]*d+e,d+=g,b[h+4]=c[h+4]*d+e,d+=g,b[h+5]=c[h+5]*d+e,d+=g,b[h+6]=c[h+6]*d+e,d+=g,b[h+7]=c[h+7]*d+e,d+=g;this._mul=f},b[1][1][2]=function(a){a=0|a;for(var b=this.outs[0],c=this._in,d=this._mul,e=this.inputs[2],f=this.inputs[0][0],g=(f-c)*this.rate.slopeFactor,h=this.inputs[1][0],i=(h-d)*this.rate.slopeFactor,j=0;a>j;j+=8)b[j]=c*d+e[j],c+=g,d+=i,b[j+1]=c*d+e[j+1],c+=g,d+=i,b[j+2]=c*d+e[j+2],c+=g,d+=i,b[j+3]=c*d+e[j+3],c+=g,d+=i,b[j+4]=c*d+e[j+4],c+=g,d+=i,b[j+5]=c*d+e[j+5],c+=g,d+=i,b[j+6]=c*d+e[j+6],c+=g,d+=i,b[j+7]=c*d+e[j+7],c+=g,d+=i;this._in=f,this._mul=h},b[1][1][1]=function(){this.outs[0][0]=this.inputs[0][0]*this.inputs[1][0]+this.inputs[2][0]},b[1][1][0]=function(){this.outs[0][0]=this.inputs[0][0]*this.inputs[1][0]+this._add},b[1][0][2]=function(a){a=0|a;for(var b=this.outs[0],c=this._in,d=this._mul,e=this.inputs[2],f=this.inputs[0][0],g=(f-c)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c*d+e[h],c+=g,b[h+1]=c*d+e[h+1],c+=g,b[h+2]=c*d+e[h+2],c+=g,b[h+3]=c*d+e[h+3],c+=g,b[h+4]=c*d+e[h+4],c+=g,b[h+5]=c*d+e[h+5],c+=g,b[h+6]=c*d+e[h+6],c+=g,b[h+7]=c*d+e[h+7],c+=g;this._in=f},b[1][0][1]=function(){this.outs[0][0]=this.inputs[0][0]*this._mul+this.inputs[2][0]},b[1][0][0]=function(){this.outs[0][0]=this.inputs[0][0]*this._mul+this._add},b[0][2][2]=function(a){a=0|a;for(var b=this.outs[0],c=this._in,d=this.inputs[1],e=this.inputs[2],f=0;a>f;f+=8)b[f]=c*d[f]+e[f],b[f+1]=c*d[f+1]+e[f+1],b[f+2]=c*d[f+2]+e[f+2],b[f+3]=c*d[f+3]+e[f+3],b[f+4]=c*d[f+4]+e[f+4],b[f+5]=c*d[f+5]+e[f+5],b[f+6]=c*d[f+6]+e[f+6],b[f+7]=c*d[f+7]+e[f+7]},b[0][2][1]=function(a){a=0|a;for(var b=this.outs[0],c=this._in,d=this.inputs[1],e=this._add,f=this.inputs[2][0],g=(f-e)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c*d[h]+e,e+=g,b[h+1]=c*d[h+1]+e,e+=g,b[h+2]=c*d[h+2]+e,e+=g,b[h+3]=c*d[h+3]+e,e+=g,b[h+4]=c*d[h+4]+e,e+=g,b[h+5]=c*d[h+5]+e,e+=g,b[h+6]=c*d[h+6]+e,e+=g,b[h+7]=c*d[h+7]+e,e+=g;this._add=f},b[0][2][0]=function(a){a=0|a;for(var b=this.outs[0],c=this._in,d=this.inputs[1],e=this._add,f=0;a>f;f+=8)b[f]=c*d[f]+e,b[f+1]=c*d[f+1]+e,b[f+2]=c*d[f+2]+e,b[f+3]=c*d[f+3]+e,b[f+4]=c*d[f+4]+e,b[f+5]=c*d[f+5]+e,b[f+6]=c*d[f+6]+e,b[f+7]=c*d[f+7]+e},b[0][1][2]=function(a){a=0|a;for(var b=this.outs[0],c=this._in,d=this._mul,e=this.inputs[2],f=this.inputs[1][0],g=(f-d)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c*d+e[h],d+=g,b[h+1]=c*d+e[h+1],d+=g,b[h+2]=c*d+e[h+2],d+=g,b[h+3]=c*d+e[h+3],d+=g,b[h+4]=c*d+e[h+4],d+=g,b[h+5]=c*d+e[h+5],d+=g,b[h+6]=c*d+e[h+6],d+=g,b[h+7]=c*d+e[h+7],d+=g;this._mul=f},b[0][1][1]=function(){this.outs[0][0]=this._in*this.inputs[1][0]+this.inputs[2][0]},b[0][1][0]=function(){this.outs[0][0]=this._in*this.inputs[1][0]+this._add},b[0][0][2]=function(a){a=0|a;for(var b=this.outs[0],c=this._in,d=this._mul,e=this.inputs[2],f=0;a>f;f+=8)b[f]=c*d+e[f],b[f+1]=c*d+e[f+1],b[f+2]=c*d+e[f+2],b[f+3]=c*d+e[f+3],b[f+4]=c*d+e[f+4],b[f+5]=c*d+e[f+5],b[f+6]=c*d+e[f+6],b[f+7]=c*d+e[f+7]},b[0][0][1]=function(){this.outs[0][0]=this._in*this._mul+this.inputs[2][0]},a}(),d.specs.Sum3=function(){var a=function(){var a=this.inRates,c=b[a[0]][a[1]][a[2]];this.process=c,this._in0=this.inputs[0][0],this._in1=this.inputs[1][0],this._in2=this.inputs[2][0],this.process?this.process(1):this.outs[0][0]=this._in0*this._in1+this._in2},b={};return b[2]={},b[2][2]={},b[2][1]={},b[2][0]={},b[1]={},b[1][1]={},b[1][0]={},b[2][2][2]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this.inputs[2],f=0;a>f;f+=8)b[f]=c[f]+d[f]+e[f],b[f+1]=c[f+1]+d[f+1]+e[f+1],b[f+2]=c[f+2]+d[f+2]+e[f+2],b[f+3]=c[f+3]+d[f+3]+e[f+3],b[f+4]=c[f+4]+d[f+4]+e[f+4],b[f+5]=c[f+5]+d[f+5]+e[f+5],b[f+6]=c[f+6]+d[f+6]+e[f+6],b[f+7]=c[f+7]+d[f+7]+e[f+7]},b[2][2][1]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this._in2,f=this.inputs[2][0],g=(f-e)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]+d[h]+e,e+=g,b[h+1]=c[h+1]+d[h+1]+e,e+=g,b[h+2]=c[h+2]+d[h+2]+e,e+=g,b[h+3]=c[h+3]+d[h+3]+e,e+=g,b[h+4]=c[h+4]+d[h+4]+e,e+=g,b[h+5]=c[h+5]+d[h+5]+e,e+=g,b[h+6]=c[h+6]+d[h+6]+e,e+=g,b[h+7]=c[h+7]+d[h+7]+e,e+=g;this._in2=f},b[2][2][0]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this._in2,f=0;a>f;f+=8)b[f]=c[f]+d[f]+e,b[f+1]=c[f+1]+d[f+1]+e,b[f+2]=c[f+2]+d[f+2]+e,b[f+3]=c[f+3]+d[f+3]+e,b[f+4]=c[f+4]+d[f+4]+e,b[f+5]=c[f+5]+d[f+5]+e,b[f+6]=c[f+6]+d[f+6]+e,b[f+7]=c[f+7]+d[f+7]+e},b[2][1][1]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._in1+this._in2,e=this.inputs[1][0]+this.inputs[2][0],f=(e-d)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c[g]+d,d+=f,b[g+1]=c[g+1]+d,d+=f,b[g+2]=c[g+2]+d,d+=f,b[g+3]=c[g+3]+d,d+=f,b[g+4]=c[g+4]+d,d+=f,b[g+5]=c[g+5]+d,d+=f,b[g+6]=c[g+6]+d,d+=f,b[g+7]=c[g+7]+d,d+=f;this._in1=this.inputs[1][0],this._in2=this.inputs[2][0]},b[2][1][0]=b[2][1][1],b[2][0][0]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._in1+this._in2,e=0;a>e;e+=8)b[e]=c[e]+d,b[e+1]=c[e+1]+d,b[e+2]=c[e+2]+d,b[e+3]=c[e+3]+d,b[e+4]=c[e+4]+d,b[e+5]=c[e+5]+d,b[e+6]=c[e+6]+d,b[e+7]=c[e+7]+d},b[1][1][1]=function(){this.outs[0][0]=this.inputs[0][0]+this.inputs[1][0]+this.inputs[2][0]},b[1][1][0]=b[1][1][1],b[1][0][0]=b[1][1][1],a}(),d.specs.Sum4=function(){var a=function(){var a=this.inRates,c=b[a[0]][a[1]][a[2]][a[3]];this.process=c,this._in0=this.inputs[0][0],this._in1=this.inputs[1][0],this._in2=this.inputs[2][0],this._in3=this.inputs[3][0],this.process?this.process(1):this.outs[0][0]=this._in0*this._in1+this._in2+this._in3},b={};return b[2]={},b[2][2]={},b[2][2][2]={},b[2][2][1]={},b[2][2][0]={},b[2][1]={},b[2][1][1]={},b[2][1][0]={},b[2][0]={},b[2][0][0]={},b[1]={},b[1][1]={},b[1][1][1]={},b[1][1][0]={},b[1][0]={},b[1][0][0]={},b[0]={},b[0][0]={},b[0][0][0]={},b[2][2][2][2]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this.inputs[2],f=this.inputs[3],g=0;a>g;g+=8)b[g]=c[g]+d[g]+e[g]+f[g],b[g+1]=c[g+1]+d[g+1]+e[g+1]+f[g+1],b[g+2]=c[g+2]+d[g+2]+e[g+2]+f[g+2],b[g+3]=c[g+3]+d[g+3]+e[g+3]+f[g+3],b[g+4]=c[g+4]+d[g+4]+e[g+4]+f[g+4],b[g+5]=c[g+5]+d[g+5]+e[g+5]+f[g+5],b[g+6]=c[g+6]+d[g+6]+e[g+6]+f[g+6],b[g+7]=c[g+7]+d[g+7]+e[g+7]+f[g+7]},b[2][2][2][1]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this.inputs[2],f=this._in3,g=this.inputs[3][0],h=(g-f)*this.rate.slopeFactor,i=0;a>i;i+=8)b[i]=c[i]+d[i]+e[i]+f,f+=h,b[i+1]=c[i+1]+d[i+1]+e[i+1]+f,f+=h,b[i+2]=c[i+2]+d[i+2]+e[i+2]+f,f+=h,b[i+3]=c[i+3]+d[i+3]+e[i+3]+f,f+=h,b[i+4]=c[i+4]+d[i+4]+e[i+4]+f,f+=h,b[i+5]=c[i+5]+d[i+5]+e[i+5]+f,f+=h,b[i+6]=c[i+6]+d[i+6]+e[i+6]+f,f+=h,b[i+7]=c[i+7]+d[i+7]+e[i+7]+f,f+=h;this._in3=g},b[2][2][2][0]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this.inputs[2],f=this._in3,g=0;a>g;g+=8)b[g]=c[g]+d[g]+e[g]+f,b[g+1]=c[g+1]+d[g+1]+e[g+1]+f,b[g+2]=c[g+2]+d[g+2]+e[g+2]+f,b[g+3]=c[g+3]+d[g+3]+e[g+3]+f,b[g+4]=c[g+4]+d[g+4]+e[g+4]+f,b[g+5]=c[g+5]+d[g+5]+e[g+5]+f,b[g+6]=c[g+6]+d[g+6]+e[g+6]+f,b[g+7]=c[g+7]+d[g+7]+e[g+7]+f},b[2][2][1][1]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this._in2+this._in3,f=this.inputs[2][0]+this.inputs[3][0],g=(f-e)*this.rate.slopeFactor,h=0;a>h;h+=8)b[h]=c[h]+d[h]+e,e+=g,b[h+1]=c[h+1]+d[h+1]+e,e+=g,b[h+2]=c[h+2]+d[h+2]+e,e+=g,b[h+3]=c[h+3]+d[h+3]+e,e+=g,b[h+4]=c[h+4]+d[h+4]+e,e+=g,b[h+5]=c[h+5]+d[h+5]+e,e+=g,b[h+6]=c[h+6]+d[h+6]+e,e+=g,b[h+7]=c[h+7]+d[h+7]+e,e+=g;this._in2=this.inputs[2][0],this._in3=this.inputs[2][0]},b[2][2][1][0]=b[2][2][1][1],b[2][2][0][0]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=this._in2+this._in3,f=0;a>f;f+=8)b[f]=c[f]+d[f]+e,b[f+1]=c[f+1]+d[f+1]+e,b[f+2]=c[f+2]+d[f+2]+e,b[f+3]=c[f+3]+d[f+3]+e,b[f+4]=c[f+4]+d[f+4]+e,b[f+5]=c[f+5]+d[f+5]+e,b[f+6]=c[f+6]+d[f+6]+e,b[f+7]=c[f+7]+d[f+7]+e},b[2][1][1][1]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._in1+this._in2+this._in3,e=this.inputs[1][0]+this.inputs[2][0]+this.inputs[3][0],f=(e-d)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c[g]+d,d+=f,b[g+1]=c[g+1]+d,d+=f,b[g+2]=c[g+2]+d,d+=f,b[g+3]=c[g+3]+d,d+=f,b[g+4]=c[g+4]+d,d+=f,b[g+5]=c[g+5]+d,d+=f,b[g+6]=c[g+6]+d,d+=f,b[g+7]=c[g+7]+d,d+=f;this._in1=this.inputs[1][0],this._in2=this.inputs[2][0],this._in3=this.inputs[3][0]},b[2][1][1][0]=b[2][1][1][1],b[2][1][0][0]=b[2][1][1][1],b[2][0][0][0]=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._in1+this._in2+this._in3,e=0;a>e;e+=8)b[e]=c[e]+d,b[e+1]=c[e+1]+d,b[e+2]=c[e+2]+d,b[e+3]=c[e+3]+d,b[e+4]=c[e+4]+d,b[e+5]=c[e+5]+d,b[e+6]=c[e+6]+d,b[e+7]=c[e+7]+d},b[1][1][1][1]=function(){this.outs[0][0]=this.inputs[0][0]+this.inputs[1][0]+this.inputs[2][0]+this.inputs[3][0]},b[1][1][1][0]=b[1][1][1][1],b[1][1][0][0]=b[1][1][1][1],b[1][0][0][0]=b[1][1][1][1],a}(),c.exports={}}),e("cc/server/unit/uop",function(a,b,c){var d=a("./unit"),e=a("../../common/ops"),f={};d.specs.UnaryOpUGen=function(){var a=function(){var a,b=f[e.UNARY_OP_UGEN_MAP[this.specialIndex]];if(b){switch(this.inRates[0]){case 2:a=b.a;break;case 1:a=b.k}this.process=a,this.process?this.process(1):this.outs[0][0]=b(this.inputs[0][0])}else console.log("UnaryOpUGen["+this.specialIndex+"] is not defined.")};return a}();var g=function(a){return function(){this.outs[0][0]=a(this.inputs[0][0])}},h=function(a){return function(b){b=0|b;for(var c=this.outs[0],d=this.inputs[0],e=0;b>e;e+=8)c[e]=a(d[e]),c[e+1]=a(d[e+1]),c[e+2]=a(d[e+2]),c[e+3]=a(d[e+3]),c[e+4]=a(d[e+4]),c[e+5]=a(d[e+5]),c[e+6]=a(d[e+6]),c[e+7]=a(d[e+7])}};f.num=function(a){return+a},f.neg=function(a){return-a},f.not=function(a){return a>0?0:1},f.tilde=function(a){return~a},Object.keys(f).forEach(function(a){var b=f[a];b.a||(b.a=h(b)),b.k||(b.k=g(b))}),c.exports={}}),e("cc/server/unit/bop",function(a,b,c){var d=a("./unit"),e=a("../../common/ops"),f={};d.specs.BinaryOpUGen=function(){var a=22,b=21,c=20,d=12,g=11,h=10,i=2,j=1,k=0,l=function(){var l,m=f[e.BINARY_OP_UGEN_MAP[this.specialIndex]];if(m){switch(10*this.inRates[0]+this.inRates[1]){case a:l=m.aa;break;case b:l=m.ak;break;case c:l=m.ai;break;case d:l=m.ka;break;case g:l=m.kk;break;case h:l=m.ki;break;case i:l=m.ia;break;case j:l=m.ik;break;case k:l=m.ii}this.process=l,this._a=this.inputs[0][0],this._b=this.inputs[1][0],this.process?this.process(1):this.outs[0][0]=m(this.inputs[0][0],this.inputs[1][0])}else console.log("BinaryOpUGen["+this.specialIndex+"] is not defined.")};return l}();var g=function(a){return function(b){b=0|b;for(var c=this.outs[0],d=this.inputs[0],e=this.inputs[1],f=0;b>f;f+=8)c[f]=a(d[f],e[f]),c[f+1]=a(d[f+1],e[f+1]),c[f+2]=a(d[f+2],e[f+2]),c[f+3]=a(d[f+3],e[f+3]),c[f+4]=a(d[f+4],e[f+4]),c[f+5]=a(d[f+5],e[f+5]),c[f+6]=a(d[f+6],e[f+6]),c[f+7]=a(d[f+7],e[f+7])}},h=function(a){return function(b){b=0|b;for(var c=this.outs[0],d=this.inputs[0],e=this._b,f=this.inputs[1][0],g=(f-this._b)*this.rate.slopeFactor,h=0;b>h;h+=8)c[h]=a(d[h],e),e+=g,c[h+1]=a(d[h+1],e),e+=g,c[h+2]=a(d[h+2],e),e+=g,c[h+3]=a(d[h+3],e),e+=g,c[h+4]=a(d[h+4],e),e+=g,c[h+5]=a(d[h+5],e),e+=g,c[h+6]=a(d[h+6],e),e+=g,c[h+7]=a(d[h+7],e),e+=g;this._b=f}},i=function(a){return function(b){b=0|b;for(var c=this.outs[0],d=this.inputs[0],e=this._b,f=0;b>f;f+=8)c[f]=a(d[f],e),c[f+1]=a(d[f+1],e),c[f+2]=a(d[f+2],e),c[f+3]=a(d[f+3],e),c[f+4]=a(d[f+4],e),c[f+5]=a(d[f+5],e),c[f+6]=a(d[f+6],e),c[f+7]=a(d[f+7],e)}},j=function(a){return function(b){b=0|b;for(var c=this.outs[0],d=this._a,e=this.inputs[1],f=this.inputs[0][0],g=(f-this._a)*this.rate.slopeFactor,h=0;b>h;h+=8)c[h]=a(d,e[h]),d+=g,c[h+1]=a(d,e[h+1]),d+=g,c[h+2]=a(d,e[h+2]),d+=g,c[h+3]=a(d,e[h+3]),d+=g,c[h+4]=a(d,e[h+4]),d+=g,c[h+5]=a(d,e[h+5]),d+=g,c[h+6]=a(d,e[h+6]),d+=g,c[h+7]=a(d,e[h+7]),d+=g;this._a=f}},k=function(a){return function(){this.outs[0][0]=a(this.inputs[0][0],this.inputs[1][0])}},l=function(a){return function(b){b=0|b;for(var c=this.outs[0],d=this._a,e=this.inputs[1],f=0;b>f;f+=8)c[f]=a(d,e[f]),c[f+1]=a(d,e[f+1]),c[f+2]=a(d,e[f+2]),c[f+3]=a(d,e[f+3]),c[f+4]=a(d,e[f+4]),c[f+5]=a(d,e[f+5]),c[f+6]=a(d,e[f+6]),c[f+7]=a(d,e[f+7])}};f["+"]=function(a,b){return a+b},f["+"].aa=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=0;a>e;e+=8)b[e]=c[e]+d[e],b[e+1]=c[e+1]+d[e+1],b[e+2]=c[e+2]+d[e+2],b[e+3]=c[e+3]+d[e+3],b[e+4]=c[e+4]+d[e+4],b[e+5]=c[e+5]+d[e+5],b[e+6]=c[e+6]+d[e+6],b[e+7]=c[e+7]+d[e+7]},f["+"].ak=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._b,e=this.inputs[1][0],f=(e-this._b)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c[g]+d,d+=f,b[g+1]=c[g+1]+d,d+=f,b[g+2]=c[g+2]+d,d+=f,b[g+3]=c[g+3]+d,d+=f,b[g+4]=c[g+4]+d,d+=f,b[g+5]=c[g+5]+d,d+=f,b[g+6]=c[g+6]+d,d+=f,b[g+7]=c[g+7]+d,d+=f;this._b=e},f["+"].ai=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._b,e=0;a>e;e+=8)b[e]=c[e]+d,b[e+1]=c[e+1]+d,b[e+2]=c[e+2]+d,b[e+3]=c[e+3]+d,b[e+4]=c[e+4]+d,b[e+5]=c[e+5]+d,b[e+6]=c[e+6]+d,b[e+7]=c[e+7]+d},f["+"].ka=function(a){a=0|a;for(var b=this.outs[0],c=this._a,d=this.inputs[1],e=this.inputs[0][0],f=(e-this._a)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c+d[g],c+=f,b[g+1]=c+d[g+1],c+=f,b[g+2]=c+d[g+2],c+=f,b[g+3]=c+d[g+3],c+=f,b[g+4]=c+d[g+4],c+=f,b[g+5]=c+d[g+5],c+=f,b[g+6]=c+d[g+6],c+=f,b[g+7]=c+d[g+7],c+=f;this._a=e},f["+"].kk=function(){this.outs[0][0]=this.inputs[0][0]+this.inputs[1][0]},f["+"].ia=function(a){a=0|a;for(var b=this.outs[0],c=this._a,d=this.inputs[1],e=0;a>e;e+=8)b[e]=c+d[e],b[e+1]=c+d[e+1],b[e+2]=c+d[e+2],b[e+3]=c+d[e+3],b[e+4]=c+d[e+4],b[e+5]=c+d[e+5],b[e+6]=c+d[e+6],b[e+7]=c+d[e+7]},f["-"]=function(a,b){return a-b},f["-"].aa=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=0;a>e;e+=8)b[e]=c[e]-d[e],b[e+1]=c[e+1]-d[e+1],b[e+2]=c[e+2]-d[e+2],b[e+3]=c[e+3]-d[e+3],b[e+4]=c[e+4]-d[e+4],b[e+5]=c[e+5]-d[e+5],b[e+6]=c[e+6]-d[e+6],b[e+7]=c[e+7]-d[e+7]},f["-"].ak=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._b,e=this.inputs[1][0],f=(e-this._b)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c[g]-d,d+=f,b[g+1]=c[g+1]-d,d+=f,b[g+2]=c[g+2]-d,d+=f,b[g+3]=c[g+3]-d,d+=f,b[g+4]=c[g+4]-d,d+=f,b[g+5]=c[g+5]-d,d+=f,b[g+6]=c[g+6]-d,d+=f,b[g+7]=c[g+7]-d,d+=f;this._b=e},f["-"].ai=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._b,e=0;a>e;e+=8)b[e]=c[e]-d,b[e+1]=c[e+1]-d,b[e+2]=c[e+2]-d,b[e+3]=c[e+3]-d,b[e+4]=c[e+4]-d,b[e+5]=c[e+5]-d,b[e+6]=c[e+6]-d,b[e+7]=c[e+7]-d},f["-"].ka=function(a){a=0|a;for(var b=this.outs[0],c=this._a,d=this.inputs[1],e=this.inputs[0][0],f=(e-this._a)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c-d[g],c+=f,b[g+1]=c-d[g+1],c+=f,b[g+2]=c-d[g+2],c+=f,b[g+3]=c-d[g+3],c+=f,b[g+4]=c-d[g+4],c+=f,b[g+5]=c-d[g+5],c+=f,b[g+6]=c-d[g+6],c+=f,b[g+7]=c-d[g+7],c+=f;this._a=e},f["-"].kk=function(){this.outs[0][0]=this.inputs[0][0]-this.inputs[1][0]},f["-"].ia=function(a){a=0|a;for(var b=this.outs[0],c=this._a,d=this.inputs[1],e=0;a>e;e+=8)b[e]=c-d[e],b[e+1]=c-d[e+1],b[e+2]=c-d[e+2],b[e+3]=c-d[e+3],b[e+4]=c-d[e+4],b[e+5]=c-d[e+5],b[e+6]=c-d[e+6],b[e+7]=c-d[e+7]},f["*"]=function(a,b){return a*b},f["*"].aa=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this.inputs[1],e=0;a>e;e+=8)b[e]=c[e]*d[e],b[e+1]=c[e+1]*d[e+1],b[e+2]=c[e+2]*d[e+2],b[e+3]=c[e+3]*d[e+3],b[e+4]=c[e+4]*d[e+4],b[e+5]=c[e+5]*d[e+5],b[e+6]=c[e+6]*d[e+6],b[e+7]=c[e+7]*d[e+7]},f["*"].ak=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._b,e=this.inputs[1][0],f=(e-this._b)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c[g]*d,d+=f,b[g+1]=c[g+1]*d,d+=f,b[g+2]=c[g+2]*d,d+=f,b[g+3]=c[g+3]*d,d+=f,b[g+4]=c[g+4]*d,d+=f,b[g+5]=c[g+5]*d,d+=f,b[g+6]=c[g+6]*d,d+=f,b[g+7]=c[g+7]*d,d+=f;this._b=e},f["*"].ai=function(a){a=0|a;for(var b=this.outs[0],c=this.inputs[0],d=this._b,e=0;a>e;e+=8)b[e]=c[e]*d,b[e+1]=c[e+1]*d,b[e+2]=c[e+2]*d,b[e+3]=c[e+3]*d,b[e+4]=c[e+4]*d,b[e+5]=c[e+5]*d,b[e+6]=c[e+6]*d,b[e+7]=c[e+7]*d},f["*"].ka=function(a){a=0|a;for(var b=this.outs[0],c=this._a,d=this.inputs[1],e=this.inputs[0][0],f=(e-this._a)*this.rate.slopeFactor,g=0;a>g;g+=8)b[g]=c*d[g],c+=f,b[g+1]=c*d[g+1],c+=f,b[g+2]=c*d[g+2],c+=f,b[g+3]=c*d[g+3],c+=f,b[g+4]=c*d[g+4],c+=f,b[g+5]=c*d[g+5],c+=f,b[g+6]=c*d[g+6],c+=f,b[g+7]=c*d[g+7],c+=f;this._a=e},f["*"].kk=function(){this.outs[0][0]=this.inputs[0][0]*this.inputs[1][0]},f["*"].ia=function(a){a=0|a;for(var b=this.outs[0],c=this._a,d=this.inputs[1],e=0;a>e;e+=8)b[e]=c*d[e],b[e+1]=c*d[e+1],b[e+2]=c*d[e+2],b[e+3]=c*d[e+3],b[e+4]=c*d[e+4],b[e+5]=c*d[e+5],b[e+6]=c*d[e+6],b[e+7]=c*d[e+7]},f["/"]=function(a,b){return 0===b?0:a/b},f["%"]=function(a,b){return 0===b?0:a%b},Object.keys(f).forEach(function(a){var b=f[a];b.aa||(b.aa=g(b)),b.ak||(b.ak=h(b)),b.ai||(b.ai=i(b)),b.ka||(b.ka=j(b)),b.kk||(b.kk=k(b)),b.ki||(b.ki=b.kk),b.ia||(b.ia=l(b)),b.ik||(b.ik=b.kk)}),c.exports={}}),e("cc/server/unit/bufio",function(a,b,c){var d=a("./unit"),e=function(a,b,c,d){if(b>=c){if(!d)return a.done=!0,c;if(b-=c,c>b)return b}else{if(!(0>b))return b;if(!d)return a.done=!0,0;if(b+=c,b>=0)return b}return b-c*Math.floor(b/c)},f=function(a,b,c,d,e){var f=c,g=.5*(d-b),h=b-2.5*c+2*d-.5*e,i=.5*(e-b)+1.5*(c-d);return((i*a+h)*a+g)*a+f};d.specs.PlayBuf=function(){var a=function(){this._buffer=null,this._phase=this.inputs[3][0],this._trig=0,this.process=b},b=function(a,b){this._buffer=b.buffers[this.specialIndex],this._buffer&&null!==this._buffer.samples&&(this.process=2===this.inRates[1]?2===this.inRates[2]?c:c:2===this.inRates[2]?c:c,this.process.call(this,a),delete this.spec)},c=function(a){a=0|a;var b,c,d,g,h,i,j,k,l,m=this._buffer,n=this.outs,o=this._phase,p=this.inputs[1][0],q=this.inputs[2][0],r=this.inputs[4][0],s=m.samples,t=m.channels,u=m.frames,v=u-1;q>0&&this._trig<=0&&(this.done=!1,o=this.inputs[3][0]),this._trig=q;for(var w=0;a>w;++w){o=e(this,o,v,r),c=0|o,b=c-1,d=c+1,g=d+1,0===c?b=r?v:c:g>v&&(d>v?r?(d=0,g=1):d=g=v:g=r?0:v),h=o-(0|o);for(var x=0,y=n.length;y>x;++x)i=s[b*t+x],j=s[c*t+x],k=s[d*t+x],l=s[g*t+x],n[x][w]=f(h,i,j,k,l);o+=p}this.done&&this.doneAction(0|this.inputs[5][0],this.tag),this._phase=o};return a}(),c.exports={}}),e("cc/server/unit/delay",function(a,b,c){var d=a("./unit"),e=Math.log(.001),f=function(a,b,c){return Math.max(c,Math.min(b*a.rate.sampleRate,a._fdelaylen))},g=function(a,b){return 0===a||0===b?0:b>0?+Math.exp(e*a/+b):-Math.exp(e*a/-b)},h=function(a,b,c,d,e){var f=c,g=.5*(d-b),h=b-2.5*c+2*d-.5*e,i=.5*(e-b)+1.5*(c-d);return((i*a+h)*a+g)*a+f},i=function(){var a;this._maxdelaytime=this.inputs[1][0],this._delaytime=this.inputs[2][0],this._decaytime=this.inputs[3][0],a=Math.ceil(this._maxdelaytime*this.rate.sampleRate+1),a+=this.rate.bufLength,a=1<<Math.ceil(Math.log(a)*Math.LOG2E),this._fdelaylen=this._idelaylen=a,this._dlybuf=new Float32Array(a),this._mask=a-1,this._dsamp=f(this,this._delaytime,1),this._iwrphase=0,this._feedbk=g(this._delaytime,this._decaytime)};d.specs.CombN=function(){var a=function(){this.process=b,i.call(this)},b=function(a){a=0|a;var b,c,d,e,h,i,j,k=this.outs[0],l=this.inputs[0],m=this.inputs[2][0],n=this.inputs[3][0],o=this._dlybuf,p=this._iwrphase,q=this._dsamp,r=this._feedbk,s=this._mask;if(m===this._delaytime)if(b=p-(0|q),n===this._decaytime)for(j=0;a>j;++j)c=o[b&s],o[p&s]=l[j]+r*c,k[j]=c,b++,p++;else{for(d=g(m,n),e=(d-r)*this.rate.slopeFactor,j=0;a>j;++j)c=o[b&s],o[p&s]=l[j]+r*c,k[j]=c,r+=e,b++,p++;this._feedbk=d,this._decaytime=n}else{for(h=f(this,m,1),i=(h-q)*this.rate.slopeFactor,d=g(m,n),e=(d-r)*this.rate.slopeFactor,j=0;a>j;++j)b=p-(0|q),c=o[b&s],o[p&s]=l[j]+r*c,k[j]=c,q+=i,r+=e,b++,p++;this._feedbk=r,this._dsamp=q,this._delaytime=m,this._decaytime=n}this._iwrphase=p};return a}(),d.specs.CombL=function(){var a=function(){this.process=b,i.call(this)},b=function(a){a=0|a;var b,c,d,e,h,i,j,k,l,m=this.outs[0],n=this.inputs[0],o=this.inputs[2][0],p=this.inputs[3][0],q=this._dlybuf,r=this._iwrphase,s=this._dsamp,t=this._feedbk,u=this._mask,v=s-(0|s);
if(o===this._delaytime)if(b=r-(0|s),p===this._decaytime)for(l=0;a>l;++l)d=q[b&u],e=q[b-1&u],c=d+v*(e-d),q[r&u]=n[l]+t*c,m[l]=c,b++,r++;else{for(h=g(o,p),i=(h-t)*this.rate.slopeFactor,l=0;a>l;++l)d=q[b&u],e=q[b-1&u],c=d+v*(e-d),q[r&u]=n[l]+t*c,m[l]=c,t+=i,b++,r++;this._feedbk=h,this._decaytime=p}else{for(j=f(this,o,1),k=(j-s)*this.rate.slopeFactor,h=g(o,p),i=(h-t)*this.rate.slopeFactor,l=0;a>l;++l)b=r-(0|s),d=q[b&u],e=q[b-1&u],c=d+v*(e-d),q[r&u]=n[l]+t*c,m[l]=c,s+=k,t+=i,b++,r++;this._feedbk=t,this._dsamp=s,this._delaytime=o,this._decaytime=p}this._iwrphase=r};return a}(),d.specs.CombC=function(){var a=function(){this.process=b,i.call(this)},b=function(a){a=0|a;var b,c,d,e,i,j,k,l,m,n,o,p=this.outs[0],q=this.inputs[0],r=this.inputs[2][0],s=this.inputs[3][0],t=this._dlybuf,u=this._iwrphase,v=this._dsamp,w=this._feedbk,x=this._mask,y=v-(0|v);if(r===this._delaytime)if(b=u-(0|v),s===this._decaytime)for(o=0;a>o;++o)d=t[b+1&x],e=t[b&x],i=t[b-1&x],j=t[b-2&x],c=h(y,d,e,i,j),t[u&x]=q[o]+w*c,p[o]=c,b++,u++;else{for(k=g(r,s),l=(k-w)*this.rate.slopeFactor,o=0;a>o;++o)d=t[b+1&x],e=t[b&x],i=t[b-1&x],j=t[b-2&x],c=h(y,d,e,i,j),t[u&x]=q[o]+w*c,p[o]=c,w+=l,b++,u++;this._feedbk=k,this._decaytime=s}else{for(m=f(this,r,1),n=(m-v)*this.rate.slopeFactor,k=g(r,s),l=(k-w)*this.rate.slopeFactor,o=0;a>o;++o)b=u-(0|v),d=t[b+1&x],e=t[b&x],i=t[b-1&x],j=t[b-2&x],c=h(y,d,e,i,j),t[u&x]=q[o]+w*c,p[o]=c,v+=n,w+=l,b++,u++;this._feedbk=w,this._dsamp=v,this._delaytime=r,this._decaytime=s}this._iwrphase=u};return a}(),c.exports={}}),e("cc/server/unit/line",function(a,b,c){var d=a("./unit");d.specs.Line=function(){var a=function(){this.process=b;var a=this.inputs[0][0],c=this.inputs[1][0],d=this.inputs[2][0],e=Math.round(d*this.rate.sampleRate);this._counter=Math.max(1,e),0===e?(this._level=c,this._slope=0):(this._slope=(c-a)/this._counter,this._level=a+this._slope),this._endLevel=c,this._doneAction=this.inputs[3][0],this.outs[0][0]=this._level},b=function(a){a=0|a;var b,c=this.outs[0],d=this._level,e=this._counter,f=this._slope,g=a;do{var h;if(0===e){h=g,g=0;var i=this._endLevel;for(b=0;h>b;++b)c[b]=i}else{for(h=Math.min(g,e),e-=h,g-=h,b=0;h>b;++b)c[b]=d,d+=f;0===e&&this.doneAction(this._doneAction)}}while(g);this._counter=e,this._level=d};return a}(),c.exports={}}),e("cc/server/unit/osc",function(a,b,c){var d=a("./unit"),e=a("./table"),f=2*Math.PI,g=e.kSineSize,h=e.kSineMask,i=e.gSineWavetable;d.specs.SinOsc=function(){var a=function(){this._freq=this.inputs[0][0],this._phase=this.inputs[1][0],this._radtoinc=g/f,this._cpstoinc=g*this.rate.sampleDur,this._mask=h,this._table=i,2===this.inRates[0]?(this.process=2===this.inRates[1]?b:1===this.inRates[1]?c:d,this._x=0):2===this.inRates[1]?(this.process=e,this._x=0):(this.process=j,this._x=this._phase*this._radtoinc),j.call(this,1)},b=function(a){a=0|a;var b,c,d,e=this.outs[0],f=this.inputs[0],g=this.inputs[1],h=this._mask,i=this._table,j=this._cpstoinc,k=this._radtoinc,l=this._x;for(d=0;a>d;++d)b=l+k*g[d],c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],l+=f[d]*j;this._x=l},c=function(a){a=0|a;var b,c,d,e=this.outs[0],f=this.inputs[0],g=this.inputs[1][0],h=this._mask,i=this._table,j=this._radtoinc,k=this._cpstoinc,l=this._phase,m=this._x;if(g===l)for(l*=j,d=0;a>d;++d)b=m+l,c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],m+=f[d]*k;else{var n=(g-l)*this.rate.slopeFactor;for(d=0;a>d;++d)b=m+j*l,c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],l+=n,m+=f[d]*k;this._phase=g}this._x=m},d=function(a){a=0|a;var b,c,d,e=this.outs[0],f=this.inputs[0],g=this._phase*this._radtoinc,h=this._mask,i=this._table,j=this._cpstoinc,k=this._x;for(d=0;a>d;++d)b=k+g,c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],k+=j*f[d];this._x=k},e=function(a){a=0|a;var b,c,d,e=this.outs[0],f=this.inputs[0][0],g=this.inputs[1],h=this._mask,i=this._table,j=this._radtoinc,k=this._cpstoinc,l=this._freq,m=this._x;if(f===l)for(l*=k,d=0;a>d;++d)b=m+j*g[d],c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],m+=l;else{var n=(f-l)*this.rate.slopeFactor;for(d=0;a>d;++d)b=m+j*g[d],c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],m+=l*k,l+=n;this._freq=f}this._x=m},j=function(a){a=0|a;var b,c,d,e=this.outs[0],f=this.inputs[0][0],g=this.inputs[1][0],h=this._mask,i=this._table,j=this._radtoinc,k=this._cpstoinc,l=this._freq,m=this._phase,n=this._x;if(f===l&&g===m)for(l*=k,m*=j,d=0;a>d;++d)b=n+m,c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],n+=l;else{var o=(f-l)*this.rate.slopeFactor,p=(g-m)*this.rate.slopeFactor;for(d=0;a>d;++d)b=n+j*m,c=(b&h)<<1,e[d]=i[c]+(b-(0|b))*i[c+1],n+=l*k,l+=o,m+=p;this._freq=f,this._phase=g}this._x=n};return a}(),c.exports={}}),e("cc/server/unit/table",function(a,b,c){var d=2*Math.PI,e=8192,f=e-1,g=new Float32Array([1e20])[0],h=new Float32Array(e+1),i=new Float32Array(e+1),j=new Float32Array(2*e);!function(){var a;for(a=0;e>a;++a){var b=Math.sin(d*(a/e));h[a]=b,i[a]=1/b}h[e]=h[0],i[0]=i[e>>1]=i[e]=g;var c=e,f=c>>1;for(a=1;8>=a;++a)i[a]=i[c-a]=i[f-a]=i[f+a]=g}(),function(){!function(a,b,c){var d,e,f,g;for(f=g=0;c-1>f;++f)d=a[f],e=a[f+1],b[g++]=2*d-e,b[g++]=e-d;d=a[c-1],e=a[0],b[g++]=2*d-e,b[g++]=e-d}(h,j,e)}(),c.exports={kSineSize:e,kSineMask:f,gSine:h,gInvSine:i,gSineWavetable:j}}),e("cc/server/unit/pan",function(a,b,c){var d=a("./unit"),e=a("./table"),f=e.gSine;d.specs.Pan2=function(){var a=function(){this.process=2===this.inRates[1]?c:b,this._pos=this.inputs[1][0],this._level=this.inputs[2][0];var a=0|1024*this._pos+1024+.5;a=Math.max(0,Math.min(a,2048)),this._leftAmp=this._level*f[2048-a],this._rightAmp=this._level*f[a],c.call(this,1)},b=function(a){a=0|a;var b,c,d=this.outs[0],e=this.outs[1],g=this.inputs[0],h=this.inputs[1][0],i=this.inputs[2][0],j=this._leftAmp,k=this._rightAmp;if(h!==this._pos||i!==this._level){var l=0|1024*h+1024+.5;l=Math.max(0,Math.min(l,2048));var m=i*f[2048-l],n=i*f[l],o=this.rate.slopeFactor,p=(m-j)*o,q=(n-k)*o;for(b=0;a>b;++b)c=g[b],d[b]=c*j,e[b]=c*k,j+=p,k+=q;this._pos=h,this._level=i,this._leftAmp=m,this._rightAmp=n}else for(b=0;a>b;++b)c=g[b],d[b]=c*j,e[b]=c*k},c=function(a){a=0|a;var b,c,d,e,g,h=this.outs[0],i=this.outs[1],j=this.inputs[0],k=this.inputs[1],l=this.inputs[2][0],m=this._level;if(m!==l){var n=(l-m)*this.rate.slopeFactor;for(b=0;a>b;++b)d=0|1024*k[b]+1024+.5,d=Math.max(0,Math.min(d,2048)),e=m*f[2048-d],g=m*f[d],c=j[b],h[b]=c*e,i[b]=c*g,m+=n;this._level=l}else for(b=0;a>b;++b)d=0|1024*k[b]+1024+.5,d=Math.max(0,Math.min(d,2048)),e=m*f[2048-d],g=m*f[d],c=j[b],h[b]=c*e,i[b]=c*g};return a}(),c.exports={}}),e("cc/server/unit/ui",function(a,b,c){var d=a("./unit"),e=Math.log(.001);d.specs.MouseX=function(){var a=function(){this.process=b,this._y1=0,this._b1=0,this._lag=0,this.process(1)},b=function(a,b){var c=this.inputs[0][0]||.01,d=this.inputs[1][0],f=this.inputs[2][0],g=this.inputs[3][0],h=this._y1,i=this._b1;g!==this._lag&&(this._b1=0===g?0:Math.exp(e/(g*this.rate.sampleRate)),this._lag=g);var j=b?b.f32_syncItems[1]:0;0===f?j=(d-c)*j+c:(j=Math.pow(d/c,j)*c,isNaN(j)&&(j=0)),this.outs[0][0]=h=j+i*(h-j),this._y1=h};return a}(),d.specs.MouseY=function(){var a=function(){this.process=b,this._y1=0,this._b1=0,this._lag=0,this.process(1)},b=function(a,b){var c=this.inputs[0][0]||.01,d=this.inputs[1][0],f=this.inputs[2][0],g=this.inputs[3][0],h=this._y1,i=this._b1;g!==this._lag&&(this._b1=0===g?0:Math.exp(e/(g*this.rate.sampleRate)),this._lag=g);var j=b?b.f32_syncItems[2]:0;0===f?j=(d-c)*j+c:(j=Math.pow(d/c,j)*c,isNaN(j)&&(j=0)),this.outs[0][0]=h=j+i*(h-j),this._y1=h};return a}(),d.specs.MouseButton=function(){var a=function(){this.process=b,this._y1=0,this._b1=0,this._lag=0,this.process(1)},b=function(a,b){var c=this.inputs[0][0],d=this.inputs[1][0],f=this.inputs[2][0],g=this._y1,h=this._b1;f!==this._lag&&(this._b1=0===f?0:Math.exp(e/(f*this.rate.sampleRate)),this._lag=f);var i=b?b.syncItems[3]?d:c:c;this.outs[0][0]=g=i+h*(g-i),this._y1=g};return a}(),c.exports={}});var f=c("cc/cc","cc/loader");"undefined"!=typeof module&&(module.exports=f)}(this.self||global);
//# sourceMappingURL=coffee-collider-min.map